{"version":3,"sources":["../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","../node_modules/glsl-token-string/index.js","../node_modules/glsl-token-depth/index.js","../node_modules/glsl-token-scope/index.js","../node_modules/regl/dist/regl.unchecked.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass.js","../packages/sandbox/node_modules/glslify-deps/depper.js","../node_modules/map-limit/index.js","../node_modules/map-limit/node_modules/once/once.js","../node_modules/wrappy/wrappy.js","../packages/sandbox/node_modules/glslify-deps/utils.js","../node_modules/glslify-bundle/index.js","../node_modules/murmurhash-js/murmurhash3_gc.js","../node_modules/glsl-token-whitespace-trim/index.js","../node_modules/glsl-inject-defines/string.js","../node_modules/glsl-token-inject-block/index.js","../node_modules/glsl-token-defines/index.js","../node_modules/glsl-token-descope/index.js","../node_modules/glsl-token-properties/index.js","../node_modules/glsl-token-assignments/index.js","../node_modules/glsl-token-assignments/assignments.js","../node_modules/glsl-token-assignments/ignored.js","../node_modules/glslify-bundle/lib/clean-suffixes.js","../node_modules/glslify-bundle/lib/topo-sort.js","../node_modules/shallow-copy/index.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/typeof.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/superPropBase.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","../node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits.js"],"names":["_getPrototypeOf","o","Object","setPrototypeOf","getPrototypeOf","__proto__","module","exports","tokens","output","i","length","type","push","data","join","loop","depth","token","index","skipArrayArguments","stack","inc","ldepth","Error","splice","scope","slice","extend","base","opts","keys","VARIABLE_COUNTER","DYN_FUNC","DYN_CONSTANT","DYN_ARRAY","DynamicVariable","this","id","escapeStr","str","replace","splitParts","firstChar","charAt","lastChar","substr","parts","exec","concat","subparts","split","result","toAccessorString","defineDynamic","isDynamic","x","_reglType","unbox","path","Array","isArray","map","y","dynamic","define","accessor","raf","next","requestAnimationFrame","cb","setTimeout","cancel","cancelAnimationFrame","clearTimeout","clock","performance","now","Date","createStringStore","stringIds","stringValues","createCanvas","element","onDone","pixelRatio","resizeObserver","canvas","document","createElement","resize","w","window","innerWidth","h","innerHeight","body","bounds","getBoundingClientRect","right","left","bottom","top","width","height","style","onDestroy","disconnect","removeEventListener","removeChild","border","margin","padding","appendChild","position","ResizeObserver","observe","addEventListener","createContext","contextAttributes","get","name","getContext","e","isHTMLElement","obj","nodeName","isWebGLContext","drawArrays","drawElements","parseExtensions","input","getElement","desc","querySelector","parseArgs","args_","container","gl","args","extensions","optionalExtensions","devicePixelRatio","profile","err","attributes","toLowerCase","undefined","premultipliedAlpha","createExtensionCache","config","tryLoadExtension","name_","ext","getExtension","forEach","restore","n","f","GL_BYTE","GL_UNSIGNED_BYTE$1","GL_SHORT","GL_UNSIGNED_SHORT","GL_INT","GL_UNSIGNED_INT","GL_FLOAT$1","nextPow16","v","log2","r","shift","createPool","bufferPool","alloc","sz","bin","pop","ArrayBuffer","free","buf","byteLength","allocType","Int8Array","Uint8Array","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","subarray","freeType","array","buffer","pool","zero","GL_SUBPIXEL_BITS","GL_RED_BITS","GL_GREEN_BITS","GL_BLUE_BITS","GL_ALPHA_BITS","GL_DEPTH_BITS","GL_STENCIL_BITS","GL_ALIASED_POINT_SIZE_RANGE","GL_ALIASED_LINE_WIDTH_RANGE","GL_MAX_TEXTURE_SIZE","GL_MAX_VIEWPORT_DIMS","GL_MAX_VERTEX_ATTRIBS","GL_MAX_VERTEX_UNIFORM_VECTORS","GL_MAX_VARYING_VECTORS","GL_MAX_COMBINED_TEXTURE_IMAGE_UNITS","GL_MAX_VERTEX_TEXTURE_IMAGE_UNITS","GL_MAX_TEXTURE_IMAGE_UNITS","GL_MAX_FRAGMENT_UNIFORM_VECTORS","GL_MAX_CUBE_MAP_TEXTURE_SIZE","GL_MAX_RENDERBUFFER_SIZE","GL_VENDOR","GL_RENDERER","GL_VERSION","GL_SHADING_LANGUAGE_VERSION","GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT","GL_MAX_COLOR_ATTACHMENTS_WEBGL","GL_MAX_DRAW_BUFFERS_WEBGL","GL_TEXTURE_2D","GL_TEXTURE_CUBE_MAP","GL_TEXTURE_CUBE_MAP_POSITIVE_X","GL_TEXTURE0","GL_RGBA","GL_FLOAT","GL_UNSIGNED_BYTE","GL_FRAMEBUFFER","GL_FRAMEBUFFER_COMPLETE","GL_COLOR_ATTACHMENT0","GL_COLOR_BUFFER_BIT$1","wrapLimits","maxAnisotropic","ext_texture_filter_anisotropic","getParameter","maxDrawbuffers","maxColorAttachments","webgl_draw_buffers","readFloat","oes_texture_float","readFloatTexture","createTexture","bindTexture","texImage2D","fbo","createFramebuffer","bindFramebuffer","framebufferTexture2D","checkFramebufferStatus","viewport","clearColor","clear","pixels","readPixels","getError","deleteFramebuffer","deleteTexture","npotTextureCube","navigator","test","userAgent","appVersion","cubeTexture","activeTexture","colorBits","depthBits","stencilBits","subpixelBits","filter","pointSizeDims","lineWidthDims","maxViewportDims","maxCombinedTextureUnits","maxCubeMapSize","maxRenderbufferSize","maxTextureUnits","maxTextureSize","maxAttributes","maxVertexUniforms","maxVertexTextureUnits","maxVaryingVectors","maxFragmentUniforms","glsl","renderer","vendor","version","isTypedArray","Float64Array","Uint8ClampedArray","isNDArrayLike","shape","stride","offset","values","key","flattenUtils","arrayShape$1","flatten","flattenArray","flatten1D","nx","out","flatten2D","ny","ptr","row","j","flatten3D","nz","ptr_","col","k","flattenRec","level","out_","array_","arrayTypes","glTypes","int8","int16","int32","uint8","uint16","uint32","float","float32","usageTypes","stream","arrayFlatten","arrayShape","GL_STATIC_DRAW","GL_STREAM_DRAW","GL_UNSIGNED_BYTE$2","GL_FLOAT$2","DTYPES_SIZES","typedArrayCode","prototype","toString","call","copyArray","inp","transpose","shapeX","shapeY","strideX","strideY","wrapBufferState","stats","destroyBuffer","bufferCount","bufferSet","REGLBuffer","createBuffer","usage","dimension","dtype","persistentData","size","bind","bindBuffer","destroy","streamPool","createStream","initBufferFromData","destroyStream","stream$$1","initBufferFromTypedArray","bufferData","persist","flatData","dim","typedData","transposeData","handle","deleteBuffer","options","deferInit","persistent","reglBuffer","setSubData","bufferSubData","subdata","offset_","converted","_buffer","restoreBuffers","getTotalBufferSize","total","create","getBuffer","wrapper","_initBuffer","primTypes","points","point","lines","line","triangles","triangle","GL_POINTS","GL_LINES","GL_TRIANGLES","GL_BYTE$1","GL_UNSIGNED_BYTE$3","GL_SHORT$1","GL_UNSIGNED_SHORT$1","GL_INT$1","GL_UNSIGNED_INT$1","GL_ELEMENT_ARRAY_BUFFER","GL_STREAM_DRAW$1","GL_STATIC_DRAW$1","wrapElementsState","bufferState","elementSet","elementCount","elementTypes","REGLElementBuffer","primType","vertCount","oes_element_index_uint","createElementStream","initElements","destroyElementStream","elements","prim","count","predictedType","destroyElements","elementsCount","createElements","reglElements","primitive","_elements","getElements","FLOAT","INT","GL_UNSIGNED_SHORT$3","convertToHalfFloat","ushorts","isNaN","Infinity","sgn","exp","frac","s","isArrayLike","GL_COMPRESSED_TEXTURE_FORMATS","GL_TEXTURE_2D$1","GL_TEXTURE_CUBE_MAP$1","GL_TEXTURE_CUBE_MAP_POSITIVE_X$1","GL_RGBA$1","GL_ALPHA","GL_RGB","GL_LUMINANCE","GL_LUMINANCE_ALPHA","GL_RGBA4","GL_RGB5_A1","GL_RGB565","GL_UNSIGNED_SHORT_4_4_4_4","GL_UNSIGNED_SHORT_5_5_5_1","GL_UNSIGNED_SHORT_5_6_5","GL_UNSIGNED_INT_24_8_WEBGL","GL_DEPTH_COMPONENT","GL_DEPTH_STENCIL","GL_SRGB_EXT","GL_SRGB_ALPHA_EXT","GL_HALF_FLOAT_OES","GL_COMPRESSED_RGB_S3TC_DXT1_EXT","GL_COMPRESSED_RGBA_S3TC_DXT1_EXT","GL_COMPRESSED_RGBA_S3TC_DXT3_EXT","GL_COMPRESSED_RGBA_S3TC_DXT5_EXT","GL_COMPRESSED_RGB_ATC_WEBGL","GL_COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL","GL_COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL","GL_COMPRESSED_RGB_PVRTC_4BPPV1_IMG","GL_COMPRESSED_RGB_PVRTC_2BPPV1_IMG","GL_COMPRESSED_RGBA_PVRTC_4BPPV1_IMG","GL_COMPRESSED_RGBA_PVRTC_2BPPV1_IMG","GL_COMPRESSED_RGB_ETC1_WEBGL","GL_UNSIGNED_BYTE$4","GL_UNSIGNED_SHORT$2","GL_UNSIGNED_INT$2","GL_FLOAT$3","GL_TEXTURE_WRAP_S","GL_TEXTURE_WRAP_T","GL_REPEAT","GL_CLAMP_TO_EDGE","GL_MIRRORED_REPEAT","GL_TEXTURE_MAG_FILTER","GL_TEXTURE_MIN_FILTER","GL_NEAREST","GL_LINEAR","GL_NEAREST_MIPMAP_NEAREST","GL_LINEAR_MIPMAP_NEAREST","GL_NEAREST_MIPMAP_LINEAR","GL_LINEAR_MIPMAP_LINEAR","GL_GENERATE_MIPMAP_HINT","GL_DONT_CARE","GL_FASTEST","GL_NICEST","GL_TEXTURE_MAX_ANISOTROPY_EXT","GL_UNPACK_ALIGNMENT","GL_UNPACK_FLIP_Y_WEBGL","GL_UNPACK_PREMULTIPLY_ALPHA_WEBGL","GL_UNPACK_COLORSPACE_CONVERSION_WEBGL","GL_BROWSER_DEFAULT_WEBGL","GL_TEXTURE0$1","MIPMAP_FILTERS","CHANNELS_FORMAT","FORMAT_CHANNELS","objectName","CANVAS_CLASS","OFFSCREENCANVAS_CLASS","CONTEXT2D_CLASS","BITMAP_CLASS","IMAGE_CLASS","VIDEO_CLASS","PIXEL_CLASSES","TYPE_SIZES","FORMAT_SIZES_SPECIAL","isNumericArray","arr","isRectArray","classString","isCanvasElement","object","isOffscreenCanvas","isContext2D","isBitmap","isImageElement","isVideoElement","isPixelData","className","indexOf","typedArrayCode$1","convertData","set","preConvert","image","postConvert","strideC","c","channels","p","getTextureSize","format","isMipmap","isCube","createTextureSet","limits","reglPoll","contextState","mipmapHint","wrapModes","magFilters","minFilters","colorSpace","textureTypes","textureFormats","compressedTextureFormats","ext_srgb","srgb","srgba","oes_texture_half_float","webgl_depth_texture","webgl_compressed_texture_s3tc","webgl_compressed_texture_atc","webgl_compressed_texture_pvrtc","webgl_compressed_texture_etc1","supportedCompressedFormats","supportedFormats","textureFormatsInvert","val","textureTypesInvert","magFiltersInvert","minFiltersInvert","wrapModesInvert","colorFormats","reduce","color","glenum","TexFlags","internalformat","compressed","premultiplyAlpha","flipY","unpackAlignment","copyFlags","other","parseFlags","flags","alignment","hasChannels","radius","hasFormat","formatStr","setFlags","pixelStorei","TexImage","xOffset","yOffset","needsFree","needsCopy","parseImage","copy","viewW","viewportWidth","viewH","viewportHeight","shapeC","naturalWidth","naturalHeight","videoWidth","videoHeight","dd","allocData","setImage","info","target","miplevel","compressedTexImage2D","copyTexImage2D","setSubImage","texSubImage2D","compressedTexSubImage2D","copyTexSubImage2D","imagePool","allocImage","freeImage","MipMap","genMipmaps","mipmask","images","parseMipMapFromShape","mipmap","img","parseMipMapFromObject","imgData","mipData","setMipMap","mipPool","allocMipMap","freeMipMap","TexInfo","minFilter","magFilter","wrapS","wrapT","anisotropic","parseTexInfo","min","mag","wrap","optWrapS","optWrapT","hasMipMap","setTexInfo","texParameteri","hint","generateMipmap","textureCount","textureSet","numTexUnits","textureUnits","REGLTexture","refCount","texture","unit","bindCount","texInfo","tempBind","tempRestore","prev","params","createTexture2D","a","b","reglTexture2D","subimage","x_","y_","level_","imageData","w_","h_","_w","_h","_texture","decRef","createTextureCube","a0","a1","a2","a3","a4","a5","cubeCount","faces","reglTextureCube","faceInput","face","radius_","destroyTextures","restoreTextures","tex","refreshTextures","unbind","getTotalTextureSize","create2D","createCube","getTexture","refresh","GL_RENDERBUFFER","GL_RGBA4$1","GL_RGB5_A1$1","GL_RGB565$1","GL_DEPTH_COMPONENT16","GL_STENCIL_INDEX8","GL_DEPTH_STENCIL$1","GL_SRGB8_ALPHA8_EXT","GL_RGBA32F_EXT","GL_RGBA16F_EXT","GL_RGB16F_EXT","FORMAT_SIZES","getRenderbufferSize","wrapRenderbuffers","formatTypes","ext_color_buffer_half_float","webgl_color_buffer_float","formatTypesInvert","renderbufferCount","renderbufferSet","REGLRenderbuffer","renderbuffer","rb","bindRenderbuffer","deleteRenderbuffer","createRenderbuffer","reglRenderbuffer","renderbufferStorage","_renderbuffer","restoreRenderbuffers","getTotalRenderbufferSize","GL_FRAMEBUFFER$1","GL_RENDERBUFFER$1","GL_TEXTURE_2D$2","GL_TEXTURE_CUBE_MAP_POSITIVE_X$2","GL_COLOR_ATTACHMENT0$1","GL_DEPTH_ATTACHMENT","GL_STENCIL_ATTACHMENT","GL_DEPTH_STENCIL_ATTACHMENT","GL_HALF_FLOAT_OES$1","GL_UNSIGNED_BYTE$5","GL_FLOAT$4","GL_RGB$1","textureFormatChannels","textureTypeSizes","wrapFBOState","textureState","renderbufferState","framebufferState","cur","dirty","setFBO","colorTextureFormats","colorRenderbufferFormats","colorTypes","FramebufferAttachment","attachment","incRefAndCheckShape","Math","max","attach","location","framebufferRenderbuffer","parseAttachment","allocAttachment","isTexture","unwrapAttachment","resizeAttachment","framebufferCount","framebufferSet","REGLFramebuffer","framebuffer","colorAttachments","depthAttachment","stencilAttachment","depthStencilAttachment","decFBORefs","updateFramebuffer","isContextLost","createFBO","reglFramebuffer","needsDepth","needsStencil","colorBuffer","colorTexture","colorFormat","colorType","colorCount","depthBuffer","stencilBuffer","depthStencilBuffer","depthStencilTexture","colors","depthTexture","stencil","depthStencil","commonColorAttachmentSize","colorAttachmentSize","_framebuffer","use","block","createCubeFBO","reglFramebufferCube","colorCubes","cubeMapParams","cube","restoreFramebuffers","fb","getFramebuffer","GL_FLOAT$5","GL_ARRAY_BUFFER$1","GL_ELEMENT_ARRAY_BUFFER$1","AttributeRecord","state","z","normalized","divisor","wrapAttributeState","elementState","drawState","NUM_ATTRIBUTES","attributeBindings","vaoCount","vaoSet","Record","currentVAO","targetVAO","extVAO","restoreVAO","createVAO","getVAO","setVAO","setVAOEXT","setVAOEmulated","destroyVAOEXT","record","disableVertexAttribArray","oes_vertex_array_object","extInstanced","angle_instanced_arrays","vao","_vao","bindVertexArrayOES","bindAttrs","exti","binding","enableVertexAttribArray","vertexAttribPointer","offfset","vertexAttribDivisorANGLE","vertexAttrib4f","REGLVAO","ownsElements","instances","extension","createVertexArrayOES","buffers","_attr","updateVAO","bufUpdated","nattributes","spec","rec","attr","deleteVertexArrayOES","GL_FRAGMENT_SHADER","GL_VERTEX_SHADER","GL_ACTIVE_UNIFORMS","GL_ACTIVE_ATTRIBUTES","wrapShaderState","stringStore","fragShaders","vertShaders","ActiveInfo","insertActiveInfo","list","getShader","command","cache","shader","source","createShader","shaderSource","compileShader","programCache","programList","PROGRAM_COUNTER","REGLProgram","fragId","vertId","program","uniforms","uniformsCount","attributesCount","linkProgram","attributeLocations","fragShader","vertShader","createProgram","attachShader","bindAttribLocation","numUniforms","getProgramParameter","getActiveUniform","getUniformLocation","numAttributes","getActiveAttrib","getAttribLocation","restoreShaders","getMaxUniformsCount","m","getMaxAttributesCount","deleteShader","deleteProgram","shaderCount","attribLocations","prevProgram","idx","frag","vert","GL_RGBA$3","GL_UNSIGNED_BYTE$6","GL_PACK_ALIGNMENT","GL_FLOAT$6","wrapReadPixels","context","glAttributes","readPixelsImpl","framebufferWidth","framebufferHeight","readPixelsFBO","createEnvironment","varCounter","linkedNames","linkedValues","link","value","code","apply","arguments","vars","def","entry","exit","entryToString","exitToString","save","prop","conditional","pred","thenBlock","elseBlock","thenToString","elseToString","then","else","elseClause","globalBlock","procedures","proc","arg","bodyToString","compile","src","Function","global","cond","CUTE_COMPONENTS","GL_UNSIGNED_BYTE$7","ATTRIB_STATE_POINTER","ATTRIB_STATE_CONSTANT","DYN_FUNC$1","DYN_PROP$1","DYN_CONTEXT$1","DYN_STATE$1","DYN_THUNK","DYN_CONSTANT$1","DYN_ARRAY$1","S_DITHER","S_BLEND_ENABLE","S_BLEND_COLOR","S_BLEND_EQUATION","S_BLEND_FUNC","S_DEPTH_ENABLE","S_DEPTH_FUNC","S_DEPTH_RANGE","S_DEPTH_MASK","S_COLOR_MASK","S_CULL_ENABLE","S_CULL_FACE","S_FRONT_FACE","S_LINE_WIDTH","S_POLYGON_OFFSET_ENABLE","S_POLYGON_OFFSET_OFFSET","S_SAMPLE_ALPHA","S_SAMPLE_ENABLE","S_SAMPLE_COVERAGE","S_STENCIL_ENABLE","S_STENCIL_MASK","S_STENCIL_FUNC","S_STENCIL_OPFRONT","S_STENCIL_OPBACK","S_SCISSOR_ENABLE","S_SCISSOR_BOX","S_VIEWPORT","S_PROFILE","S_FRAMEBUFFER","S_VERT","S_FRAG","S_ELEMENTS","S_PRIMITIVE","S_COUNT","S_OFFSET","S_INSTANCES","S_VAO","SUFFIX_WIDTH","SUFFIX_HEIGHT","S_FRAMEBUFFER_WIDTH","S_FRAMEBUFFER_HEIGHT","S_VIEWPORT_WIDTH","S_VIEWPORT_HEIGHT","S_DRAWINGBUFFER","S_DRAWINGBUFFER_WIDTH","S_DRAWINGBUFFER_HEIGHT","NESTED_OPTIONS","GL_ARRAY_BUFFER$2","GL_ELEMENT_ARRAY_BUFFER$2","GL_CULL_FACE","GL_BLEND","GL_DITHER","GL_STENCIL_TEST","GL_DEPTH_TEST","GL_SCISSOR_TEST","GL_POLYGON_OFFSET_FILL","GL_SAMPLE_ALPHA_TO_COVERAGE","GL_SAMPLE_COVERAGE","GL_FLOAT$7","GL_FLOAT_VEC2","GL_FLOAT_VEC3","GL_FLOAT_VEC4","GL_INT$2","GL_INT_VEC2","GL_INT_VEC3","GL_INT_VEC4","GL_BOOL","GL_BOOL_VEC2","GL_BOOL_VEC3","GL_BOOL_VEC4","GL_FLOAT_MAT2","GL_FLOAT_MAT3","GL_FLOAT_MAT4","GL_SAMPLER_2D","GL_SAMPLER_CUBE","GL_TRIANGLES$1","GL_FRONT","GL_BACK","GL_CW","GL_CCW","GL_MIN_EXT","GL_MAX_EXT","GL_ALWAYS","GL_KEEP","GL_ZERO","GL_ONE","GL_FUNC_ADD","GL_LESS","GL_FRAMEBUFFER$2","GL_COLOR_ATTACHMENT0$2","blendFuncs","compareFuncs","stencilOps","orientationType","isBufferArgs","sortState","sort","Declaration","thisDep","contextDep","propDep","append","isStatic","decl","createStaticDecl","createDynamicDecl","dyn","numArgs","subDyn","subArgs","SCOPE_DECL","reglCore","uniformState","attributeState","shaderState","timer","blendEquations","ext_blend_minmax","extInstancing","extDrawBuffers","extVertexArrays","currentState","nextState","GL_STATE_NAMES","GL_FLAGS","GL_VARIABLES","propName","stateFlag","sname","cap","init","stateVariable","func","drawingBufferWidth","drawingBufferHeight","sharedState","strings","current","draw","sharedConstants","backBuffer","drawBuffer","drawCallCounter","createREGLEnvironment","env","batchId","SHARED","shared","props","nextVars","currentVars","variable","constants","JSON","stringify","invoke","argList","ref","attribCache","scopeAttribs","scopeAttrib","parseProfile","profileEnable","staticOptions","static","dynamicOptions","enable","parseFramebuffer","FRAMEBUFFER","CONTEXT","FRAMEBUFFER_FUNC","FRAMEBUFFER_STATE","parseViewportScissor","parseBox","param","box","BOX_W","BOX_H","dynBox","BOX","BOX_X","BOX_Y","prevViewport","VIEWPORT","scissor_box","parseAttribLocations","staticAttributes","sAttributes","bindings","parseProgram","parseShader","progVar","SHADER_STATE","progDef","parseDraw","staticDraw","vaoActive","parseVAO","vaoRef","elementsActive","parseElements","ELEMENTS","IS_BUFFER_ARGS","ELEMENT_STATE","elementDefn","elementStream","ifte","parsePrimitive","dynPrimitive","PRIM_TYPES","parseParam","isOffset","OFFSET","dynValue","parseVertCount","dynCount","parseGLState","STATE","parseStatic","parseDynamic","COMPARE_FUNCS","srcRGB","srcAlpha","dstRGB","dst","dstAlpha","BLEND_FUNCS","read","prefix","suffix","SRC_RGB","SRC_ALPHA","rgb","alpha","BLEND_EQUATIONS","RGB","ALPHA","cmp","mask","fail","zfail","zpass","STENCIL_OPS","factor","units","invert","parseUniforms","staticUniforms","dynamicUniforms","UNIFORMS","reglType","parseAttributes","dynamicAttributes","attributeDefs","attribute","constant","isStream","appendAttributeCode","VALUE","BUFFER_STATE","defaultRecord","BUFFER","TYPE","emitReadRecord","parseContext","staticContext","dynamicContext","parseArguments","viewportAndScissor","copyBox","defn","scopeVAO","drawVAO","useVAO","staticBindings","emitContext","contextEnter","emitPollFramebuffer","skipCheck","EXT_DRAW_BUFFERS","GL","NEXT","DRAW_BUFFERS","BACK_BUFFER","emitPollState","CURRENT_VARS","NEXT_VARS","CURRENT_STATE","NEXT_STATE","CURRENT","emitSetOptions","flag","injectExtensions","instancing","emitProfile","useScope","incrementCounter","CPU_START","QUERY_COUNTER","USE_PROFILE","STATS","TIMER","profileArg","perfCounter","emitProfileStart","emitProfileEnd","scopeProfile","start","end","emitAttributes","typeLength","emitBindAttribute","ATTRIBUTE","LOCATION","BINDING","CONST_COMPONENTS","COMMON_KEYS","emitBuffer","SIZE","DIVISOR","emitConstant","emitUniforms","isBatchInnerLoop","infix","uniform","TEX_VALUE","MAT_VALUE","unroll","TEX","matSize","pow","STORAGE","prevS","emitDraw","outer","inner","DRAW_STATE","drawOptions","emitElements","contextDynamic","emitCount","COUNT","emitValue","INSTANCES","EXT_INSTANCING","PRIMITIVE","ELEMENT_TYPE","elementsStatic","emitInstancing","emitRegular","createBody","emitBody","parentEnv","emitDrawBody","emitDrawProc","drawCache","PROG_ID","CACHED_PROC","emitBatchDynamicShaderBody","all","emitBatchBody","BATCH_ID","PROP_LIST","NUM_PROPS","PROPS","isInnerDefn","isOuterDefn","needsContext","needsFramebuffer","progCache","PROGRAM","emitBatchProc","batch","progDefn","batchCache","emitScopeProc","saveShader","opt","isDynamicObject","splatObject","globals","objectRef","deps","appendBlock","compileCommand","procs","poll","common","INSTANCING","GL_QUERY_RESULT_EXT","GL_QUERY_RESULT_AVAILABLE_EXT","GL_TIME_ELAPSED_EXT","createTimer","ext_disjoint_timer_query","queryPool","allocQuery","createQueryEXT","freeQuery","query","pendingQueries","beginQuery","beginQueryEXT","pushScopeStats","endQuery","endQueryEXT","PendingStats","startQueryIndex","endQueryIndex","sum","pendingStatsPool","allocPendingStats","freePendingStats","pendingStats","ps","timeSum","queryPtr","update","queryTime","getQueryObjectEXT","startPtr","endPtr","gpuTime","getNumPendingQueries","deleteQueryEXT","GL_COLOR_BUFFER_BIT","GL_DEPTH_BUFFER_BIT","GL_STENCIL_BUFFER_BIT","GL_ARRAY_BUFFER","CONTEXT_LOST_EVENT","CONTEXT_RESTORED_EVENT","DYN_PROP","DYN_CONTEXT","DYN_STATE","find","haystack","needle","wrapREGL","getContextAttributes","extensionState","stats$$1","START_TIME","WIDTH","HEIGHT","tick","time","core","rafCallbacks","lossCallbacks","restoreCallbacks","destroyCallbacks","activeRAF","handleRAF","flush","startRAF","stopRAF","handleContextLoss","event","preventDefault","handleContextRestored","compileProcedure","flattenNestedOptions","merge","child","op","opBack","opFront","separateDynamic","useArrays","staticItems","dynamicItems","option","cpuTime","compiled","EMPTY_ARRAY","reserve","REGLCommand","clearImpl","_","clearFlags","clearDepth","clearStencil","framebuffer_reglType","frame","pendingCancel","pollViewport","scissorBox","addListener","callback","callbacks","regl","framebufferCube","on","hasExtension","_gl","_refresh","factory","_classCallCheck","instance","Constructor","TypeError","_defineProperties","descriptor","enumerable","configurable","writable","defineProperty","_createClass","protoProps","staticProps","EventEmitter","require","genInlineName","cacheWrap","parseFiles","getImportName","extractPreprocessors","asyncify","Depper","constructor","_inlineSource","_inlineName","_async","async","_i","_deps","_cache","_fileCache","assign","files","_transforms","_globalTransforms","readFile","_readFile","resolve","transformRequire","_transformRequireAsync","sync","filename","done","add","self","imports","dep","_addDep","resolveOpts","process","getTransformsForFile","emit","applyTransforms","_resolveImports","console","warn","transform","post","tr","selectTransform","resolved","transforms","updated","file","extra","resolveTransform","parallel","importName","imp","once","noop","limit","iterator","complete","aborted","results","queued","l","abort","wrappy","fn","called","proto","ret","tokenize","glslifyPreprocessor","glslifyExport","glslifyImport","mix","mixed","getTransformsFromPkg","pkgJson","parse","glslify","trim","random","nextTick","content","newCache","fns","initialState","cursor","error","hash","inject","defines","descope","clean","string","topoSort","Bundle","depList","depIndex","indexBy","exported","preprocess","bundle","GLSLIFY","toMapping","maps","mapping","expr","imported","eof","parsed","ident","exportName","rename","edits","importMaps","importTarget","importBindings","match","parent","importTokens","parsedTokens","parsedDefs","local","edit","seed","remainder","bytes","h1","h1b","c1","c2","k1","charCodeAt","everything","curr","collapse","newlines","String","newTokens","semi","findNextSemicolon","getStartIndex","last","regex","newline","definitions","datum","declaration","getScope","renamer","defaultRenamer","descoped","property","structMember","bound","assignments","ignoredKeywords","assignment","skipWhitespace","datatype","skipArrayDimensions","skipParens","blacklist","pre","suf","suffixes","adj","inDegree","nbhd","u","inverse","ndeps","len","objectKeys","hasOwnProperty","xs","_typeof","Symbol","_possibleConstructorReturn","ReferenceError","_createSuper","Derived","hasNativeReflectConstruct","Reflect","construct","sham","Proxy","Super","NewTarget","receiver","getOwnPropertyDescriptor","_setPrototypeOf","_inherits","subClass","superClass"],"mappings":"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","file":"static/js/3.76eeba7f.chunk.js","sourcesContent":["export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","module.exports = toString\n\nfunction toString(tokens) {\n  var output = []\n\n  for (var i = 0; i < tokens.length; i++) {\n    if (tokens[i].type === 'eof') continue\n    output.push(tokens[i].data)\n  }\n\n  return output.join('')\n}\n","module.exports = getTokenDepth\n\nfunction getTokenDepth(tokens) {\n  var loop  = false\n  var depth = 0\n\n  for (var i = 0; i < tokens.length; i++) {\n    loop = loop || (tokens[i].type === 'keyword' && (\n      tokens[i].data === 'for'\n    ))\n\n    switch (tokens[i].data) {\n      case '(': tokens[i].depth = loop ? depth++ : depth; break\n      case '{': tokens[i].depth = loop ? depth : depth++; loop = false; break\n      case '}': tokens[i].depth = --depth; break\n      default:  tokens[i].depth = depth\n    }\n  }\n\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i]\n    var index = i + 1\n    if (token.type !== 'ident' && token.type !== 'keyword') continue\n    skipArrayArguments()\n    if (tokens[index].type !== 'ident') continue\n    skipArrayArguments()\n    index++\n    if (tokens[index].data !== '(') continue\n\n    while (tokens[index] && tokens[index].data !== ';' && tokens[index].data !== '{') {\n      tokens[index++].depth++\n    }\n    if (tokens[index] && tokens[index].data === '{') tokens[index].depth++\n  }\n\n  return tokens\n\n  function skipArrayArguments() {\n    while (tokens[index] && (\n      tokens[index].type === 'whitespace' ||\n      tokens[index].data === '[' ||\n      tokens[index].data === ']' ||\n      tokens[index].data === 'integer'\n    )) index++\n  }\n}\n","module.exports = tokenScope\n\nfunction tokenScope(tokens) {\n  var stack  = [0]\n  var inc    = stack[0]\n  var ldepth = 0\n\n  if (!tokens || !tokens.length) return tokens\n  if (!('depth' in tokens[0])) {\n    throw new Error('glsl-token-scope: No scope depth defined on tokens! Use glsl-token-depth on these tokens first')\n  }\n\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i]\n    var depth = token.depth\n\n    if (depth > ldepth) {\n      stack.push(++inc)\n    } else\n    if (depth < ldepth) {\n      stack.splice(-1, 1)\n    }\n\n    token.scope = stack[stack.length - 1]\n    token.stack = stack.slice()\n    ldepth = token.depth\n  }\n\n  return tokens\n}\n","(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define(factory) :\n    (global.createREGL = factory());\n}(this, (function () { 'use strict';\n\nvar extend = function (base, opts) {\n  var keys = Object.keys(opts)\n  for (var i = 0; i < keys.length; ++i) {\n    base[keys[i]] = opts[keys[i]]\n  }\n  return base\n}\n\nvar VARIABLE_COUNTER = 0\n\nvar DYN_FUNC = 0\nvar DYN_CONSTANT = 5\nvar DYN_ARRAY = 6\n\nfunction DynamicVariable (type, data) {\n  this.id = (VARIABLE_COUNTER++)\n  this.type = type\n  this.data = data\n}\n\nfunction escapeStr (str) {\n  return str.replace(/\\\\/g, '\\\\\\\\').replace(/\"/g, '\\\\\"')\n}\n\nfunction splitParts (str) {\n  if (str.length === 0) {\n    return []\n  }\n\n  var firstChar = str.charAt(0)\n  var lastChar = str.charAt(str.length - 1)\n\n  if (str.length > 1 &&\n      firstChar === lastChar &&\n      (firstChar === '\"' || firstChar === \"'\")) {\n    return ['\"' + escapeStr(str.substr(1, str.length - 2)) + '\"']\n  }\n\n  var parts = /\\[(false|true|null|\\d+|'[^']*'|\"[^\"]*\")\\]/.exec(str)\n  if (parts) {\n    return (\n      splitParts(str.substr(0, parts.index))\n        .concat(splitParts(parts[1]))\n        .concat(splitParts(str.substr(parts.index + parts[0].length)))\n    )\n  }\n\n  var subparts = str.split('.')\n  if (subparts.length === 1) {\n    return ['\"' + escapeStr(str) + '\"']\n  }\n\n  var result = []\n  for (var i = 0; i < subparts.length; ++i) {\n    result = result.concat(splitParts(subparts[i]))\n  }\n  return result\n}\n\nfunction toAccessorString (str) {\n  return '[' + splitParts(str).join('][') + ']'\n}\n\nfunction defineDynamic (type, data) {\n  return new DynamicVariable(type, toAccessorString(data + ''))\n}\n\nfunction isDynamic (x) {\n  return (typeof x === 'function' && !x._reglType) || (x instanceof DynamicVariable)\n}\n\nfunction unbox (x, path) {\n  if (typeof x === 'function') {\n    return new DynamicVariable(DYN_FUNC, x)\n  } else if (typeof x === 'number' || typeof x === 'boolean') {\n    return new DynamicVariable(DYN_CONSTANT, x)\n  } else if (Array.isArray(x)) {\n    return new DynamicVariable(DYN_ARRAY, x.map(function (y, i) { return unbox(y, path + '[' + i + ']') }))\n  } else if (x instanceof DynamicVariable) {\n    return x\n  }\n  \n}\n\nvar dynamic = {\n  DynamicVariable: DynamicVariable,\n  define: defineDynamic,\n  isDynamic: isDynamic,\n  unbox: unbox,\n  accessor: toAccessorString\n};\n\n/* globals requestAnimationFrame, cancelAnimationFrame */\nvar raf = {\n  next: typeof requestAnimationFrame === 'function'\n    ? function (cb) { return requestAnimationFrame(cb) }\n    : function (cb) { return setTimeout(cb, 16) },\n  cancel: typeof cancelAnimationFrame === 'function'\n    ? function (raf) { return cancelAnimationFrame(raf) }\n    : clearTimeout\n};\n\n/* globals performance */\nvar clock = (typeof performance !== 'undefined' && performance.now)\n    ? function () { return performance.now() }\n    : function () { return +(new Date()) };\n\nfunction createStringStore () {\n  var stringIds = { '': 0 }\n  var stringValues = ['']\n  return {\n    id: function (str) {\n      var result = stringIds[str]\n      if (result) {\n        return result\n      }\n      result = stringIds[str] = stringValues.length\n      stringValues.push(str)\n      return result\n    },\n\n    str: function (id) {\n      return stringValues[id]\n    }\n  }\n}\n\n// Context and canvas creation helper functions\n\nfunction createCanvas (element, onDone, pixelRatio) {\n  var canvas = document.createElement('canvas')\n  extend(canvas.style, {\n    border: 0,\n    margin: 0,\n    padding: 0,\n    top: 0,\n    left: 0\n  })\n  element.appendChild(canvas)\n\n  if (element === document.body) {\n    canvas.style.position = 'absolute'\n    extend(element.style, {\n      margin: 0,\n      padding: 0\n    })\n  }\n\n  function resize () {\n    var w = window.innerWidth\n    var h = window.innerHeight\n    if (element !== document.body) {\n      var bounds = element.getBoundingClientRect()\n      w = bounds.right - bounds.left\n      h = bounds.bottom - bounds.top\n    }\n    canvas.width = pixelRatio * w\n    canvas.height = pixelRatio * h\n    extend(canvas.style, {\n      width: w + 'px',\n      height: h + 'px'\n    })\n  }\n\n  var resizeObserver\n  if (element !== document.body && typeof ResizeObserver === 'function') {\n    // ignore 'ResizeObserver' is not defined\n    // eslint-disable-next-line\n    resizeObserver = new ResizeObserver(function () {\n      // setTimeout to avoid flicker\n      setTimeout(resize)\n    })\n    resizeObserver.observe(element)\n  } else {\n    window.addEventListener('resize', resize, false)\n  }\n\n  function onDestroy () {\n    if (resizeObserver) {\n      resizeObserver.disconnect()\n    } else {\n      window.removeEventListener('resize', resize)\n    }\n    element.removeChild(canvas)\n  }\n\n  resize()\n\n  return {\n    canvas: canvas,\n    onDestroy: onDestroy\n  }\n}\n\nfunction createContext (canvas, contextAttributes) {\n  function get (name) {\n    try {\n      return canvas.getContext(name, contextAttributes)\n    } catch (e) {\n      return null\n    }\n  }\n  return (\n    get('webgl') ||\n    get('experimental-webgl') ||\n    get('webgl-experimental')\n  )\n}\n\nfunction isHTMLElement (obj) {\n  return (\n    typeof obj.nodeName === 'string' &&\n    typeof obj.appendChild === 'function' &&\n    typeof obj.getBoundingClientRect === 'function'\n  )\n}\n\nfunction isWebGLContext (obj) {\n  return (\n    typeof obj.drawArrays === 'function' ||\n    typeof obj.drawElements === 'function'\n  )\n}\n\nfunction parseExtensions (input) {\n  if (typeof input === 'string') {\n    return input.split()\n  }\n  \n  return input\n}\n\nfunction getElement (desc) {\n  if (typeof desc === 'string') {\n    \n    return document.querySelector(desc)\n  }\n  return desc\n}\n\nfunction parseArgs (args_) {\n  var args = args_ || {}\n  var element, container, canvas, gl\n  var contextAttributes = {}\n  var extensions = []\n  var optionalExtensions = []\n  var pixelRatio = (typeof window === 'undefined' ? 1 : window.devicePixelRatio)\n  var profile = false\n  var onDone = function (err) {\n    if (err) {\n      \n    }\n  }\n  var onDestroy = function () {}\n  if (typeof args === 'string') {\n    \n    element = document.querySelector(args)\n    \n  } else if (typeof args === 'object') {\n    if (isHTMLElement(args)) {\n      element = args\n    } else if (isWebGLContext(args)) {\n      gl = args\n      canvas = gl.canvas\n    } else {\n      \n      if ('gl' in args) {\n        gl = args.gl\n      } else if ('canvas' in args) {\n        canvas = getElement(args.canvas)\n      } else if ('container' in args) {\n        container = getElement(args.container)\n      }\n      if ('attributes' in args) {\n        contextAttributes = args.attributes\n        \n      }\n      if ('extensions' in args) {\n        extensions = parseExtensions(args.extensions)\n      }\n      if ('optionalExtensions' in args) {\n        optionalExtensions = parseExtensions(args.optionalExtensions)\n      }\n      if ('onDone' in args) {\n        \n        onDone = args.onDone\n      }\n      if ('profile' in args) {\n        profile = !!args.profile\n      }\n      if ('pixelRatio' in args) {\n        pixelRatio = +args.pixelRatio\n        \n      }\n    }\n  } else {\n    \n  }\n\n  if (element) {\n    if (element.nodeName.toLowerCase() === 'canvas') {\n      canvas = element\n    } else {\n      container = element\n    }\n  }\n\n  if (!gl) {\n    if (!canvas) {\n      \n      var result = createCanvas(container || document.body, onDone, pixelRatio)\n      if (!result) {\n        return null\n      }\n      canvas = result.canvas\n      onDestroy = result.onDestroy\n    }\n    // workaround for chromium bug, premultiplied alpha value is platform dependent\n    if (contextAttributes.premultipliedAlpha === undefined) contextAttributes.premultipliedAlpha = true\n    gl = createContext(canvas, contextAttributes)\n  }\n\n  if (!gl) {\n    onDestroy()\n    onDone('webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org')\n    return null\n  }\n\n  return {\n    gl: gl,\n    canvas: canvas,\n    container: container,\n    extensions: extensions,\n    optionalExtensions: optionalExtensions,\n    pixelRatio: pixelRatio,\n    profile: profile,\n    onDone: onDone,\n    onDestroy: onDestroy\n  }\n}\n\nfunction createExtensionCache (gl, config) {\n  var extensions = {}\n\n  function tryLoadExtension (name_) {\n    \n    var name = name_.toLowerCase()\n    var ext\n    try {\n      ext = extensions[name] = gl.getExtension(name)\n    } catch (e) {}\n    return !!ext\n  }\n\n  for (var i = 0; i < config.extensions.length; ++i) {\n    var name = config.extensions[i]\n    if (!tryLoadExtension(name)) {\n      config.onDestroy()\n      config.onDone('\"' + name + '\" extension is not supported by the current WebGL context, try upgrading your system or a different browser')\n      return null\n    }\n  }\n\n  config.optionalExtensions.forEach(tryLoadExtension)\n\n  return {\n    extensions: extensions,\n    restore: function () {\n      Object.keys(extensions).forEach(function (name) {\n        if (extensions[name] && !tryLoadExtension(name)) {\n          throw new Error('(regl): error restoring extension ' + name)\n        }\n      })\n    }\n  }\n}\n\nfunction loop (n, f) {\n  var result = Array(n)\n  for (var i = 0; i < n; ++i) {\n    result[i] = f(i)\n  }\n  return result\n}\n\nvar GL_BYTE = 5120\nvar GL_UNSIGNED_BYTE$1 = 5121\nvar GL_SHORT = 5122\nvar GL_UNSIGNED_SHORT = 5123\nvar GL_INT = 5124\nvar GL_UNSIGNED_INT = 5125\nvar GL_FLOAT$1 = 5126\n\nfunction nextPow16 (v) {\n  for (var i = 16; i <= (1 << 28); i *= 16) {\n    if (v <= i) {\n      return i\n    }\n  }\n  return 0\n}\n\nfunction log2 (v) {\n  var r, shift\n  r = (v > 0xFFFF) << 4\n  v >>>= r\n  shift = (v > 0xFF) << 3\n  v >>>= shift; r |= shift\n  shift = (v > 0xF) << 2\n  v >>>= shift; r |= shift\n  shift = (v > 0x3) << 1\n  v >>>= shift; r |= shift\n  return r | (v >> 1)\n}\n\nfunction createPool () {\n  var bufferPool = loop(8, function () {\n    return []\n  })\n\n  function alloc (n) {\n    var sz = nextPow16(n)\n    var bin = bufferPool[log2(sz) >> 2]\n    if (bin.length > 0) {\n      return bin.pop()\n    }\n    return new ArrayBuffer(sz)\n  }\n\n  function free (buf) {\n    bufferPool[log2(buf.byteLength) >> 2].push(buf)\n  }\n\n  function allocType (type, n) {\n    var result = null\n    switch (type) {\n      case GL_BYTE:\n        result = new Int8Array(alloc(n), 0, n)\n        break\n      case GL_UNSIGNED_BYTE$1:\n        result = new Uint8Array(alloc(n), 0, n)\n        break\n      case GL_SHORT:\n        result = new Int16Array(alloc(2 * n), 0, n)\n        break\n      case GL_UNSIGNED_SHORT:\n        result = new Uint16Array(alloc(2 * n), 0, n)\n        break\n      case GL_INT:\n        result = new Int32Array(alloc(4 * n), 0, n)\n        break\n      case GL_UNSIGNED_INT:\n        result = new Uint32Array(alloc(4 * n), 0, n)\n        break\n      case GL_FLOAT$1:\n        result = new Float32Array(alloc(4 * n), 0, n)\n        break\n      default:\n        return null\n    }\n    if (result.length !== n) {\n      return result.subarray(0, n)\n    }\n    return result\n  }\n\n  function freeType (array) {\n    free(array.buffer)\n  }\n\n  return {\n    alloc: alloc,\n    free: free,\n    allocType: allocType,\n    freeType: freeType\n  }\n}\n\nvar pool = createPool()\n\n// zero pool for initial zero data\npool.zero = createPool()\n\nvar GL_SUBPIXEL_BITS = 0x0D50\nvar GL_RED_BITS = 0x0D52\nvar GL_GREEN_BITS = 0x0D53\nvar GL_BLUE_BITS = 0x0D54\nvar GL_ALPHA_BITS = 0x0D55\nvar GL_DEPTH_BITS = 0x0D56\nvar GL_STENCIL_BITS = 0x0D57\n\nvar GL_ALIASED_POINT_SIZE_RANGE = 0x846D\nvar GL_ALIASED_LINE_WIDTH_RANGE = 0x846E\n\nvar GL_MAX_TEXTURE_SIZE = 0x0D33\nvar GL_MAX_VIEWPORT_DIMS = 0x0D3A\nvar GL_MAX_VERTEX_ATTRIBS = 0x8869\nvar GL_MAX_VERTEX_UNIFORM_VECTORS = 0x8DFB\nvar GL_MAX_VARYING_VECTORS = 0x8DFC\nvar GL_MAX_COMBINED_TEXTURE_IMAGE_UNITS = 0x8B4D\nvar GL_MAX_VERTEX_TEXTURE_IMAGE_UNITS = 0x8B4C\nvar GL_MAX_TEXTURE_IMAGE_UNITS = 0x8872\nvar GL_MAX_FRAGMENT_UNIFORM_VECTORS = 0x8DFD\nvar GL_MAX_CUBE_MAP_TEXTURE_SIZE = 0x851C\nvar GL_MAX_RENDERBUFFER_SIZE = 0x84E8\n\nvar GL_VENDOR = 0x1F00\nvar GL_RENDERER = 0x1F01\nvar GL_VERSION = 0x1F02\nvar GL_SHADING_LANGUAGE_VERSION = 0x8B8C\n\nvar GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT = 0x84FF\n\nvar GL_MAX_COLOR_ATTACHMENTS_WEBGL = 0x8CDF\nvar GL_MAX_DRAW_BUFFERS_WEBGL = 0x8824\n\nvar GL_TEXTURE_2D = 0x0DE1\nvar GL_TEXTURE_CUBE_MAP = 0x8513\nvar GL_TEXTURE_CUBE_MAP_POSITIVE_X = 0x8515\nvar GL_TEXTURE0 = 0x84C0\nvar GL_RGBA = 0x1908\nvar GL_FLOAT = 0x1406\nvar GL_UNSIGNED_BYTE = 0x1401\nvar GL_FRAMEBUFFER = 0x8D40\nvar GL_FRAMEBUFFER_COMPLETE = 0x8CD5\nvar GL_COLOR_ATTACHMENT0 = 0x8CE0\nvar GL_COLOR_BUFFER_BIT$1 = 0x4000\n\nvar wrapLimits = function (gl, extensions) {\n  var maxAnisotropic = 1\n  if (extensions.ext_texture_filter_anisotropic) {\n    maxAnisotropic = gl.getParameter(GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT)\n  }\n\n  var maxDrawbuffers = 1\n  var maxColorAttachments = 1\n  if (extensions.webgl_draw_buffers) {\n    maxDrawbuffers = gl.getParameter(GL_MAX_DRAW_BUFFERS_WEBGL)\n    maxColorAttachments = gl.getParameter(GL_MAX_COLOR_ATTACHMENTS_WEBGL)\n  }\n\n  // detect if reading float textures is available (Safari doesn't support)\n  var readFloat = !!extensions.oes_texture_float\n  if (readFloat) {\n    var readFloatTexture = gl.createTexture()\n    gl.bindTexture(GL_TEXTURE_2D, readFloatTexture)\n    gl.texImage2D(GL_TEXTURE_2D, 0, GL_RGBA, 1, 1, 0, GL_RGBA, GL_FLOAT, null)\n\n    var fbo = gl.createFramebuffer()\n    gl.bindFramebuffer(GL_FRAMEBUFFER, fbo)\n    gl.framebufferTexture2D(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, readFloatTexture, 0)\n    gl.bindTexture(GL_TEXTURE_2D, null)\n\n    if (gl.checkFramebufferStatus(GL_FRAMEBUFFER) !== GL_FRAMEBUFFER_COMPLETE) readFloat = false\n\n    else {\n      gl.viewport(0, 0, 1, 1)\n      gl.clearColor(1.0, 0.0, 0.0, 1.0)\n      gl.clear(GL_COLOR_BUFFER_BIT$1)\n      var pixels = pool.allocType(GL_FLOAT, 4)\n      gl.readPixels(0, 0, 1, 1, GL_RGBA, GL_FLOAT, pixels)\n\n      if (gl.getError()) readFloat = false\n      else {\n        gl.deleteFramebuffer(fbo)\n        gl.deleteTexture(readFloatTexture)\n\n        readFloat = pixels[0] === 1.0\n      }\n\n      pool.freeType(pixels)\n    }\n  }\n\n  // detect non power of two cube textures support (IE doesn't support)\n  var isIE = typeof navigator !== 'undefined' && (/MSIE/.test(navigator.userAgent) || /Trident\\//.test(navigator.appVersion) || /Edge/.test(navigator.userAgent))\n\n  var npotTextureCube = true\n\n  if (!isIE) {\n    var cubeTexture = gl.createTexture()\n    var data = pool.allocType(GL_UNSIGNED_BYTE, 36)\n    gl.activeTexture(GL_TEXTURE0)\n    gl.bindTexture(GL_TEXTURE_CUBE_MAP, cubeTexture)\n    gl.texImage2D(GL_TEXTURE_CUBE_MAP_POSITIVE_X, 0, GL_RGBA, 3, 3, 0, GL_RGBA, GL_UNSIGNED_BYTE, data)\n    pool.freeType(data)\n    gl.bindTexture(GL_TEXTURE_CUBE_MAP, null)\n    gl.deleteTexture(cubeTexture)\n    npotTextureCube = !gl.getError()\n  }\n\n  return {\n    // drawing buffer bit depth\n    colorBits: [\n      gl.getParameter(GL_RED_BITS),\n      gl.getParameter(GL_GREEN_BITS),\n      gl.getParameter(GL_BLUE_BITS),\n      gl.getParameter(GL_ALPHA_BITS)\n    ],\n    depthBits: gl.getParameter(GL_DEPTH_BITS),\n    stencilBits: gl.getParameter(GL_STENCIL_BITS),\n    subpixelBits: gl.getParameter(GL_SUBPIXEL_BITS),\n\n    // supported extensions\n    extensions: Object.keys(extensions).filter(function (ext) {\n      return !!extensions[ext]\n    }),\n\n    // max aniso samples\n    maxAnisotropic: maxAnisotropic,\n\n    // max draw buffers\n    maxDrawbuffers: maxDrawbuffers,\n    maxColorAttachments: maxColorAttachments,\n\n    // point and line size ranges\n    pointSizeDims: gl.getParameter(GL_ALIASED_POINT_SIZE_RANGE),\n    lineWidthDims: gl.getParameter(GL_ALIASED_LINE_WIDTH_RANGE),\n    maxViewportDims: gl.getParameter(GL_MAX_VIEWPORT_DIMS),\n    maxCombinedTextureUnits: gl.getParameter(GL_MAX_COMBINED_TEXTURE_IMAGE_UNITS),\n    maxCubeMapSize: gl.getParameter(GL_MAX_CUBE_MAP_TEXTURE_SIZE),\n    maxRenderbufferSize: gl.getParameter(GL_MAX_RENDERBUFFER_SIZE),\n    maxTextureUnits: gl.getParameter(GL_MAX_TEXTURE_IMAGE_UNITS),\n    maxTextureSize: gl.getParameter(GL_MAX_TEXTURE_SIZE),\n    maxAttributes: gl.getParameter(GL_MAX_VERTEX_ATTRIBS),\n    maxVertexUniforms: gl.getParameter(GL_MAX_VERTEX_UNIFORM_VECTORS),\n    maxVertexTextureUnits: gl.getParameter(GL_MAX_VERTEX_TEXTURE_IMAGE_UNITS),\n    maxVaryingVectors: gl.getParameter(GL_MAX_VARYING_VECTORS),\n    maxFragmentUniforms: gl.getParameter(GL_MAX_FRAGMENT_UNIFORM_VECTORS),\n\n    // vendor info\n    glsl: gl.getParameter(GL_SHADING_LANGUAGE_VERSION),\n    renderer: gl.getParameter(GL_RENDERER),\n    vendor: gl.getParameter(GL_VENDOR),\n    version: gl.getParameter(GL_VERSION),\n\n    // quirks\n    readFloat: readFloat,\n    npotTextureCube: npotTextureCube\n  }\n}\n\nvar isTypedArray = function (x) {\n  return (\n    x instanceof Uint8Array ||\n    x instanceof Uint16Array ||\n    x instanceof Uint32Array ||\n    x instanceof Int8Array ||\n    x instanceof Int16Array ||\n    x instanceof Int32Array ||\n    x instanceof Float32Array ||\n    x instanceof Float64Array ||\n    x instanceof Uint8ClampedArray\n  )\n}\n\nfunction isNDArrayLike (obj) {\n  return (\n    !!obj &&\n    typeof obj === 'object' &&\n    Array.isArray(obj.shape) &&\n    Array.isArray(obj.stride) &&\n    typeof obj.offset === 'number' &&\n    obj.shape.length === obj.stride.length &&\n    (Array.isArray(obj.data) ||\n      isTypedArray(obj.data)))\n}\n\nvar values = function (obj) {\n  return Object.keys(obj).map(function (key) { return obj[key] })\n}\n\nvar flattenUtils = {\n  shape: arrayShape$1,\n  flatten: flattenArray\n};\n\nfunction flatten1D (array, nx, out) {\n  for (var i = 0; i < nx; ++i) {\n    out[i] = array[i]\n  }\n}\n\nfunction flatten2D (array, nx, ny, out) {\n  var ptr = 0\n  for (var i = 0; i < nx; ++i) {\n    var row = array[i]\n    for (var j = 0; j < ny; ++j) {\n      out[ptr++] = row[j]\n    }\n  }\n}\n\nfunction flatten3D (array, nx, ny, nz, out, ptr_) {\n  var ptr = ptr_\n  for (var i = 0; i < nx; ++i) {\n    var row = array[i]\n    for (var j = 0; j < ny; ++j) {\n      var col = row[j]\n      for (var k = 0; k < nz; ++k) {\n        out[ptr++] = col[k]\n      }\n    }\n  }\n}\n\nfunction flattenRec (array, shape, level, out, ptr) {\n  var stride = 1\n  for (var i = level + 1; i < shape.length; ++i) {\n    stride *= shape[i]\n  }\n  var n = shape[level]\n  if (shape.length - level === 4) {\n    var nx = shape[level + 1]\n    var ny = shape[level + 2]\n    var nz = shape[level + 3]\n    for (i = 0; i < n; ++i) {\n      flatten3D(array[i], nx, ny, nz, out, ptr)\n      ptr += stride\n    }\n  } else {\n    for (i = 0; i < n; ++i) {\n      flattenRec(array[i], shape, level + 1, out, ptr)\n      ptr += stride\n    }\n  }\n}\n\nfunction flattenArray (array, shape, type, out_) {\n  var sz = 1\n  if (shape.length) {\n    for (var i = 0; i < shape.length; ++i) {\n      sz *= shape[i]\n    }\n  } else {\n    sz = 0\n  }\n  var out = out_ || pool.allocType(type, sz)\n  switch (shape.length) {\n    case 0:\n      break\n    case 1:\n      flatten1D(array, shape[0], out)\n      break\n    case 2:\n      flatten2D(array, shape[0], shape[1], out)\n      break\n    case 3:\n      flatten3D(array, shape[0], shape[1], shape[2], out, 0)\n      break\n    default:\n      flattenRec(array, shape, 0, out, 0)\n  }\n  return out\n}\n\nfunction arrayShape$1 (array_) {\n  var shape = []\n  for (var array = array_; array.length; array = array[0]) {\n    shape.push(array.length)\n  }\n  return shape\n}\n\nvar arrayTypes = {\n\t\"[object Int8Array]\": 5120,\n\t\"[object Int16Array]\": 5122,\n\t\"[object Int32Array]\": 5124,\n\t\"[object Uint8Array]\": 5121,\n\t\"[object Uint8ClampedArray]\": 5121,\n\t\"[object Uint16Array]\": 5123,\n\t\"[object Uint32Array]\": 5125,\n\t\"[object Float32Array]\": 5126,\n\t\"[object Float64Array]\": 5121,\n\t\"[object ArrayBuffer]\": 5121\n};\n\nvar int8 = 5120;\nvar int16 = 5122;\nvar int32 = 5124;\nvar uint8 = 5121;\nvar uint16 = 5123;\nvar uint32 = 5125;\nvar float = 5126;\nvar float32 = 5126;\nvar glTypes = {\n\tint8: int8,\n\tint16: int16,\n\tint32: int32,\n\tuint8: uint8,\n\tuint16: uint16,\n\tuint32: uint32,\n\tfloat: float,\n\tfloat32: float32\n};\n\nvar dynamic$1 = 35048;\nvar stream = 35040;\nvar usageTypes = {\n\tdynamic: dynamic$1,\n\tstream: stream,\n\t\"static\": 35044\n};\n\nvar arrayFlatten = flattenUtils.flatten\nvar arrayShape = flattenUtils.shape\n\nvar GL_STATIC_DRAW = 0x88E4\nvar GL_STREAM_DRAW = 0x88E0\n\nvar GL_UNSIGNED_BYTE$2 = 5121\nvar GL_FLOAT$2 = 5126\n\nvar DTYPES_SIZES = []\nDTYPES_SIZES[5120] = 1 // int8\nDTYPES_SIZES[5122] = 2 // int16\nDTYPES_SIZES[5124] = 4 // int32\nDTYPES_SIZES[5121] = 1 // uint8\nDTYPES_SIZES[5123] = 2 // uint16\nDTYPES_SIZES[5125] = 4 // uint32\nDTYPES_SIZES[5126] = 4 // float32\n\nfunction typedArrayCode (data) {\n  return arrayTypes[Object.prototype.toString.call(data)] | 0\n}\n\nfunction copyArray (out, inp) {\n  for (var i = 0; i < inp.length; ++i) {\n    out[i] = inp[i]\n  }\n}\n\nfunction transpose (\n  result, data, shapeX, shapeY, strideX, strideY, offset) {\n  var ptr = 0\n  for (var i = 0; i < shapeX; ++i) {\n    for (var j = 0; j < shapeY; ++j) {\n      result[ptr++] = data[strideX * i + strideY * j + offset]\n    }\n  }\n}\n\nfunction wrapBufferState (gl, stats, config, destroyBuffer) {\n  var bufferCount = 0\n  var bufferSet = {}\n\n  function REGLBuffer (type) {\n    this.id = bufferCount++\n    this.buffer = gl.createBuffer()\n    this.type = type\n    this.usage = GL_STATIC_DRAW\n    this.byteLength = 0\n    this.dimension = 1\n    this.dtype = GL_UNSIGNED_BYTE$2\n\n    this.persistentData = null\n\n    if (config.profile) {\n      this.stats = { size: 0 }\n    }\n  }\n\n  REGLBuffer.prototype.bind = function () {\n    gl.bindBuffer(this.type, this.buffer)\n  }\n\n  REGLBuffer.prototype.destroy = function () {\n    destroy(this)\n  }\n\n  var streamPool = []\n\n  function createStream (type, data) {\n    var buffer = streamPool.pop()\n    if (!buffer) {\n      buffer = new REGLBuffer(type)\n    }\n    buffer.bind()\n    initBufferFromData(buffer, data, GL_STREAM_DRAW, 0, 1, false)\n    return buffer\n  }\n\n  function destroyStream (stream$$1) {\n    streamPool.push(stream$$1)\n  }\n\n  function initBufferFromTypedArray (buffer, data, usage) {\n    buffer.byteLength = data.byteLength\n    gl.bufferData(buffer.type, data, usage)\n  }\n\n  function initBufferFromData (buffer, data, usage, dtype, dimension, persist) {\n    var shape\n    buffer.usage = usage\n    if (Array.isArray(data)) {\n      buffer.dtype = dtype || GL_FLOAT$2\n      if (data.length > 0) {\n        var flatData\n        if (Array.isArray(data[0])) {\n          shape = arrayShape(data)\n          var dim = 1\n          for (var i = 1; i < shape.length; ++i) {\n            dim *= shape[i]\n          }\n          buffer.dimension = dim\n          flatData = arrayFlatten(data, shape, buffer.dtype)\n          initBufferFromTypedArray(buffer, flatData, usage)\n          if (persist) {\n            buffer.persistentData = flatData\n          } else {\n            pool.freeType(flatData)\n          }\n        } else if (typeof data[0] === 'number') {\n          buffer.dimension = dimension\n          var typedData = pool.allocType(buffer.dtype, data.length)\n          copyArray(typedData, data)\n          initBufferFromTypedArray(buffer, typedData, usage)\n          if (persist) {\n            buffer.persistentData = typedData\n          } else {\n            pool.freeType(typedData)\n          }\n        } else if (isTypedArray(data[0])) {\n          buffer.dimension = data[0].length\n          buffer.dtype = dtype || typedArrayCode(data[0]) || GL_FLOAT$2\n          flatData = arrayFlatten(\n            data,\n            [data.length, data[0].length],\n            buffer.dtype)\n          initBufferFromTypedArray(buffer, flatData, usage)\n          if (persist) {\n            buffer.persistentData = flatData\n          } else {\n            pool.freeType(flatData)\n          }\n        } else {\n          \n        }\n      }\n    } else if (isTypedArray(data)) {\n      buffer.dtype = dtype || typedArrayCode(data)\n      buffer.dimension = dimension\n      initBufferFromTypedArray(buffer, data, usage)\n      if (persist) {\n        buffer.persistentData = new Uint8Array(new Uint8Array(data.buffer))\n      }\n    } else if (isNDArrayLike(data)) {\n      shape = data.shape\n      var stride = data.stride\n      var offset = data.offset\n\n      var shapeX = 0\n      var shapeY = 0\n      var strideX = 0\n      var strideY = 0\n      if (shape.length === 1) {\n        shapeX = shape[0]\n        shapeY = 1\n        strideX = stride[0]\n        strideY = 0\n      } else if (shape.length === 2) {\n        shapeX = shape[0]\n        shapeY = shape[1]\n        strideX = stride[0]\n        strideY = stride[1]\n      } else {\n        \n      }\n\n      buffer.dtype = dtype || typedArrayCode(data.data) || GL_FLOAT$2\n      buffer.dimension = shapeY\n\n      var transposeData = pool.allocType(buffer.dtype, shapeX * shapeY)\n      transpose(transposeData,\n        data.data,\n        shapeX, shapeY,\n        strideX, strideY,\n        offset)\n      initBufferFromTypedArray(buffer, transposeData, usage)\n      if (persist) {\n        buffer.persistentData = transposeData\n      } else {\n        pool.freeType(transposeData)\n      }\n    } else if (data instanceof ArrayBuffer) {\n      buffer.dtype = GL_UNSIGNED_BYTE$2\n      buffer.dimension = dimension\n      initBufferFromTypedArray(buffer, data, usage)\n      if (persist) {\n        buffer.persistentData = new Uint8Array(new Uint8Array(data))\n      }\n    } else {\n      \n    }\n  }\n\n  function destroy (buffer) {\n    stats.bufferCount--\n\n    // remove attribute link\n    destroyBuffer(buffer)\n\n    var handle = buffer.buffer\n    \n    gl.deleteBuffer(handle)\n    buffer.buffer = null\n    delete bufferSet[buffer.id]\n  }\n\n  function createBuffer (options, type, deferInit, persistent) {\n    stats.bufferCount++\n\n    var buffer = new REGLBuffer(type)\n    bufferSet[buffer.id] = buffer\n\n    function reglBuffer (options) {\n      var usage = GL_STATIC_DRAW\n      var data = null\n      var byteLength = 0\n      var dtype = 0\n      var dimension = 1\n      if (Array.isArray(options) ||\n          isTypedArray(options) ||\n          isNDArrayLike(options) ||\n          options instanceof ArrayBuffer) {\n        data = options\n      } else if (typeof options === 'number') {\n        byteLength = options | 0\n      } else if (options) {\n        \n\n        if ('data' in options) {\n          \n          data = options.data\n        }\n\n        if ('usage' in options) {\n          \n          usage = usageTypes[options.usage]\n        }\n\n        if ('type' in options) {\n          \n          dtype = glTypes[options.type]\n        }\n\n        if ('dimension' in options) {\n          \n          dimension = options.dimension | 0\n        }\n\n        if ('length' in options) {\n          \n          byteLength = options.length | 0\n        }\n      }\n\n      buffer.bind()\n      if (!data) {\n        // #475\n        if (byteLength) gl.bufferData(buffer.type, byteLength, usage)\n        buffer.dtype = dtype || GL_UNSIGNED_BYTE$2\n        buffer.usage = usage\n        buffer.dimension = dimension\n        buffer.byteLength = byteLength\n      } else {\n        initBufferFromData(buffer, data, usage, dtype, dimension, persistent)\n      }\n\n      if (config.profile) {\n        buffer.stats.size = buffer.byteLength * DTYPES_SIZES[buffer.dtype]\n      }\n\n      return reglBuffer\n    }\n\n    function setSubData (data, offset) {\n      \n\n      gl.bufferSubData(buffer.type, offset, data)\n    }\n\n    function subdata (data, offset_) {\n      var offset = (offset_ || 0) | 0\n      var shape\n      buffer.bind()\n      if (isTypedArray(data) || data instanceof ArrayBuffer) {\n        setSubData(data, offset)\n      } else if (Array.isArray(data)) {\n        if (data.length > 0) {\n          if (typeof data[0] === 'number') {\n            var converted = pool.allocType(buffer.dtype, data.length)\n            copyArray(converted, data)\n            setSubData(converted, offset)\n            pool.freeType(converted)\n          } else if (Array.isArray(data[0]) || isTypedArray(data[0])) {\n            shape = arrayShape(data)\n            var flatData = arrayFlatten(data, shape, buffer.dtype)\n            setSubData(flatData, offset)\n            pool.freeType(flatData)\n          } else {\n            \n          }\n        }\n      } else if (isNDArrayLike(data)) {\n        shape = data.shape\n        var stride = data.stride\n\n        var shapeX = 0\n        var shapeY = 0\n        var strideX = 0\n        var strideY = 0\n        if (shape.length === 1) {\n          shapeX = shape[0]\n          shapeY = 1\n          strideX = stride[0]\n          strideY = 0\n        } else if (shape.length === 2) {\n          shapeX = shape[0]\n          shapeY = shape[1]\n          strideX = stride[0]\n          strideY = stride[1]\n        } else {\n          \n        }\n        var dtype = Array.isArray(data.data)\n          ? buffer.dtype\n          : typedArrayCode(data.data)\n\n        var transposeData = pool.allocType(dtype, shapeX * shapeY)\n        transpose(transposeData,\n          data.data,\n          shapeX, shapeY,\n          strideX, strideY,\n          data.offset)\n        setSubData(transposeData, offset)\n        pool.freeType(transposeData)\n      } else {\n        \n      }\n      return reglBuffer\n    }\n\n    if (!deferInit) {\n      reglBuffer(options)\n    }\n\n    reglBuffer._reglType = 'buffer'\n    reglBuffer._buffer = buffer\n    reglBuffer.subdata = subdata\n    if (config.profile) {\n      reglBuffer.stats = buffer.stats\n    }\n    reglBuffer.destroy = function () { destroy(buffer) }\n\n    return reglBuffer\n  }\n\n  function restoreBuffers () {\n    values(bufferSet).forEach(function (buffer) {\n      buffer.buffer = gl.createBuffer()\n      gl.bindBuffer(buffer.type, buffer.buffer)\n      gl.bufferData(\n        buffer.type, buffer.persistentData || buffer.byteLength, buffer.usage)\n    })\n  }\n\n  if (config.profile) {\n    stats.getTotalBufferSize = function () {\n      var total = 0\n      // TODO: Right now, the streams are not part of the total count.\n      Object.keys(bufferSet).forEach(function (key) {\n        total += bufferSet[key].stats.size\n      })\n      return total\n    }\n  }\n\n  return {\n    create: createBuffer,\n\n    createStream: createStream,\n    destroyStream: destroyStream,\n\n    clear: function () {\n      values(bufferSet).forEach(destroy)\n      streamPool.forEach(destroy)\n    },\n\n    getBuffer: function (wrapper) {\n      if (wrapper && wrapper._buffer instanceof REGLBuffer) {\n        return wrapper._buffer\n      }\n      return null\n    },\n\n    restore: restoreBuffers,\n\n    _initBuffer: initBufferFromData\n  }\n}\n\nvar points = 0;\nvar point = 0;\nvar lines = 1;\nvar line = 1;\nvar triangles = 4;\nvar triangle = 4;\nvar primTypes = {\n\tpoints: points,\n\tpoint: point,\n\tlines: lines,\n\tline: line,\n\ttriangles: triangles,\n\ttriangle: triangle,\n\t\"line loop\": 2,\n\t\"line strip\": 3,\n\t\"triangle strip\": 5,\n\t\"triangle fan\": 6\n};\n\nvar GL_POINTS = 0\nvar GL_LINES = 1\nvar GL_TRIANGLES = 4\n\nvar GL_BYTE$1 = 5120\nvar GL_UNSIGNED_BYTE$3 = 5121\nvar GL_SHORT$1 = 5122\nvar GL_UNSIGNED_SHORT$1 = 5123\nvar GL_INT$1 = 5124\nvar GL_UNSIGNED_INT$1 = 5125\n\nvar GL_ELEMENT_ARRAY_BUFFER = 34963\n\nvar GL_STREAM_DRAW$1 = 0x88E0\nvar GL_STATIC_DRAW$1 = 0x88E4\n\nfunction wrapElementsState (gl, extensions, bufferState, stats) {\n  var elementSet = {}\n  var elementCount = 0\n\n  var elementTypes = {\n    'uint8': GL_UNSIGNED_BYTE$3,\n    'uint16': GL_UNSIGNED_SHORT$1\n  }\n\n  if (extensions.oes_element_index_uint) {\n    elementTypes.uint32 = GL_UNSIGNED_INT$1\n  }\n\n  function REGLElementBuffer (buffer) {\n    this.id = elementCount++\n    elementSet[this.id] = this\n    this.buffer = buffer\n    this.primType = GL_TRIANGLES\n    this.vertCount = 0\n    this.type = 0\n  }\n\n  REGLElementBuffer.prototype.bind = function () {\n    this.buffer.bind()\n  }\n\n  var bufferPool = []\n\n  function createElementStream (data) {\n    var result = bufferPool.pop()\n    if (!result) {\n      result = new REGLElementBuffer(bufferState.create(\n        null,\n        GL_ELEMENT_ARRAY_BUFFER,\n        true,\n        false)._buffer)\n    }\n    initElements(result, data, GL_STREAM_DRAW$1, -1, -1, 0, 0)\n    return result\n  }\n\n  function destroyElementStream (elements) {\n    bufferPool.push(elements)\n  }\n\n  function initElements (\n    elements,\n    data,\n    usage,\n    prim,\n    count,\n    byteLength,\n    type) {\n    elements.buffer.bind()\n    var dtype\n    if (data) {\n      var predictedType = type\n      if (!type && (\n        !isTypedArray(data) ||\n         (isNDArrayLike(data) && !isTypedArray(data.data)))) {\n        predictedType = extensions.oes_element_index_uint\n          ? GL_UNSIGNED_INT$1\n          : GL_UNSIGNED_SHORT$1\n      }\n      bufferState._initBuffer(\n        elements.buffer,\n        data,\n        usage,\n        predictedType,\n        3)\n    } else {\n      gl.bufferData(GL_ELEMENT_ARRAY_BUFFER, byteLength, usage)\n      elements.buffer.dtype = dtype || GL_UNSIGNED_BYTE$3\n      elements.buffer.usage = usage\n      elements.buffer.dimension = 3\n      elements.buffer.byteLength = byteLength\n    }\n\n    dtype = type\n    if (!type) {\n      switch (elements.buffer.dtype) {\n        case GL_UNSIGNED_BYTE$3:\n        case GL_BYTE$1:\n          dtype = GL_UNSIGNED_BYTE$3\n          break\n\n        case GL_UNSIGNED_SHORT$1:\n        case GL_SHORT$1:\n          dtype = GL_UNSIGNED_SHORT$1\n          break\n\n        case GL_UNSIGNED_INT$1:\n        case GL_INT$1:\n          dtype = GL_UNSIGNED_INT$1\n          break\n\n        default:\n          \n      }\n      elements.buffer.dtype = dtype\n    }\n    elements.type = dtype\n\n    // Check oes_element_index_uint extension\n    \n\n    // try to guess default primitive type and arguments\n    var vertCount = count\n    if (vertCount < 0) {\n      vertCount = elements.buffer.byteLength\n      if (dtype === GL_UNSIGNED_SHORT$1) {\n        vertCount >>= 1\n      } else if (dtype === GL_UNSIGNED_INT$1) {\n        vertCount >>= 2\n      }\n    }\n    elements.vertCount = vertCount\n\n    // try to guess primitive type from cell dimension\n    var primType = prim\n    if (prim < 0) {\n      primType = GL_TRIANGLES\n      var dimension = elements.buffer.dimension\n      if (dimension === 1) primType = GL_POINTS\n      if (dimension === 2) primType = GL_LINES\n      if (dimension === 3) primType = GL_TRIANGLES\n    }\n    elements.primType = primType\n  }\n\n  function destroyElements (elements) {\n    stats.elementsCount--\n\n    \n    delete elementSet[elements.id]\n    elements.buffer.destroy()\n    elements.buffer = null\n  }\n\n  function createElements (options, persistent) {\n    var buffer = bufferState.create(null, GL_ELEMENT_ARRAY_BUFFER, true)\n    var elements = new REGLElementBuffer(buffer._buffer)\n    stats.elementsCount++\n\n    function reglElements (options) {\n      if (!options) {\n        buffer()\n        elements.primType = GL_TRIANGLES\n        elements.vertCount = 0\n        elements.type = GL_UNSIGNED_BYTE$3\n      } else if (typeof options === 'number') {\n        buffer(options)\n        elements.primType = GL_TRIANGLES\n        elements.vertCount = options | 0\n        elements.type = GL_UNSIGNED_BYTE$3\n      } else {\n        var data = null\n        var usage = GL_STATIC_DRAW$1\n        var primType = -1\n        var vertCount = -1\n        var byteLength = 0\n        var dtype = 0\n        if (Array.isArray(options) ||\n            isTypedArray(options) ||\n            isNDArrayLike(options)) {\n          data = options\n        } else {\n          \n          if ('data' in options) {\n            data = options.data\n            \n          }\n          if ('usage' in options) {\n            \n            usage = usageTypes[options.usage]\n          }\n          if ('primitive' in options) {\n            \n            primType = primTypes[options.primitive]\n          }\n          if ('count' in options) {\n            \n            vertCount = options.count | 0\n          }\n          if ('type' in options) {\n            \n            dtype = elementTypes[options.type]\n          }\n          if ('length' in options) {\n            byteLength = options.length | 0\n          } else {\n            byteLength = vertCount\n            if (dtype === GL_UNSIGNED_SHORT$1 || dtype === GL_SHORT$1) {\n              byteLength *= 2\n            } else if (dtype === GL_UNSIGNED_INT$1 || dtype === GL_INT$1) {\n              byteLength *= 4\n            }\n          }\n        }\n        initElements(\n          elements,\n          data,\n          usage,\n          primType,\n          vertCount,\n          byteLength,\n          dtype)\n      }\n\n      return reglElements\n    }\n\n    reglElements(options)\n\n    reglElements._reglType = 'elements'\n    reglElements._elements = elements\n    reglElements.subdata = function (data, offset) {\n      buffer.subdata(data, offset)\n      return reglElements\n    }\n    reglElements.destroy = function () {\n      destroyElements(elements)\n    }\n\n    return reglElements\n  }\n\n  return {\n    create: createElements,\n    createStream: createElementStream,\n    destroyStream: destroyElementStream,\n    getElements: function (elements) {\n      if (typeof elements === 'function' &&\n          elements._elements instanceof REGLElementBuffer) {\n        return elements._elements\n      }\n      return null\n    },\n    clear: function () {\n      values(elementSet).forEach(destroyElements)\n    }\n  }\n}\n\nvar FLOAT = new Float32Array(1)\nvar INT = new Uint32Array(FLOAT.buffer)\n\nvar GL_UNSIGNED_SHORT$3 = 5123\n\nfunction convertToHalfFloat (array) {\n  var ushorts = pool.allocType(GL_UNSIGNED_SHORT$3, array.length)\n\n  for (var i = 0; i < array.length; ++i) {\n    if (isNaN(array[i])) {\n      ushorts[i] = 0xffff\n    } else if (array[i] === Infinity) {\n      ushorts[i] = 0x7c00\n    } else if (array[i] === -Infinity) {\n      ushorts[i] = 0xfc00\n    } else {\n      FLOAT[0] = array[i]\n      var x = INT[0]\n\n      var sgn = (x >>> 31) << 15\n      var exp = ((x << 1) >>> 24) - 127\n      var frac = (x >> 13) & ((1 << 10) - 1)\n\n      if (exp < -24) {\n        // round non-representable denormals to 0\n        ushorts[i] = sgn\n      } else if (exp < -14) {\n        // handle denormals\n        var s = -14 - exp\n        ushorts[i] = sgn + ((frac + (1 << 10)) >> s)\n      } else if (exp > 15) {\n        // round overflow to +/- Infinity\n        ushorts[i] = sgn + 0x7c00\n      } else {\n        // otherwise convert directly\n        ushorts[i] = sgn + ((exp + 15) << 10) + frac\n      }\n    }\n  }\n\n  return ushorts\n}\n\nfunction isArrayLike (s) {\n  return Array.isArray(s) || isTypedArray(s)\n}\n\nvar GL_COMPRESSED_TEXTURE_FORMATS = 0x86A3\n\nvar GL_TEXTURE_2D$1 = 0x0DE1\nvar GL_TEXTURE_CUBE_MAP$1 = 0x8513\nvar GL_TEXTURE_CUBE_MAP_POSITIVE_X$1 = 0x8515\n\nvar GL_RGBA$1 = 0x1908\nvar GL_ALPHA = 0x1906\nvar GL_RGB = 0x1907\nvar GL_LUMINANCE = 0x1909\nvar GL_LUMINANCE_ALPHA = 0x190A\n\nvar GL_RGBA4 = 0x8056\nvar GL_RGB5_A1 = 0x8057\nvar GL_RGB565 = 0x8D62\n\nvar GL_UNSIGNED_SHORT_4_4_4_4 = 0x8033\nvar GL_UNSIGNED_SHORT_5_5_5_1 = 0x8034\nvar GL_UNSIGNED_SHORT_5_6_5 = 0x8363\nvar GL_UNSIGNED_INT_24_8_WEBGL = 0x84FA\n\nvar GL_DEPTH_COMPONENT = 0x1902\nvar GL_DEPTH_STENCIL = 0x84F9\n\nvar GL_SRGB_EXT = 0x8C40\nvar GL_SRGB_ALPHA_EXT = 0x8C42\n\nvar GL_HALF_FLOAT_OES = 0x8D61\n\nvar GL_COMPRESSED_RGB_S3TC_DXT1_EXT = 0x83F0\nvar GL_COMPRESSED_RGBA_S3TC_DXT1_EXT = 0x83F1\nvar GL_COMPRESSED_RGBA_S3TC_DXT3_EXT = 0x83F2\nvar GL_COMPRESSED_RGBA_S3TC_DXT5_EXT = 0x83F3\n\nvar GL_COMPRESSED_RGB_ATC_WEBGL = 0x8C92\nvar GL_COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL = 0x8C93\nvar GL_COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL = 0x87EE\n\nvar GL_COMPRESSED_RGB_PVRTC_4BPPV1_IMG = 0x8C00\nvar GL_COMPRESSED_RGB_PVRTC_2BPPV1_IMG = 0x8C01\nvar GL_COMPRESSED_RGBA_PVRTC_4BPPV1_IMG = 0x8C02\nvar GL_COMPRESSED_RGBA_PVRTC_2BPPV1_IMG = 0x8C03\n\nvar GL_COMPRESSED_RGB_ETC1_WEBGL = 0x8D64\n\nvar GL_UNSIGNED_BYTE$4 = 0x1401\nvar GL_UNSIGNED_SHORT$2 = 0x1403\nvar GL_UNSIGNED_INT$2 = 0x1405\nvar GL_FLOAT$3 = 0x1406\n\nvar GL_TEXTURE_WRAP_S = 0x2802\nvar GL_TEXTURE_WRAP_T = 0x2803\n\nvar GL_REPEAT = 0x2901\nvar GL_CLAMP_TO_EDGE = 0x812F\nvar GL_MIRRORED_REPEAT = 0x8370\n\nvar GL_TEXTURE_MAG_FILTER = 0x2800\nvar GL_TEXTURE_MIN_FILTER = 0x2801\n\nvar GL_NEAREST = 0x2600\nvar GL_LINEAR = 0x2601\nvar GL_NEAREST_MIPMAP_NEAREST = 0x2700\nvar GL_LINEAR_MIPMAP_NEAREST = 0x2701\nvar GL_NEAREST_MIPMAP_LINEAR = 0x2702\nvar GL_LINEAR_MIPMAP_LINEAR = 0x2703\n\nvar GL_GENERATE_MIPMAP_HINT = 0x8192\nvar GL_DONT_CARE = 0x1100\nvar GL_FASTEST = 0x1101\nvar GL_NICEST = 0x1102\n\nvar GL_TEXTURE_MAX_ANISOTROPY_EXT = 0x84FE\n\nvar GL_UNPACK_ALIGNMENT = 0x0CF5\nvar GL_UNPACK_FLIP_Y_WEBGL = 0x9240\nvar GL_UNPACK_PREMULTIPLY_ALPHA_WEBGL = 0x9241\nvar GL_UNPACK_COLORSPACE_CONVERSION_WEBGL = 0x9243\n\nvar GL_BROWSER_DEFAULT_WEBGL = 0x9244\n\nvar GL_TEXTURE0$1 = 0x84C0\n\nvar MIPMAP_FILTERS = [\n  GL_NEAREST_MIPMAP_NEAREST,\n  GL_NEAREST_MIPMAP_LINEAR,\n  GL_LINEAR_MIPMAP_NEAREST,\n  GL_LINEAR_MIPMAP_LINEAR\n]\n\nvar CHANNELS_FORMAT = [\n  0,\n  GL_LUMINANCE,\n  GL_LUMINANCE_ALPHA,\n  GL_RGB,\n  GL_RGBA$1\n]\n\nvar FORMAT_CHANNELS = {}\nFORMAT_CHANNELS[GL_LUMINANCE] =\nFORMAT_CHANNELS[GL_ALPHA] =\nFORMAT_CHANNELS[GL_DEPTH_COMPONENT] = 1\nFORMAT_CHANNELS[GL_DEPTH_STENCIL] =\nFORMAT_CHANNELS[GL_LUMINANCE_ALPHA] = 2\nFORMAT_CHANNELS[GL_RGB] =\nFORMAT_CHANNELS[GL_SRGB_EXT] = 3\nFORMAT_CHANNELS[GL_RGBA$1] =\nFORMAT_CHANNELS[GL_SRGB_ALPHA_EXT] = 4\n\nfunction objectName (str) {\n  return '[object ' + str + ']'\n}\n\nvar CANVAS_CLASS = objectName('HTMLCanvasElement')\nvar OFFSCREENCANVAS_CLASS = objectName('OffscreenCanvas')\nvar CONTEXT2D_CLASS = objectName('CanvasRenderingContext2D')\nvar BITMAP_CLASS = objectName('ImageBitmap')\nvar IMAGE_CLASS = objectName('HTMLImageElement')\nvar VIDEO_CLASS = objectName('HTMLVideoElement')\n\nvar PIXEL_CLASSES = Object.keys(arrayTypes).concat([\n  CANVAS_CLASS,\n  OFFSCREENCANVAS_CLASS,\n  CONTEXT2D_CLASS,\n  BITMAP_CLASS,\n  IMAGE_CLASS,\n  VIDEO_CLASS\n])\n\n// for every texture type, store\n// the size in bytes.\nvar TYPE_SIZES = []\nTYPE_SIZES[GL_UNSIGNED_BYTE$4] = 1\nTYPE_SIZES[GL_FLOAT$3] = 4\nTYPE_SIZES[GL_HALF_FLOAT_OES] = 2\n\nTYPE_SIZES[GL_UNSIGNED_SHORT$2] = 2\nTYPE_SIZES[GL_UNSIGNED_INT$2] = 4\n\nvar FORMAT_SIZES_SPECIAL = []\nFORMAT_SIZES_SPECIAL[GL_RGBA4] = 2\nFORMAT_SIZES_SPECIAL[GL_RGB5_A1] = 2\nFORMAT_SIZES_SPECIAL[GL_RGB565] = 2\nFORMAT_SIZES_SPECIAL[GL_DEPTH_STENCIL] = 4\n\nFORMAT_SIZES_SPECIAL[GL_COMPRESSED_RGB_S3TC_DXT1_EXT] = 0.5\nFORMAT_SIZES_SPECIAL[GL_COMPRESSED_RGBA_S3TC_DXT1_EXT] = 0.5\nFORMAT_SIZES_SPECIAL[GL_COMPRESSED_RGBA_S3TC_DXT3_EXT] = 1\nFORMAT_SIZES_SPECIAL[GL_COMPRESSED_RGBA_S3TC_DXT5_EXT] = 1\n\nFORMAT_SIZES_SPECIAL[GL_COMPRESSED_RGB_ATC_WEBGL] = 0.5\nFORMAT_SIZES_SPECIAL[GL_COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL] = 1\nFORMAT_SIZES_SPECIAL[GL_COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL] = 1\n\nFORMAT_SIZES_SPECIAL[GL_COMPRESSED_RGB_PVRTC_4BPPV1_IMG] = 0.5\nFORMAT_SIZES_SPECIAL[GL_COMPRESSED_RGB_PVRTC_2BPPV1_IMG] = 0.25\nFORMAT_SIZES_SPECIAL[GL_COMPRESSED_RGBA_PVRTC_4BPPV1_IMG] = 0.5\nFORMAT_SIZES_SPECIAL[GL_COMPRESSED_RGBA_PVRTC_2BPPV1_IMG] = 0.25\n\nFORMAT_SIZES_SPECIAL[GL_COMPRESSED_RGB_ETC1_WEBGL] = 0.5\n\nfunction isNumericArray (arr) {\n  return (\n    Array.isArray(arr) &&\n    (arr.length === 0 ||\n    typeof arr[0] === 'number'))\n}\n\nfunction isRectArray (arr) {\n  if (!Array.isArray(arr)) {\n    return false\n  }\n  var width = arr.length\n  if (width === 0 || !isArrayLike(arr[0])) {\n    return false\n  }\n  return true\n}\n\nfunction classString (x) {\n  return Object.prototype.toString.call(x)\n}\n\nfunction isCanvasElement (object) {\n  return classString(object) === CANVAS_CLASS\n}\n\nfunction isOffscreenCanvas (object) {\n  return classString(object) === OFFSCREENCANVAS_CLASS\n}\n\nfunction isContext2D (object) {\n  return classString(object) === CONTEXT2D_CLASS\n}\n\nfunction isBitmap (object) {\n  return classString(object) === BITMAP_CLASS\n}\n\nfunction isImageElement (object) {\n  return classString(object) === IMAGE_CLASS\n}\n\nfunction isVideoElement (object) {\n  return classString(object) === VIDEO_CLASS\n}\n\nfunction isPixelData (object) {\n  if (!object) {\n    return false\n  }\n  var className = classString(object)\n  if (PIXEL_CLASSES.indexOf(className) >= 0) {\n    return true\n  }\n  return (\n    isNumericArray(object) ||\n    isRectArray(object) ||\n    isNDArrayLike(object))\n}\n\nfunction typedArrayCode$1 (data) {\n  return arrayTypes[Object.prototype.toString.call(data)] | 0\n}\n\nfunction convertData (result, data) {\n  var n = data.length\n  switch (result.type) {\n    case GL_UNSIGNED_BYTE$4:\n    case GL_UNSIGNED_SHORT$2:\n    case GL_UNSIGNED_INT$2:\n    case GL_FLOAT$3:\n      var converted = pool.allocType(result.type, n)\n      converted.set(data)\n      result.data = converted\n      break\n\n    case GL_HALF_FLOAT_OES:\n      result.data = convertToHalfFloat(data)\n      break\n\n    default:\n      \n  }\n}\n\nfunction preConvert (image, n) {\n  return pool.allocType(\n    image.type === GL_HALF_FLOAT_OES\n      ? GL_FLOAT$3\n      : image.type, n)\n}\n\nfunction postConvert (image, data) {\n  if (image.type === GL_HALF_FLOAT_OES) {\n    image.data = convertToHalfFloat(data)\n    pool.freeType(data)\n  } else {\n    image.data = data\n  }\n}\n\nfunction transposeData (image, array, strideX, strideY, strideC, offset) {\n  var w = image.width\n  var h = image.height\n  var c = image.channels\n  var n = w * h * c\n  var data = preConvert(image, n)\n\n  var p = 0\n  for (var i = 0; i < h; ++i) {\n    for (var j = 0; j < w; ++j) {\n      for (var k = 0; k < c; ++k) {\n        data[p++] = array[strideX * j + strideY * i + strideC * k + offset]\n      }\n    }\n  }\n\n  postConvert(image, data)\n}\n\nfunction getTextureSize (format, type, width, height, isMipmap, isCube) {\n  var s\n  if (typeof FORMAT_SIZES_SPECIAL[format] !== 'undefined') {\n    // we have a special array for dealing with weird color formats such as RGB5A1\n    s = FORMAT_SIZES_SPECIAL[format]\n  } else {\n    s = FORMAT_CHANNELS[format] * TYPE_SIZES[type]\n  }\n\n  if (isCube) {\n    s *= 6\n  }\n\n  if (isMipmap) {\n    // compute the total size of all the mipmaps.\n    var total = 0\n\n    var w = width\n    while (w >= 1) {\n      // we can only use mipmaps on a square image,\n      // so we can simply use the width and ignore the height:\n      total += s * w * w\n      w /= 2\n    }\n    return total\n  } else {\n    return s * width * height\n  }\n}\n\nfunction createTextureSet (\n  gl, extensions, limits, reglPoll, contextState, stats, config) {\n  // -------------------------------------------------------\n  // Initialize constants and parameter tables here\n  // -------------------------------------------------------\n  var mipmapHint = {\n    \"don't care\": GL_DONT_CARE,\n    'dont care': GL_DONT_CARE,\n    'nice': GL_NICEST,\n    'fast': GL_FASTEST\n  }\n\n  var wrapModes = {\n    'repeat': GL_REPEAT,\n    'clamp': GL_CLAMP_TO_EDGE,\n    'mirror': GL_MIRRORED_REPEAT\n  }\n\n  var magFilters = {\n    'nearest': GL_NEAREST,\n    'linear': GL_LINEAR\n  }\n\n  var minFilters = extend({\n    'mipmap': GL_LINEAR_MIPMAP_LINEAR,\n    'nearest mipmap nearest': GL_NEAREST_MIPMAP_NEAREST,\n    'linear mipmap nearest': GL_LINEAR_MIPMAP_NEAREST,\n    'nearest mipmap linear': GL_NEAREST_MIPMAP_LINEAR,\n    'linear mipmap linear': GL_LINEAR_MIPMAP_LINEAR\n  }, magFilters)\n\n  var colorSpace = {\n    'none': 0,\n    'browser': GL_BROWSER_DEFAULT_WEBGL\n  }\n\n  var textureTypes = {\n    'uint8': GL_UNSIGNED_BYTE$4,\n    'rgba4': GL_UNSIGNED_SHORT_4_4_4_4,\n    'rgb565': GL_UNSIGNED_SHORT_5_6_5,\n    'rgb5 a1': GL_UNSIGNED_SHORT_5_5_5_1\n  }\n\n  var textureFormats = {\n    'alpha': GL_ALPHA,\n    'luminance': GL_LUMINANCE,\n    'luminance alpha': GL_LUMINANCE_ALPHA,\n    'rgb': GL_RGB,\n    'rgba': GL_RGBA$1,\n    'rgba4': GL_RGBA4,\n    'rgb5 a1': GL_RGB5_A1,\n    'rgb565': GL_RGB565\n  }\n\n  var compressedTextureFormats = {}\n\n  if (extensions.ext_srgb) {\n    textureFormats.srgb = GL_SRGB_EXT\n    textureFormats.srgba = GL_SRGB_ALPHA_EXT\n  }\n\n  if (extensions.oes_texture_float) {\n    textureTypes.float32 = textureTypes.float = GL_FLOAT$3\n  }\n\n  if (extensions.oes_texture_half_float) {\n    textureTypes['float16'] = textureTypes['half float'] = GL_HALF_FLOAT_OES\n  }\n\n  if (extensions.webgl_depth_texture) {\n    extend(textureFormats, {\n      'depth': GL_DEPTH_COMPONENT,\n      'depth stencil': GL_DEPTH_STENCIL\n    })\n\n    extend(textureTypes, {\n      'uint16': GL_UNSIGNED_SHORT$2,\n      'uint32': GL_UNSIGNED_INT$2,\n      'depth stencil': GL_UNSIGNED_INT_24_8_WEBGL\n    })\n  }\n\n  if (extensions.webgl_compressed_texture_s3tc) {\n    extend(compressedTextureFormats, {\n      'rgb s3tc dxt1': GL_COMPRESSED_RGB_S3TC_DXT1_EXT,\n      'rgba s3tc dxt1': GL_COMPRESSED_RGBA_S3TC_DXT1_EXT,\n      'rgba s3tc dxt3': GL_COMPRESSED_RGBA_S3TC_DXT3_EXT,\n      'rgba s3tc dxt5': GL_COMPRESSED_RGBA_S3TC_DXT5_EXT\n    })\n  }\n\n  if (extensions.webgl_compressed_texture_atc) {\n    extend(compressedTextureFormats, {\n      'rgb atc': GL_COMPRESSED_RGB_ATC_WEBGL,\n      'rgba atc explicit alpha': GL_COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL,\n      'rgba atc interpolated alpha': GL_COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL\n    })\n  }\n\n  if (extensions.webgl_compressed_texture_pvrtc) {\n    extend(compressedTextureFormats, {\n      'rgb pvrtc 4bppv1': GL_COMPRESSED_RGB_PVRTC_4BPPV1_IMG,\n      'rgb pvrtc 2bppv1': GL_COMPRESSED_RGB_PVRTC_2BPPV1_IMG,\n      'rgba pvrtc 4bppv1': GL_COMPRESSED_RGBA_PVRTC_4BPPV1_IMG,\n      'rgba pvrtc 2bppv1': GL_COMPRESSED_RGBA_PVRTC_2BPPV1_IMG\n    })\n  }\n\n  if (extensions.webgl_compressed_texture_etc1) {\n    compressedTextureFormats['rgb etc1'] = GL_COMPRESSED_RGB_ETC1_WEBGL\n  }\n\n  // Copy over all texture formats\n  var supportedCompressedFormats = Array.prototype.slice.call(\n    gl.getParameter(GL_COMPRESSED_TEXTURE_FORMATS))\n  Object.keys(compressedTextureFormats).forEach(function (name) {\n    var format = compressedTextureFormats[name]\n    if (supportedCompressedFormats.indexOf(format) >= 0) {\n      textureFormats[name] = format\n    }\n  })\n\n  var supportedFormats = Object.keys(textureFormats)\n  limits.textureFormats = supportedFormats\n\n  // associate with every format string its\n  // corresponding GL-value.\n  var textureFormatsInvert = []\n  Object.keys(textureFormats).forEach(function (key) {\n    var val = textureFormats[key]\n    textureFormatsInvert[val] = key\n  })\n\n  // associate with every type string its\n  // corresponding GL-value.\n  var textureTypesInvert = []\n  Object.keys(textureTypes).forEach(function (key) {\n    var val = textureTypes[key]\n    textureTypesInvert[val] = key\n  })\n\n  var magFiltersInvert = []\n  Object.keys(magFilters).forEach(function (key) {\n    var val = magFilters[key]\n    magFiltersInvert[val] = key\n  })\n\n  var minFiltersInvert = []\n  Object.keys(minFilters).forEach(function (key) {\n    var val = minFilters[key]\n    minFiltersInvert[val] = key\n  })\n\n  var wrapModesInvert = []\n  Object.keys(wrapModes).forEach(function (key) {\n    var val = wrapModes[key]\n    wrapModesInvert[val] = key\n  })\n\n  // colorFormats[] gives the format (channels) associated to an\n  // internalformat\n  var colorFormats = supportedFormats.reduce(function (color, key) {\n    var glenum = textureFormats[key]\n    if (glenum === GL_LUMINANCE ||\n        glenum === GL_ALPHA ||\n        glenum === GL_LUMINANCE ||\n        glenum === GL_LUMINANCE_ALPHA ||\n        glenum === GL_DEPTH_COMPONENT ||\n        glenum === GL_DEPTH_STENCIL ||\n        (extensions.ext_srgb &&\n                (glenum === GL_SRGB_EXT ||\n                 glenum === GL_SRGB_ALPHA_EXT))) {\n      color[glenum] = glenum\n    } else if (glenum === GL_RGB5_A1 || key.indexOf('rgba') >= 0) {\n      color[glenum] = GL_RGBA$1\n    } else {\n      color[glenum] = GL_RGB\n    }\n    return color\n  }, {})\n\n  function TexFlags () {\n    // format info\n    this.internalformat = GL_RGBA$1\n    this.format = GL_RGBA$1\n    this.type = GL_UNSIGNED_BYTE$4\n    this.compressed = false\n\n    // pixel storage\n    this.premultiplyAlpha = false\n    this.flipY = false\n    this.unpackAlignment = 1\n    this.colorSpace = GL_BROWSER_DEFAULT_WEBGL\n\n    // shape info\n    this.width = 0\n    this.height = 0\n    this.channels = 0\n  }\n\n  function copyFlags (result, other) {\n    result.internalformat = other.internalformat\n    result.format = other.format\n    result.type = other.type\n    result.compressed = other.compressed\n\n    result.premultiplyAlpha = other.premultiplyAlpha\n    result.flipY = other.flipY\n    result.unpackAlignment = other.unpackAlignment\n    result.colorSpace = other.colorSpace\n\n    result.width = other.width\n    result.height = other.height\n    result.channels = other.channels\n  }\n\n  function parseFlags (flags, options) {\n    if (typeof options !== 'object' || !options) {\n      return\n    }\n\n    if ('premultiplyAlpha' in options) {\n      \n      flags.premultiplyAlpha = options.premultiplyAlpha\n    }\n\n    if ('flipY' in options) {\n      \n      flags.flipY = options.flipY\n    }\n\n    if ('alignment' in options) {\n      \n      flags.unpackAlignment = options.alignment\n    }\n\n    if ('colorSpace' in options) {\n      \n      flags.colorSpace = colorSpace[options.colorSpace]\n    }\n\n    if ('type' in options) {\n      var type = options.type\n      \n      \n      \n      \n      flags.type = textureTypes[type]\n    }\n\n    var w = flags.width\n    var h = flags.height\n    var c = flags.channels\n    var hasChannels = false\n    if ('shape' in options) {\n      \n      w = options.shape[0]\n      h = options.shape[1]\n      if (options.shape.length === 3) {\n        c = options.shape[2]\n        \n        hasChannels = true\n      }\n      \n      \n    } else {\n      if ('radius' in options) {\n        w = h = options.radius\n        \n      }\n      if ('width' in options) {\n        w = options.width\n        \n      }\n      if ('height' in options) {\n        h = options.height\n        \n      }\n      if ('channels' in options) {\n        c = options.channels\n        \n        hasChannels = true\n      }\n    }\n    flags.width = w | 0\n    flags.height = h | 0\n    flags.channels = c | 0\n\n    var hasFormat = false\n    if ('format' in options) {\n      var formatStr = options.format\n      \n      \n      var internalformat = flags.internalformat = textureFormats[formatStr]\n      flags.format = colorFormats[internalformat]\n      if (formatStr in textureTypes) {\n        if (!('type' in options)) {\n          flags.type = textureTypes[formatStr]\n        }\n      }\n      if (formatStr in compressedTextureFormats) {\n        flags.compressed = true\n      }\n      hasFormat = true\n    }\n\n    // Reconcile channels and format\n    if (!hasChannels && hasFormat) {\n      flags.channels = FORMAT_CHANNELS[flags.format]\n    } else if (hasChannels && !hasFormat) {\n      if (flags.channels !== CHANNELS_FORMAT[flags.format]) {\n        flags.format = flags.internalformat = CHANNELS_FORMAT[flags.channels]\n      }\n    } else if (hasFormat && hasChannels) {\n      \n    }\n  }\n\n  function setFlags (flags) {\n    gl.pixelStorei(GL_UNPACK_FLIP_Y_WEBGL, flags.flipY)\n    gl.pixelStorei(GL_UNPACK_PREMULTIPLY_ALPHA_WEBGL, flags.premultiplyAlpha)\n    gl.pixelStorei(GL_UNPACK_COLORSPACE_CONVERSION_WEBGL, flags.colorSpace)\n    gl.pixelStorei(GL_UNPACK_ALIGNMENT, flags.unpackAlignment)\n  }\n\n  // -------------------------------------------------------\n  // Tex image data\n  // -------------------------------------------------------\n  function TexImage () {\n    TexFlags.call(this)\n\n    this.xOffset = 0\n    this.yOffset = 0\n\n    // data\n    this.data = null\n    this.needsFree = false\n\n    // html element\n    this.element = null\n\n    // copyTexImage info\n    this.needsCopy = false\n  }\n\n  function parseImage (image, options) {\n    var data = null\n    if (isPixelData(options)) {\n      data = options\n    } else if (options) {\n      \n      parseFlags(image, options)\n      if ('x' in options) {\n        image.xOffset = options.x | 0\n      }\n      if ('y' in options) {\n        image.yOffset = options.y | 0\n      }\n      if (isPixelData(options.data)) {\n        data = options.data\n      }\n    }\n\n    \n\n    if (options.copy) {\n      \n      var viewW = contextState.viewportWidth\n      var viewH = contextState.viewportHeight\n      image.width = image.width || (viewW - image.xOffset)\n      image.height = image.height || (viewH - image.yOffset)\n      image.needsCopy = true\n      \n    } else if (!data) {\n      image.width = image.width || 1\n      image.height = image.height || 1\n      image.channels = image.channels || 4\n    } else if (isTypedArray(data)) {\n      image.channels = image.channels || 4\n      image.data = data\n      if (!('type' in options) && image.type === GL_UNSIGNED_BYTE$4) {\n        image.type = typedArrayCode$1(data)\n      }\n    } else if (isNumericArray(data)) {\n      image.channels = image.channels || 4\n      convertData(image, data)\n      image.alignment = 1\n      image.needsFree = true\n    } else if (isNDArrayLike(data)) {\n      var array = data.data\n      if (!Array.isArray(array) && image.type === GL_UNSIGNED_BYTE$4) {\n        image.type = typedArrayCode$1(array)\n      }\n      var shape = data.shape\n      var stride = data.stride\n      var shapeX, shapeY, shapeC, strideX, strideY, strideC\n      if (shape.length === 3) {\n        shapeC = shape[2]\n        strideC = stride[2]\n      } else {\n        \n        shapeC = 1\n        strideC = 1\n      }\n      shapeX = shape[0]\n      shapeY = shape[1]\n      strideX = stride[0]\n      strideY = stride[1]\n      image.alignment = 1\n      image.width = shapeX\n      image.height = shapeY\n      image.channels = shapeC\n      image.format = image.internalformat = CHANNELS_FORMAT[shapeC]\n      image.needsFree = true\n      transposeData(image, array, strideX, strideY, strideC, data.offset)\n    } else if (isCanvasElement(data) || isOffscreenCanvas(data) || isContext2D(data)) {\n      if (isCanvasElement(data) || isOffscreenCanvas(data)) {\n        image.element = data\n      } else {\n        image.element = data.canvas\n      }\n      image.width = image.element.width\n      image.height = image.element.height\n      image.channels = 4\n    } else if (isBitmap(data)) {\n      image.element = data\n      image.width = data.width\n      image.height = data.height\n      image.channels = 4\n    } else if (isImageElement(data)) {\n      image.element = data\n      image.width = data.naturalWidth\n      image.height = data.naturalHeight\n      image.channels = 4\n    } else if (isVideoElement(data)) {\n      image.element = data\n      image.width = data.videoWidth\n      image.height = data.videoHeight\n      image.channels = 4\n    } else if (isRectArray(data)) {\n      var w = image.width || data[0].length\n      var h = image.height || data.length\n      var c = image.channels\n      if (isArrayLike(data[0][0])) {\n        c = c || data[0][0].length\n      } else {\n        c = c || 1\n      }\n      var arrayShape = flattenUtils.shape(data)\n      var n = 1\n      for (var dd = 0; dd < arrayShape.length; ++dd) {\n        n *= arrayShape[dd]\n      }\n      var allocData = preConvert(image, n)\n      flattenUtils.flatten(data, arrayShape, '', allocData)\n      postConvert(image, allocData)\n      image.alignment = 1\n      image.width = w\n      image.height = h\n      image.channels = c\n      image.format = image.internalformat = CHANNELS_FORMAT[c]\n      image.needsFree = true\n    }\n\n    if (image.type === GL_FLOAT$3) {\n      \n    } else if (image.type === GL_HALF_FLOAT_OES) {\n      \n    }\n\n    // do compressed texture  validation here.\n  }\n\n  function setImage (info, target, miplevel) {\n    var element = info.element\n    var data = info.data\n    var internalformat = info.internalformat\n    var format = info.format\n    var type = info.type\n    var width = info.width\n    var height = info.height\n\n    setFlags(info)\n\n    if (element) {\n      gl.texImage2D(target, miplevel, format, format, type, element)\n    } else if (info.compressed) {\n      gl.compressedTexImage2D(target, miplevel, internalformat, width, height, 0, data)\n    } else if (info.needsCopy) {\n      reglPoll()\n      gl.copyTexImage2D(\n        target, miplevel, format, info.xOffset, info.yOffset, width, height, 0)\n    } else {\n      gl.texImage2D(target, miplevel, format, width, height, 0, format, type, data || null)\n    }\n  }\n\n  function setSubImage (info, target, x, y, miplevel) {\n    var element = info.element\n    var data = info.data\n    var internalformat = info.internalformat\n    var format = info.format\n    var type = info.type\n    var width = info.width\n    var height = info.height\n\n    setFlags(info)\n\n    if (element) {\n      gl.texSubImage2D(\n        target, miplevel, x, y, format, type, element)\n    } else if (info.compressed) {\n      gl.compressedTexSubImage2D(\n        target, miplevel, x, y, internalformat, width, height, data)\n    } else if (info.needsCopy) {\n      reglPoll()\n      gl.copyTexSubImage2D(\n        target, miplevel, x, y, info.xOffset, info.yOffset, width, height)\n    } else {\n      gl.texSubImage2D(\n        target, miplevel, x, y, width, height, format, type, data)\n    }\n  }\n\n  // texImage pool\n  var imagePool = []\n\n  function allocImage () {\n    return imagePool.pop() || new TexImage()\n  }\n\n  function freeImage (image) {\n    if (image.needsFree) {\n      pool.freeType(image.data)\n    }\n    TexImage.call(image)\n    imagePool.push(image)\n  }\n\n  // -------------------------------------------------------\n  // Mip map\n  // -------------------------------------------------------\n  function MipMap () {\n    TexFlags.call(this)\n\n    this.genMipmaps = false\n    this.mipmapHint = GL_DONT_CARE\n    this.mipmask = 0\n    this.images = Array(16)\n  }\n\n  function parseMipMapFromShape (mipmap, width, height) {\n    var img = mipmap.images[0] = allocImage()\n    mipmap.mipmask = 1\n    img.width = mipmap.width = width\n    img.height = mipmap.height = height\n    img.channels = mipmap.channels = 4\n  }\n\n  function parseMipMapFromObject (mipmap, options) {\n    var imgData = null\n    if (isPixelData(options)) {\n      imgData = mipmap.images[0] = allocImage()\n      copyFlags(imgData, mipmap)\n      parseImage(imgData, options)\n      mipmap.mipmask = 1\n    } else {\n      parseFlags(mipmap, options)\n      if (Array.isArray(options.mipmap)) {\n        var mipData = options.mipmap\n        for (var i = 0; i < mipData.length; ++i) {\n          imgData = mipmap.images[i] = allocImage()\n          copyFlags(imgData, mipmap)\n          imgData.width >>= i\n          imgData.height >>= i\n          parseImage(imgData, mipData[i])\n          mipmap.mipmask |= (1 << i)\n        }\n      } else {\n        imgData = mipmap.images[0] = allocImage()\n        copyFlags(imgData, mipmap)\n        parseImage(imgData, options)\n        mipmap.mipmask = 1\n      }\n    }\n    copyFlags(mipmap, mipmap.images[0])\n\n    // For textures of the compressed format WEBGL_compressed_texture_s3tc\n    // we must have that\n    //\n    // \"When level equals zero width and height must be a multiple of 4.\n    // When level is greater than 0 width and height must be 0, 1, 2 or a multiple of 4. \"\n    //\n    // but we do not yet support having multiple mipmap levels for compressed textures,\n    // so we only test for level zero.\n\n    if (\n      mipmap.compressed &&\n      (\n        mipmap.internalformat === GL_COMPRESSED_RGB_S3TC_DXT1_EXT ||\n        mipmap.internalformat === GL_COMPRESSED_RGBA_S3TC_DXT1_EXT ||\n        mipmap.internalformat === GL_COMPRESSED_RGBA_S3TC_DXT3_EXT ||\n        mipmap.internalformat === GL_COMPRESSED_RGBA_S3TC_DXT5_EXT\n      )\n    ) {\n      \n    }\n  }\n\n  function setMipMap (mipmap, target) {\n    var images = mipmap.images\n    for (var i = 0; i < images.length; ++i) {\n      if (!images[i]) {\n        return\n      }\n      setImage(images[i], target, i)\n    }\n  }\n\n  var mipPool = []\n\n  function allocMipMap () {\n    var result = mipPool.pop() || new MipMap()\n    TexFlags.call(result)\n    result.mipmask = 0\n    for (var i = 0; i < 16; ++i) {\n      result.images[i] = null\n    }\n    return result\n  }\n\n  function freeMipMap (mipmap) {\n    var images = mipmap.images\n    for (var i = 0; i < images.length; ++i) {\n      if (images[i]) {\n        freeImage(images[i])\n      }\n      images[i] = null\n    }\n    mipPool.push(mipmap)\n  }\n\n  // -------------------------------------------------------\n  // Tex info\n  // -------------------------------------------------------\n  function TexInfo () {\n    this.minFilter = GL_NEAREST\n    this.magFilter = GL_NEAREST\n\n    this.wrapS = GL_CLAMP_TO_EDGE\n    this.wrapT = GL_CLAMP_TO_EDGE\n\n    this.anisotropic = 1\n\n    this.genMipmaps = false\n    this.mipmapHint = GL_DONT_CARE\n  }\n\n  function parseTexInfo (info, options) {\n    if ('min' in options) {\n      var minFilter = options.min\n      \n      info.minFilter = minFilters[minFilter]\n      if (MIPMAP_FILTERS.indexOf(info.minFilter) >= 0 && !('faces' in options)) {\n        info.genMipmaps = true\n      }\n    }\n\n    if ('mag' in options) {\n      var magFilter = options.mag\n      \n      info.magFilter = magFilters[magFilter]\n    }\n\n    var wrapS = info.wrapS\n    var wrapT = info.wrapT\n    if ('wrap' in options) {\n      var wrap = options.wrap\n      if (typeof wrap === 'string') {\n        \n        wrapS = wrapT = wrapModes[wrap]\n      } else if (Array.isArray(wrap)) {\n        \n        \n        wrapS = wrapModes[wrap[0]]\n        wrapT = wrapModes[wrap[1]]\n      }\n    } else {\n      if ('wrapS' in options) {\n        var optWrapS = options.wrapS\n        \n        wrapS = wrapModes[optWrapS]\n      }\n      if ('wrapT' in options) {\n        var optWrapT = options.wrapT\n        \n        wrapT = wrapModes[optWrapT]\n      }\n    }\n    info.wrapS = wrapS\n    info.wrapT = wrapT\n\n    if ('anisotropic' in options) {\n      var anisotropic = options.anisotropic\n      \n      info.anisotropic = options.anisotropic\n    }\n\n    if ('mipmap' in options) {\n      var hasMipMap = false\n      switch (typeof options.mipmap) {\n        case 'string':\n          \n          info.mipmapHint = mipmapHint[options.mipmap]\n          info.genMipmaps = true\n          hasMipMap = true\n          break\n\n        case 'boolean':\n          hasMipMap = info.genMipmaps = options.mipmap\n          break\n\n        case 'object':\n          \n          info.genMipmaps = false\n          hasMipMap = true\n          break\n\n        default:\n          \n      }\n      if (hasMipMap && !('min' in options)) {\n        info.minFilter = GL_NEAREST_MIPMAP_NEAREST\n      }\n    }\n  }\n\n  function setTexInfo (info, target) {\n    gl.texParameteri(target, GL_TEXTURE_MIN_FILTER, info.minFilter)\n    gl.texParameteri(target, GL_TEXTURE_MAG_FILTER, info.magFilter)\n    gl.texParameteri(target, GL_TEXTURE_WRAP_S, info.wrapS)\n    gl.texParameteri(target, GL_TEXTURE_WRAP_T, info.wrapT)\n    if (extensions.ext_texture_filter_anisotropic) {\n      gl.texParameteri(target, GL_TEXTURE_MAX_ANISOTROPY_EXT, info.anisotropic)\n    }\n    if (info.genMipmaps) {\n      gl.hint(GL_GENERATE_MIPMAP_HINT, info.mipmapHint)\n      gl.generateMipmap(target)\n    }\n  }\n\n  // -------------------------------------------------------\n  // Full texture object\n  // -------------------------------------------------------\n  var textureCount = 0\n  var textureSet = {}\n  var numTexUnits = limits.maxTextureUnits\n  var textureUnits = Array(numTexUnits).map(function () {\n    return null\n  })\n\n  function REGLTexture (target) {\n    TexFlags.call(this)\n    this.mipmask = 0\n    this.internalformat = GL_RGBA$1\n\n    this.id = textureCount++\n\n    this.refCount = 1\n\n    this.target = target\n    this.texture = gl.createTexture()\n\n    this.unit = -1\n    this.bindCount = 0\n\n    this.texInfo = new TexInfo()\n\n    if (config.profile) {\n      this.stats = { size: 0 }\n    }\n  }\n\n  function tempBind (texture) {\n    gl.activeTexture(GL_TEXTURE0$1)\n    gl.bindTexture(texture.target, texture.texture)\n  }\n\n  function tempRestore () {\n    var prev = textureUnits[0]\n    if (prev) {\n      gl.bindTexture(prev.target, prev.texture)\n    } else {\n      gl.bindTexture(GL_TEXTURE_2D$1, null)\n    }\n  }\n\n  function destroy (texture) {\n    var handle = texture.texture\n    \n    var unit = texture.unit\n    var target = texture.target\n    if (unit >= 0) {\n      gl.activeTexture(GL_TEXTURE0$1 + unit)\n      gl.bindTexture(target, null)\n      textureUnits[unit] = null\n    }\n    gl.deleteTexture(handle)\n    texture.texture = null\n    texture.params = null\n    texture.pixels = null\n    texture.refCount = 0\n    delete textureSet[texture.id]\n    stats.textureCount--\n  }\n\n  extend(REGLTexture.prototype, {\n    bind: function () {\n      var texture = this\n      texture.bindCount += 1\n      var unit = texture.unit\n      if (unit < 0) {\n        for (var i = 0; i < numTexUnits; ++i) {\n          var other = textureUnits[i]\n          if (other) {\n            if (other.bindCount > 0) {\n              continue\n            }\n            other.unit = -1\n          }\n          textureUnits[i] = texture\n          unit = i\n          break\n        }\n        if (unit >= numTexUnits) {\n          \n        }\n        if (config.profile && stats.maxTextureUnits < (unit + 1)) {\n          stats.maxTextureUnits = unit + 1 // +1, since the units are zero-based\n        }\n        texture.unit = unit\n        gl.activeTexture(GL_TEXTURE0$1 + unit)\n        gl.bindTexture(texture.target, texture.texture)\n      }\n      return unit\n    },\n\n    unbind: function () {\n      this.bindCount -= 1\n    },\n\n    decRef: function () {\n      if (--this.refCount <= 0) {\n        destroy(this)\n      }\n    }\n  })\n\n  function createTexture2D (a, b) {\n    var texture = new REGLTexture(GL_TEXTURE_2D$1)\n    textureSet[texture.id] = texture\n    stats.textureCount++\n\n    function reglTexture2D (a, b) {\n      var texInfo = texture.texInfo\n      TexInfo.call(texInfo)\n      var mipData = allocMipMap()\n\n      if (typeof a === 'number') {\n        if (typeof b === 'number') {\n          parseMipMapFromShape(mipData, a | 0, b | 0)\n        } else {\n          parseMipMapFromShape(mipData, a | 0, a | 0)\n        }\n      } else if (a) {\n        \n        parseTexInfo(texInfo, a)\n        parseMipMapFromObject(mipData, a)\n      } else {\n        // empty textures get assigned a default shape of 1x1\n        parseMipMapFromShape(mipData, 1, 1)\n      }\n\n      if (texInfo.genMipmaps) {\n        mipData.mipmask = (mipData.width << 1) - 1\n      }\n      texture.mipmask = mipData.mipmask\n\n      copyFlags(texture, mipData)\n\n      \n      texture.internalformat = mipData.internalformat\n\n      reglTexture2D.width = mipData.width\n      reglTexture2D.height = mipData.height\n\n      tempBind(texture)\n      setMipMap(mipData, GL_TEXTURE_2D$1)\n      setTexInfo(texInfo, GL_TEXTURE_2D$1)\n      tempRestore()\n\n      freeMipMap(mipData)\n\n      if (config.profile) {\n        texture.stats.size = getTextureSize(\n          texture.internalformat,\n          texture.type,\n          mipData.width,\n          mipData.height,\n          texInfo.genMipmaps,\n          false)\n      }\n      reglTexture2D.format = textureFormatsInvert[texture.internalformat]\n      reglTexture2D.type = textureTypesInvert[texture.type]\n\n      reglTexture2D.mag = magFiltersInvert[texInfo.magFilter]\n      reglTexture2D.min = minFiltersInvert[texInfo.minFilter]\n\n      reglTexture2D.wrapS = wrapModesInvert[texInfo.wrapS]\n      reglTexture2D.wrapT = wrapModesInvert[texInfo.wrapT]\n\n      return reglTexture2D\n    }\n\n    function subimage (image, x_, y_, level_) {\n      \n\n      var x = x_ | 0\n      var y = y_ | 0\n      var level = level_ | 0\n\n      var imageData = allocImage()\n      copyFlags(imageData, texture)\n      imageData.width = 0\n      imageData.height = 0\n      parseImage(imageData, image)\n      imageData.width = imageData.width || ((texture.width >> level) - x)\n      imageData.height = imageData.height || ((texture.height >> level) - y)\n\n      \n      \n      \n      \n\n      tempBind(texture)\n      setSubImage(imageData, GL_TEXTURE_2D$1, x, y, level)\n      tempRestore()\n\n      freeImage(imageData)\n\n      return reglTexture2D\n    }\n\n    function resize (w_, h_) {\n      var w = w_ | 0\n      var h = (h_ | 0) || w\n      if (w === texture.width && h === texture.height) {\n        return reglTexture2D\n      }\n\n      reglTexture2D.width = texture.width = w\n      reglTexture2D.height = texture.height = h\n\n      tempBind(texture)\n\n      for (var i = 0; texture.mipmask >> i; ++i) {\n        var _w = w >> i\n        var _h = h >> i\n        if (!_w || !_h) break\n        gl.texImage2D(\n          GL_TEXTURE_2D$1,\n          i,\n          texture.format,\n          _w,\n          _h,\n          0,\n          texture.format,\n          texture.type,\n          null)\n      }\n      tempRestore()\n\n      // also, recompute the texture size.\n      if (config.profile) {\n        texture.stats.size = getTextureSize(\n          texture.internalformat,\n          texture.type,\n          w,\n          h,\n          false,\n          false)\n      }\n\n      return reglTexture2D\n    }\n\n    reglTexture2D(a, b)\n\n    reglTexture2D.subimage = subimage\n    reglTexture2D.resize = resize\n    reglTexture2D._reglType = 'texture2d'\n    reglTexture2D._texture = texture\n    if (config.profile) {\n      reglTexture2D.stats = texture.stats\n    }\n    reglTexture2D.destroy = function () {\n      texture.decRef()\n    }\n\n    return reglTexture2D\n  }\n\n  function createTextureCube (a0, a1, a2, a3, a4, a5) {\n    var texture = new REGLTexture(GL_TEXTURE_CUBE_MAP$1)\n    textureSet[texture.id] = texture\n    stats.cubeCount++\n\n    var faces = new Array(6)\n\n    function reglTextureCube (a0, a1, a2, a3, a4, a5) {\n      var i\n      var texInfo = texture.texInfo\n      TexInfo.call(texInfo)\n      for (i = 0; i < 6; ++i) {\n        faces[i] = allocMipMap()\n      }\n\n      if (typeof a0 === 'number' || !a0) {\n        var s = (a0 | 0) || 1\n        for (i = 0; i < 6; ++i) {\n          parseMipMapFromShape(faces[i], s, s)\n        }\n      } else if (typeof a0 === 'object') {\n        if (a1) {\n          parseMipMapFromObject(faces[0], a0)\n          parseMipMapFromObject(faces[1], a1)\n          parseMipMapFromObject(faces[2], a2)\n          parseMipMapFromObject(faces[3], a3)\n          parseMipMapFromObject(faces[4], a4)\n          parseMipMapFromObject(faces[5], a5)\n        } else {\n          parseTexInfo(texInfo, a0)\n          parseFlags(texture, a0)\n          if ('faces' in a0) {\n            var faceInput = a0.faces\n            \n            for (i = 0; i < 6; ++i) {\n              \n              copyFlags(faces[i], texture)\n              parseMipMapFromObject(faces[i], faceInput[i])\n            }\n          } else {\n            for (i = 0; i < 6; ++i) {\n              parseMipMapFromObject(faces[i], a0)\n            }\n          }\n        }\n      } else {\n        \n      }\n\n      copyFlags(texture, faces[0])\n      \n\n      if (texInfo.genMipmaps) {\n        texture.mipmask = (faces[0].width << 1) - 1\n      } else {\n        texture.mipmask = faces[0].mipmask\n      }\n\n      \n      texture.internalformat = faces[0].internalformat\n\n      reglTextureCube.width = faces[0].width\n      reglTextureCube.height = faces[0].height\n\n      tempBind(texture)\n      for (i = 0; i < 6; ++i) {\n        setMipMap(faces[i], GL_TEXTURE_CUBE_MAP_POSITIVE_X$1 + i)\n      }\n      setTexInfo(texInfo, GL_TEXTURE_CUBE_MAP$1)\n      tempRestore()\n\n      if (config.profile) {\n        texture.stats.size = getTextureSize(\n          texture.internalformat,\n          texture.type,\n          reglTextureCube.width,\n          reglTextureCube.height,\n          texInfo.genMipmaps,\n          true)\n      }\n\n      reglTextureCube.format = textureFormatsInvert[texture.internalformat]\n      reglTextureCube.type = textureTypesInvert[texture.type]\n\n      reglTextureCube.mag = magFiltersInvert[texInfo.magFilter]\n      reglTextureCube.min = minFiltersInvert[texInfo.minFilter]\n\n      reglTextureCube.wrapS = wrapModesInvert[texInfo.wrapS]\n      reglTextureCube.wrapT = wrapModesInvert[texInfo.wrapT]\n\n      for (i = 0; i < 6; ++i) {\n        freeMipMap(faces[i])\n      }\n\n      return reglTextureCube\n    }\n\n    function subimage (face, image, x_, y_, level_) {\n      \n      \n\n      var x = x_ | 0\n      var y = y_ | 0\n      var level = level_ | 0\n\n      var imageData = allocImage()\n      copyFlags(imageData, texture)\n      imageData.width = 0\n      imageData.height = 0\n      parseImage(imageData, image)\n      imageData.width = imageData.width || ((texture.width >> level) - x)\n      imageData.height = imageData.height || ((texture.height >> level) - y)\n\n      \n      \n      \n      \n\n      tempBind(texture)\n      setSubImage(imageData, GL_TEXTURE_CUBE_MAP_POSITIVE_X$1 + face, x, y, level)\n      tempRestore()\n\n      freeImage(imageData)\n\n      return reglTextureCube\n    }\n\n    function resize (radius_) {\n      var radius = radius_ | 0\n      if (radius === texture.width) {\n        return\n      }\n\n      reglTextureCube.width = texture.width = radius\n      reglTextureCube.height = texture.height = radius\n\n      tempBind(texture)\n      for (var i = 0; i < 6; ++i) {\n        for (var j = 0; texture.mipmask >> j; ++j) {\n          gl.texImage2D(\n            GL_TEXTURE_CUBE_MAP_POSITIVE_X$1 + i,\n            j,\n            texture.format,\n            radius >> j,\n            radius >> j,\n            0,\n            texture.format,\n            texture.type,\n            null)\n        }\n      }\n      tempRestore()\n\n      if (config.profile) {\n        texture.stats.size = getTextureSize(\n          texture.internalformat,\n          texture.type,\n          reglTextureCube.width,\n          reglTextureCube.height,\n          false,\n          true)\n      }\n\n      return reglTextureCube\n    }\n\n    reglTextureCube(a0, a1, a2, a3, a4, a5)\n\n    reglTextureCube.subimage = subimage\n    reglTextureCube.resize = resize\n    reglTextureCube._reglType = 'textureCube'\n    reglTextureCube._texture = texture\n    if (config.profile) {\n      reglTextureCube.stats = texture.stats\n    }\n    reglTextureCube.destroy = function () {\n      texture.decRef()\n    }\n\n    return reglTextureCube\n  }\n\n  // Called when regl is destroyed\n  function destroyTextures () {\n    for (var i = 0; i < numTexUnits; ++i) {\n      gl.activeTexture(GL_TEXTURE0$1 + i)\n      gl.bindTexture(GL_TEXTURE_2D$1, null)\n      textureUnits[i] = null\n    }\n    values(textureSet).forEach(destroy)\n\n    stats.cubeCount = 0\n    stats.textureCount = 0\n  }\n\n  if (config.profile) {\n    stats.getTotalTextureSize = function () {\n      var total = 0\n      Object.keys(textureSet).forEach(function (key) {\n        total += textureSet[key].stats.size\n      })\n      return total\n    }\n  }\n\n  function restoreTextures () {\n    for (var i = 0; i < numTexUnits; ++i) {\n      var tex = textureUnits[i]\n      if (tex) {\n        tex.bindCount = 0\n        tex.unit = -1\n        textureUnits[i] = null\n      }\n    }\n\n    values(textureSet).forEach(function (texture) {\n      texture.texture = gl.createTexture()\n      gl.bindTexture(texture.target, texture.texture)\n      for (var i = 0; i < 32; ++i) {\n        if ((texture.mipmask & (1 << i)) === 0) {\n          continue\n        }\n        if (texture.target === GL_TEXTURE_2D$1) {\n          gl.texImage2D(GL_TEXTURE_2D$1,\n            i,\n            texture.internalformat,\n            texture.width >> i,\n            texture.height >> i,\n            0,\n            texture.internalformat,\n            texture.type,\n            null)\n        } else {\n          for (var j = 0; j < 6; ++j) {\n            gl.texImage2D(GL_TEXTURE_CUBE_MAP_POSITIVE_X$1 + j,\n              i,\n              texture.internalformat,\n              texture.width >> i,\n              texture.height >> i,\n              0,\n              texture.internalformat,\n              texture.type,\n              null)\n          }\n        }\n      }\n      setTexInfo(texture.texInfo, texture.target)\n    })\n  }\n\n  function refreshTextures () {\n    for (var i = 0; i < numTexUnits; ++i) {\n      var tex = textureUnits[i]\n      if (tex) {\n        tex.bindCount = 0\n        tex.unit = -1\n        textureUnits[i] = null\n      }\n      gl.activeTexture(GL_TEXTURE0$1 + i)\n      gl.bindTexture(GL_TEXTURE_2D$1, null)\n      gl.bindTexture(GL_TEXTURE_CUBE_MAP$1, null)\n    }\n  }\n\n  return {\n    create2D: createTexture2D,\n    createCube: createTextureCube,\n    clear: destroyTextures,\n    getTexture: function (wrapper) {\n      return null\n    },\n    restore: restoreTextures,\n    refresh: refreshTextures\n  }\n}\n\nvar GL_RENDERBUFFER = 0x8D41\n\nvar GL_RGBA4$1 = 0x8056\nvar GL_RGB5_A1$1 = 0x8057\nvar GL_RGB565$1 = 0x8D62\nvar GL_DEPTH_COMPONENT16 = 0x81A5\nvar GL_STENCIL_INDEX8 = 0x8D48\nvar GL_DEPTH_STENCIL$1 = 0x84F9\n\nvar GL_SRGB8_ALPHA8_EXT = 0x8C43\n\nvar GL_RGBA32F_EXT = 0x8814\n\nvar GL_RGBA16F_EXT = 0x881A\nvar GL_RGB16F_EXT = 0x881B\n\nvar FORMAT_SIZES = []\n\nFORMAT_SIZES[GL_RGBA4$1] = 2\nFORMAT_SIZES[GL_RGB5_A1$1] = 2\nFORMAT_SIZES[GL_RGB565$1] = 2\n\nFORMAT_SIZES[GL_DEPTH_COMPONENT16] = 2\nFORMAT_SIZES[GL_STENCIL_INDEX8] = 1\nFORMAT_SIZES[GL_DEPTH_STENCIL$1] = 4\n\nFORMAT_SIZES[GL_SRGB8_ALPHA8_EXT] = 4\nFORMAT_SIZES[GL_RGBA32F_EXT] = 16\nFORMAT_SIZES[GL_RGBA16F_EXT] = 8\nFORMAT_SIZES[GL_RGB16F_EXT] = 6\n\nfunction getRenderbufferSize (format, width, height) {\n  return FORMAT_SIZES[format] * width * height\n}\n\nvar wrapRenderbuffers = function (gl, extensions, limits, stats, config) {\n  var formatTypes = {\n    'rgba4': GL_RGBA4$1,\n    'rgb565': GL_RGB565$1,\n    'rgb5 a1': GL_RGB5_A1$1,\n    'depth': GL_DEPTH_COMPONENT16,\n    'stencil': GL_STENCIL_INDEX8,\n    'depth stencil': GL_DEPTH_STENCIL$1\n  }\n\n  if (extensions.ext_srgb) {\n    formatTypes['srgba'] = GL_SRGB8_ALPHA8_EXT\n  }\n\n  if (extensions.ext_color_buffer_half_float) {\n    formatTypes['rgba16f'] = GL_RGBA16F_EXT\n    formatTypes['rgb16f'] = GL_RGB16F_EXT\n  }\n\n  if (extensions.webgl_color_buffer_float) {\n    formatTypes['rgba32f'] = GL_RGBA32F_EXT\n  }\n\n  var formatTypesInvert = []\n  Object.keys(formatTypes).forEach(function (key) {\n    var val = formatTypes[key]\n    formatTypesInvert[val] = key\n  })\n\n  var renderbufferCount = 0\n  var renderbufferSet = {}\n\n  function REGLRenderbuffer (renderbuffer) {\n    this.id = renderbufferCount++\n    this.refCount = 1\n\n    this.renderbuffer = renderbuffer\n\n    this.format = GL_RGBA4$1\n    this.width = 0\n    this.height = 0\n\n    if (config.profile) {\n      this.stats = { size: 0 }\n    }\n  }\n\n  REGLRenderbuffer.prototype.decRef = function () {\n    if (--this.refCount <= 0) {\n      destroy(this)\n    }\n  }\n\n  function destroy (rb) {\n    var handle = rb.renderbuffer\n    \n    gl.bindRenderbuffer(GL_RENDERBUFFER, null)\n    gl.deleteRenderbuffer(handle)\n    rb.renderbuffer = null\n    rb.refCount = 0\n    delete renderbufferSet[rb.id]\n    stats.renderbufferCount--\n  }\n\n  function createRenderbuffer (a, b) {\n    var renderbuffer = new REGLRenderbuffer(gl.createRenderbuffer())\n    renderbufferSet[renderbuffer.id] = renderbuffer\n    stats.renderbufferCount++\n\n    function reglRenderbuffer (a, b) {\n      var w = 0\n      var h = 0\n      var format = GL_RGBA4$1\n\n      if (typeof a === 'object' && a) {\n        var options = a\n        if ('shape' in options) {\n          var shape = options.shape\n          \n          w = shape[0] | 0\n          h = shape[1] | 0\n        } else {\n          if ('radius' in options) {\n            w = h = options.radius | 0\n          }\n          if ('width' in options) {\n            w = options.width | 0\n          }\n          if ('height' in options) {\n            h = options.height | 0\n          }\n        }\n        if ('format' in options) {\n          \n          format = formatTypes[options.format]\n        }\n      } else if (typeof a === 'number') {\n        w = a | 0\n        if (typeof b === 'number') {\n          h = b | 0\n        } else {\n          h = w\n        }\n      } else if (!a) {\n        w = h = 1\n      } else {\n        \n      }\n\n      // check shape\n      \n\n      if (w === renderbuffer.width &&\n          h === renderbuffer.height &&\n          format === renderbuffer.format) {\n        return\n      }\n\n      reglRenderbuffer.width = renderbuffer.width = w\n      reglRenderbuffer.height = renderbuffer.height = h\n      renderbuffer.format = format\n\n      gl.bindRenderbuffer(GL_RENDERBUFFER, renderbuffer.renderbuffer)\n      gl.renderbufferStorage(GL_RENDERBUFFER, format, w, h)\n\n      \n\n      if (config.profile) {\n        renderbuffer.stats.size = getRenderbufferSize(renderbuffer.format, renderbuffer.width, renderbuffer.height)\n      }\n      reglRenderbuffer.format = formatTypesInvert[renderbuffer.format]\n\n      return reglRenderbuffer\n    }\n\n    function resize (w_, h_) {\n      var w = w_ | 0\n      var h = (h_ | 0) || w\n\n      if (w === renderbuffer.width && h === renderbuffer.height) {\n        return reglRenderbuffer\n      }\n\n      // check shape\n      \n\n      reglRenderbuffer.width = renderbuffer.width = w\n      reglRenderbuffer.height = renderbuffer.height = h\n\n      gl.bindRenderbuffer(GL_RENDERBUFFER, renderbuffer.renderbuffer)\n      gl.renderbufferStorage(GL_RENDERBUFFER, renderbuffer.format, w, h)\n\n      \n\n      // also, recompute size.\n      if (config.profile) {\n        renderbuffer.stats.size = getRenderbufferSize(\n          renderbuffer.format, renderbuffer.width, renderbuffer.height)\n      }\n\n      return reglRenderbuffer\n    }\n\n    reglRenderbuffer(a, b)\n\n    reglRenderbuffer.resize = resize\n    reglRenderbuffer._reglType = 'renderbuffer'\n    reglRenderbuffer._renderbuffer = renderbuffer\n    if (config.profile) {\n      reglRenderbuffer.stats = renderbuffer.stats\n    }\n    reglRenderbuffer.destroy = function () {\n      renderbuffer.decRef()\n    }\n\n    return reglRenderbuffer\n  }\n\n  if (config.profile) {\n    stats.getTotalRenderbufferSize = function () {\n      var total = 0\n      Object.keys(renderbufferSet).forEach(function (key) {\n        total += renderbufferSet[key].stats.size\n      })\n      return total\n    }\n  }\n\n  function restoreRenderbuffers () {\n    values(renderbufferSet).forEach(function (rb) {\n      rb.renderbuffer = gl.createRenderbuffer()\n      gl.bindRenderbuffer(GL_RENDERBUFFER, rb.renderbuffer)\n      gl.renderbufferStorage(GL_RENDERBUFFER, rb.format, rb.width, rb.height)\n    })\n    gl.bindRenderbuffer(GL_RENDERBUFFER, null)\n  }\n\n  return {\n    create: createRenderbuffer,\n    clear: function () {\n      values(renderbufferSet).forEach(destroy)\n    },\n    restore: restoreRenderbuffers\n  }\n}\n\n// We store these constants so that the minifier can inline them\nvar GL_FRAMEBUFFER$1 = 0x8D40\nvar GL_RENDERBUFFER$1 = 0x8D41\n\nvar GL_TEXTURE_2D$2 = 0x0DE1\nvar GL_TEXTURE_CUBE_MAP_POSITIVE_X$2 = 0x8515\n\nvar GL_COLOR_ATTACHMENT0$1 = 0x8CE0\nvar GL_DEPTH_ATTACHMENT = 0x8D00\nvar GL_STENCIL_ATTACHMENT = 0x8D20\nvar GL_DEPTH_STENCIL_ATTACHMENT = 0x821A\n\nvar GL_FRAMEBUFFER_COMPLETE$1 = 0x8CD5\nvar GL_HALF_FLOAT_OES$1 = 0x8D61\nvar GL_UNSIGNED_BYTE$5 = 0x1401\nvar GL_FLOAT$4 = 0x1406\n\nvar GL_RGB$1 = 0x1907\nvar GL_RGBA$2 = 0x1908\n\n// for every texture format, store\n// the number of channels\nvar textureFormatChannels = []\ntextureFormatChannels[GL_RGBA$2] = 4\ntextureFormatChannels[GL_RGB$1] = 3\n\n// for every texture type, store\n// the size in bytes.\nvar textureTypeSizes = []\ntextureTypeSizes[GL_UNSIGNED_BYTE$5] = 1\ntextureTypeSizes[GL_FLOAT$4] = 4\ntextureTypeSizes[GL_HALF_FLOAT_OES$1] = 2\n\nfunction wrapFBOState (\n  gl,\n  extensions,\n  limits,\n  textureState,\n  renderbufferState,\n  stats) {\n  var framebufferState = {\n    cur: null,\n    next: null,\n    dirty: false,\n    setFBO: null\n  }\n\n  var colorTextureFormats = ['rgba']\n  var colorRenderbufferFormats = ['rgba4', 'rgb565', 'rgb5 a1']\n\n  if (extensions.ext_srgb) {\n    colorRenderbufferFormats.push('srgba')\n  }\n\n  if (extensions.ext_color_buffer_half_float) {\n    colorRenderbufferFormats.push('rgba16f', 'rgb16f')\n  }\n\n  if (extensions.webgl_color_buffer_float) {\n    colorRenderbufferFormats.push('rgba32f')\n  }\n\n  var colorTypes = ['uint8']\n  if (extensions.oes_texture_half_float) {\n    colorTypes.push('half float', 'float16')\n  }\n  if (extensions.oes_texture_float) {\n    colorTypes.push('float', 'float32')\n  }\n\n  function FramebufferAttachment (target, texture, renderbuffer) {\n    this.target = target\n    this.texture = texture\n    this.renderbuffer = renderbuffer\n\n    var w = 0\n    var h = 0\n    if (texture) {\n      w = texture.width\n      h = texture.height\n    } else if (renderbuffer) {\n      w = renderbuffer.width\n      h = renderbuffer.height\n    }\n    this.width = w\n    this.height = h\n  }\n\n  function decRef (attachment) {\n    if (attachment) {\n      if (attachment.texture) {\n        attachment.texture._texture.decRef()\n      }\n      if (attachment.renderbuffer) {\n        attachment.renderbuffer._renderbuffer.decRef()\n      }\n    }\n  }\n\n  function incRefAndCheckShape (attachment, width, height) {\n    if (!attachment) {\n      return\n    }\n    if (attachment.texture) {\n      var texture = attachment.texture._texture\n      var tw = Math.max(1, texture.width)\n      var th = Math.max(1, texture.height)\n      \n      texture.refCount += 1\n    } else {\n      var renderbuffer = attachment.renderbuffer._renderbuffer\n      \n      renderbuffer.refCount += 1\n    }\n  }\n\n  function attach (location, attachment) {\n    if (attachment) {\n      if (attachment.texture) {\n        gl.framebufferTexture2D(\n          GL_FRAMEBUFFER$1,\n          location,\n          attachment.target,\n          attachment.texture._texture.texture,\n          0)\n      } else {\n        gl.framebufferRenderbuffer(\n          GL_FRAMEBUFFER$1,\n          location,\n          GL_RENDERBUFFER$1,\n          attachment.renderbuffer._renderbuffer.renderbuffer)\n      }\n    }\n  }\n\n  function parseAttachment (attachment) {\n    var target = GL_TEXTURE_2D$2\n    var texture = null\n    var renderbuffer = null\n\n    var data = attachment\n    if (typeof attachment === 'object') {\n      data = attachment.data\n      if ('target' in attachment) {\n        target = attachment.target | 0\n      }\n    }\n\n    \n\n    var type = data._reglType\n    if (type === 'texture2d') {\n      texture = data\n      \n    } else if (type === 'textureCube') {\n      texture = data\n      \n    } else if (type === 'renderbuffer') {\n      renderbuffer = data\n      target = GL_RENDERBUFFER$1\n    } else {\n      \n    }\n\n    return new FramebufferAttachment(target, texture, renderbuffer)\n  }\n\n  function allocAttachment (\n    width,\n    height,\n    isTexture,\n    format,\n    type) {\n    if (isTexture) {\n      var texture = textureState.create2D({\n        width: width,\n        height: height,\n        format: format,\n        type: type\n      })\n      texture._texture.refCount = 0\n      return new FramebufferAttachment(GL_TEXTURE_2D$2, texture, null)\n    } else {\n      var rb = renderbufferState.create({\n        width: width,\n        height: height,\n        format: format\n      })\n      rb._renderbuffer.refCount = 0\n      return new FramebufferAttachment(GL_RENDERBUFFER$1, null, rb)\n    }\n  }\n\n  function unwrapAttachment (attachment) {\n    return attachment && (attachment.texture || attachment.renderbuffer)\n  }\n\n  function resizeAttachment (attachment, w, h) {\n    if (attachment) {\n      if (attachment.texture) {\n        attachment.texture.resize(w, h)\n      } else if (attachment.renderbuffer) {\n        attachment.renderbuffer.resize(w, h)\n      }\n      attachment.width = w\n      attachment.height = h\n    }\n  }\n\n  var framebufferCount = 0\n  var framebufferSet = {}\n\n  function REGLFramebuffer () {\n    this.id = framebufferCount++\n    framebufferSet[this.id] = this\n\n    this.framebuffer = gl.createFramebuffer()\n    this.width = 0\n    this.height = 0\n\n    this.colorAttachments = []\n    this.depthAttachment = null\n    this.stencilAttachment = null\n    this.depthStencilAttachment = null\n  }\n\n  function decFBORefs (framebuffer) {\n    framebuffer.colorAttachments.forEach(decRef)\n    decRef(framebuffer.depthAttachment)\n    decRef(framebuffer.stencilAttachment)\n    decRef(framebuffer.depthStencilAttachment)\n  }\n\n  function destroy (framebuffer) {\n    var handle = framebuffer.framebuffer\n    \n    gl.deleteFramebuffer(handle)\n    framebuffer.framebuffer = null\n    stats.framebufferCount--\n    delete framebufferSet[framebuffer.id]\n  }\n\n  function updateFramebuffer (framebuffer) {\n    var i\n\n    gl.bindFramebuffer(GL_FRAMEBUFFER$1, framebuffer.framebuffer)\n    var colorAttachments = framebuffer.colorAttachments\n    for (i = 0; i < colorAttachments.length; ++i) {\n      attach(GL_COLOR_ATTACHMENT0$1 + i, colorAttachments[i])\n    }\n    for (i = colorAttachments.length; i < limits.maxColorAttachments; ++i) {\n      gl.framebufferTexture2D(\n        GL_FRAMEBUFFER$1,\n        GL_COLOR_ATTACHMENT0$1 + i,\n        GL_TEXTURE_2D$2,\n        null,\n        0)\n    }\n\n    gl.framebufferTexture2D(\n      GL_FRAMEBUFFER$1,\n      GL_DEPTH_STENCIL_ATTACHMENT,\n      GL_TEXTURE_2D$2,\n      null,\n      0)\n    gl.framebufferTexture2D(\n      GL_FRAMEBUFFER$1,\n      GL_DEPTH_ATTACHMENT,\n      GL_TEXTURE_2D$2,\n      null,\n      0)\n    gl.framebufferTexture2D(\n      GL_FRAMEBUFFER$1,\n      GL_STENCIL_ATTACHMENT,\n      GL_TEXTURE_2D$2,\n      null,\n      0)\n\n    attach(GL_DEPTH_ATTACHMENT, framebuffer.depthAttachment)\n    attach(GL_STENCIL_ATTACHMENT, framebuffer.stencilAttachment)\n    attach(GL_DEPTH_STENCIL_ATTACHMENT, framebuffer.depthStencilAttachment)\n\n    // Check status code\n    var status = gl.checkFramebufferStatus(GL_FRAMEBUFFER$1)\n    if (!gl.isContextLost() && status !== GL_FRAMEBUFFER_COMPLETE$1) {\n      \n    }\n\n    gl.bindFramebuffer(GL_FRAMEBUFFER$1, framebufferState.next ? framebufferState.next.framebuffer : null)\n    framebufferState.cur = framebufferState.next\n\n    // FIXME: Clear error code here.  This is a work around for a bug in\n    // headless-gl\n    gl.getError()\n  }\n\n  function createFBO (a0, a1) {\n    var framebuffer = new REGLFramebuffer()\n    stats.framebufferCount++\n\n    function reglFramebuffer (a, b) {\n      var i\n\n      \n\n      var width = 0\n      var height = 0\n\n      var needsDepth = true\n      var needsStencil = true\n\n      var colorBuffer = null\n      var colorTexture = true\n      var colorFormat = 'rgba'\n      var colorType = 'uint8'\n      var colorCount = 1\n\n      var depthBuffer = null\n      var stencilBuffer = null\n      var depthStencilBuffer = null\n      var depthStencilTexture = false\n\n      if (typeof a === 'number') {\n        width = a | 0\n        height = (b | 0) || width\n      } else if (!a) {\n        width = height = 1\n      } else {\n        \n        var options = a\n\n        if ('shape' in options) {\n          var shape = options.shape\n          \n          width = shape[0]\n          height = shape[1]\n        } else {\n          if ('radius' in options) {\n            width = height = options.radius\n          }\n          if ('width' in options) {\n            width = options.width\n          }\n          if ('height' in options) {\n            height = options.height\n          }\n        }\n\n        if ('color' in options ||\n            'colors' in options) {\n          colorBuffer =\n            options.color ||\n            options.colors\n          if (Array.isArray(colorBuffer)) {\n            \n          }\n        }\n\n        if (!colorBuffer) {\n          if ('colorCount' in options) {\n            colorCount = options.colorCount | 0\n            \n          }\n\n          if ('colorTexture' in options) {\n            colorTexture = !!options.colorTexture\n            colorFormat = 'rgba4'\n          }\n\n          if ('colorType' in options) {\n            colorType = options.colorType\n            if (!colorTexture) {\n              if (colorType === 'half float' || colorType === 'float16') {\n                \n                colorFormat = 'rgba16f'\n              } else if (colorType === 'float' || colorType === 'float32') {\n                \n                colorFormat = 'rgba32f'\n              }\n            } else {\n              \n              \n            }\n            \n          }\n\n          if ('colorFormat' in options) {\n            colorFormat = options.colorFormat\n            if (colorTextureFormats.indexOf(colorFormat) >= 0) {\n              colorTexture = true\n            } else if (colorRenderbufferFormats.indexOf(colorFormat) >= 0) {\n              colorTexture = false\n            } else {\n              \n            }\n          }\n        }\n\n        if ('depthTexture' in options || 'depthStencilTexture' in options) {\n          depthStencilTexture = !!(options.depthTexture ||\n            options.depthStencilTexture)\n          \n        }\n\n        if ('depth' in options) {\n          if (typeof options.depth === 'boolean') {\n            needsDepth = options.depth\n          } else {\n            depthBuffer = options.depth\n            needsStencil = false\n          }\n        }\n\n        if ('stencil' in options) {\n          if (typeof options.stencil === 'boolean') {\n            needsStencil = options.stencil\n          } else {\n            stencilBuffer = options.stencil\n            needsDepth = false\n          }\n        }\n\n        if ('depthStencil' in options) {\n          if (typeof options.depthStencil === 'boolean') {\n            needsDepth = needsStencil = options.depthStencil\n          } else {\n            depthStencilBuffer = options.depthStencil\n            needsDepth = false\n            needsStencil = false\n          }\n        }\n      }\n\n      // parse attachments\n      var colorAttachments = null\n      var depthAttachment = null\n      var stencilAttachment = null\n      var depthStencilAttachment = null\n\n      // Set up color attachments\n      if (Array.isArray(colorBuffer)) {\n        colorAttachments = colorBuffer.map(parseAttachment)\n      } else if (colorBuffer) {\n        colorAttachments = [parseAttachment(colorBuffer)]\n      } else {\n        colorAttachments = new Array(colorCount)\n        for (i = 0; i < colorCount; ++i) {\n          colorAttachments[i] = allocAttachment(\n            width,\n            height,\n            colorTexture,\n            colorFormat,\n            colorType)\n        }\n      }\n\n      \n      \n\n      width = width || colorAttachments[0].width\n      height = height || colorAttachments[0].height\n\n      if (depthBuffer) {\n        depthAttachment = parseAttachment(depthBuffer)\n      } else if (needsDepth && !needsStencil) {\n        depthAttachment = allocAttachment(\n          width,\n          height,\n          depthStencilTexture,\n          'depth',\n          'uint32')\n      }\n\n      if (stencilBuffer) {\n        stencilAttachment = parseAttachment(stencilBuffer)\n      } else if (needsStencil && !needsDepth) {\n        stencilAttachment = allocAttachment(\n          width,\n          height,\n          false,\n          'stencil',\n          'uint8')\n      }\n\n      if (depthStencilBuffer) {\n        depthStencilAttachment = parseAttachment(depthStencilBuffer)\n      } else if (!depthBuffer && !stencilBuffer && needsStencil && needsDepth) {\n        depthStencilAttachment = allocAttachment(\n          width,\n          height,\n          depthStencilTexture,\n          'depth stencil',\n          'depth stencil')\n      }\n\n      \n\n      var commonColorAttachmentSize = null\n\n      for (i = 0; i < colorAttachments.length; ++i) {\n        incRefAndCheckShape(colorAttachments[i], width, height)\n        \n\n        if (colorAttachments[i] && colorAttachments[i].texture) {\n          var colorAttachmentSize =\n              textureFormatChannels[colorAttachments[i].texture._texture.format] *\n              textureTypeSizes[colorAttachments[i].texture._texture.type]\n\n          if (commonColorAttachmentSize === null) {\n            commonColorAttachmentSize = colorAttachmentSize\n          } else {\n            // We need to make sure that all color attachments have the same number of bitplanes\n            // (that is, the same numer of bits per pixel)\n            // This is required by the GLES2.0 standard. See the beginning of Chapter 4 in that document.\n            \n          }\n        }\n      }\n      incRefAndCheckShape(depthAttachment, width, height)\n      \n      incRefAndCheckShape(stencilAttachment, width, height)\n      \n      incRefAndCheckShape(depthStencilAttachment, width, height)\n      \n\n      // decrement references\n      decFBORefs(framebuffer)\n\n      framebuffer.width = width\n      framebuffer.height = height\n\n      framebuffer.colorAttachments = colorAttachments\n      framebuffer.depthAttachment = depthAttachment\n      framebuffer.stencilAttachment = stencilAttachment\n      framebuffer.depthStencilAttachment = depthStencilAttachment\n\n      reglFramebuffer.color = colorAttachments.map(unwrapAttachment)\n      reglFramebuffer.depth = unwrapAttachment(depthAttachment)\n      reglFramebuffer.stencil = unwrapAttachment(stencilAttachment)\n      reglFramebuffer.depthStencil = unwrapAttachment(depthStencilAttachment)\n\n      reglFramebuffer.width = framebuffer.width\n      reglFramebuffer.height = framebuffer.height\n\n      updateFramebuffer(framebuffer)\n\n      return reglFramebuffer\n    }\n\n    function resize (w_, h_) {\n      \n\n      var w = Math.max(w_ | 0, 1)\n      var h = Math.max((h_ | 0) || w, 1)\n      if (w === framebuffer.width && h === framebuffer.height) {\n        return reglFramebuffer\n      }\n\n      // resize all buffers\n      var colorAttachments = framebuffer.colorAttachments\n      for (var i = 0; i < colorAttachments.length; ++i) {\n        resizeAttachment(colorAttachments[i], w, h)\n      }\n      resizeAttachment(framebuffer.depthAttachment, w, h)\n      resizeAttachment(framebuffer.stencilAttachment, w, h)\n      resizeAttachment(framebuffer.depthStencilAttachment, w, h)\n\n      framebuffer.width = reglFramebuffer.width = w\n      framebuffer.height = reglFramebuffer.height = h\n\n      updateFramebuffer(framebuffer)\n\n      return reglFramebuffer\n    }\n\n    reglFramebuffer(a0, a1)\n\n    return extend(reglFramebuffer, {\n      resize: resize,\n      _reglType: 'framebuffer',\n      _framebuffer: framebuffer,\n      destroy: function () {\n        destroy(framebuffer)\n        decFBORefs(framebuffer)\n      },\n      use: function (block) {\n        framebufferState.setFBO({\n          framebuffer: reglFramebuffer\n        }, block)\n      }\n    })\n  }\n\n  function createCubeFBO (options) {\n    var faces = Array(6)\n\n    function reglFramebufferCube (a) {\n      var i\n\n      \n\n      var params = {\n        color: null\n      }\n\n      var radius = 0\n\n      var colorBuffer = null\n      var colorFormat = 'rgba'\n      var colorType = 'uint8'\n      var colorCount = 1\n\n      if (typeof a === 'number') {\n        radius = a | 0\n      } else if (!a) {\n        radius = 1\n      } else {\n        \n        var options = a\n\n        if ('shape' in options) {\n          var shape = options.shape\n          \n          \n          radius = shape[0]\n        } else {\n          if ('radius' in options) {\n            radius = options.radius | 0\n          }\n          if ('width' in options) {\n            radius = options.width | 0\n            if ('height' in options) {\n              \n            }\n          } else if ('height' in options) {\n            radius = options.height | 0\n          }\n        }\n\n        if ('color' in options ||\n            'colors' in options) {\n          colorBuffer =\n            options.color ||\n            options.colors\n          if (Array.isArray(colorBuffer)) {\n            \n          }\n        }\n\n        if (!colorBuffer) {\n          if ('colorCount' in options) {\n            colorCount = options.colorCount | 0\n            \n          }\n\n          if ('colorType' in options) {\n            \n            colorType = options.colorType\n          }\n\n          if ('colorFormat' in options) {\n            colorFormat = options.colorFormat\n            \n          }\n        }\n\n        if ('depth' in options) {\n          params.depth = options.depth\n        }\n\n        if ('stencil' in options) {\n          params.stencil = options.stencil\n        }\n\n        if ('depthStencil' in options) {\n          params.depthStencil = options.depthStencil\n        }\n      }\n\n      var colorCubes\n      if (colorBuffer) {\n        if (Array.isArray(colorBuffer)) {\n          colorCubes = []\n          for (i = 0; i < colorBuffer.length; ++i) {\n            colorCubes[i] = colorBuffer[i]\n          }\n        } else {\n          colorCubes = [ colorBuffer ]\n        }\n      } else {\n        colorCubes = Array(colorCount)\n        var cubeMapParams = {\n          radius: radius,\n          format: colorFormat,\n          type: colorType\n        }\n        for (i = 0; i < colorCount; ++i) {\n          colorCubes[i] = textureState.createCube(cubeMapParams)\n        }\n      }\n\n      // Check color cubes\n      params.color = Array(colorCubes.length)\n      for (i = 0; i < colorCubes.length; ++i) {\n        var cube = colorCubes[i]\n        \n        radius = radius || cube.width\n        \n        params.color[i] = {\n          target: GL_TEXTURE_CUBE_MAP_POSITIVE_X$2,\n          data: colorCubes[i]\n        }\n      }\n\n      for (i = 0; i < 6; ++i) {\n        for (var j = 0; j < colorCubes.length; ++j) {\n          params.color[j].target = GL_TEXTURE_CUBE_MAP_POSITIVE_X$2 + i\n        }\n        // reuse depth-stencil attachments across all cube maps\n        if (i > 0) {\n          params.depth = faces[0].depth\n          params.stencil = faces[0].stencil\n          params.depthStencil = faces[0].depthStencil\n        }\n        if (faces[i]) {\n          (faces[i])(params)\n        } else {\n          faces[i] = createFBO(params)\n        }\n      }\n\n      return extend(reglFramebufferCube, {\n        width: radius,\n        height: radius,\n        color: colorCubes\n      })\n    }\n\n    function resize (radius_) {\n      var i\n      var radius = radius_ | 0\n      \n\n      if (radius === reglFramebufferCube.width) {\n        return reglFramebufferCube\n      }\n\n      var colors = reglFramebufferCube.color\n      for (i = 0; i < colors.length; ++i) {\n        colors[i].resize(radius)\n      }\n\n      for (i = 0; i < 6; ++i) {\n        faces[i].resize(radius)\n      }\n\n      reglFramebufferCube.width = reglFramebufferCube.height = radius\n\n      return reglFramebufferCube\n    }\n\n    reglFramebufferCube(options)\n\n    return extend(reglFramebufferCube, {\n      faces: faces,\n      resize: resize,\n      _reglType: 'framebufferCube',\n      destroy: function () {\n        faces.forEach(function (f) {\n          f.destroy()\n        })\n      }\n    })\n  }\n\n  function restoreFramebuffers () {\n    framebufferState.cur = null\n    framebufferState.next = null\n    framebufferState.dirty = true\n    values(framebufferSet).forEach(function (fb) {\n      fb.framebuffer = gl.createFramebuffer()\n      updateFramebuffer(fb)\n    })\n  }\n\n  return extend(framebufferState, {\n    getFramebuffer: function (object) {\n      if (typeof object === 'function' && object._reglType === 'framebuffer') {\n        var fbo = object._framebuffer\n        if (fbo instanceof REGLFramebuffer) {\n          return fbo\n        }\n      }\n      return null\n    },\n    create: createFBO,\n    createCube: createCubeFBO,\n    clear: function () {\n      values(framebufferSet).forEach(destroy)\n    },\n    restore: restoreFramebuffers\n  })\n}\n\nvar GL_FLOAT$5 = 5126\nvar GL_ARRAY_BUFFER$1 = 34962\nvar GL_ELEMENT_ARRAY_BUFFER$1 = 34963\n\nfunction AttributeRecord () {\n  this.state = 0\n\n  this.x = 0.0\n  this.y = 0.0\n  this.z = 0.0\n  this.w = 0.0\n\n  this.buffer = null\n  this.size = 0\n  this.normalized = false\n  this.type = GL_FLOAT$5\n  this.offset = 0\n  this.stride = 0\n  this.divisor = 0\n}\n\nfunction wrapAttributeState (\n  gl,\n  extensions,\n  limits,\n  stats,\n  bufferState,\n  elementState,\n  drawState) {\n  var NUM_ATTRIBUTES = limits.maxAttributes\n  var attributeBindings = new Array(NUM_ATTRIBUTES)\n  for (var i = 0; i < NUM_ATTRIBUTES; ++i) {\n    attributeBindings[i] = new AttributeRecord()\n  }\n  var vaoCount = 0\n  var vaoSet = {}\n\n  var state = {\n    Record: AttributeRecord,\n    scope: {},\n    state: attributeBindings,\n    currentVAO: null,\n    targetVAO: null,\n    restore: extVAO() ? restoreVAO : function () {},\n    createVAO: createVAO,\n    getVAO: getVAO,\n    destroyBuffer: destroyBuffer,\n    setVAO: extVAO() ? setVAOEXT : setVAOEmulated,\n    clear: extVAO() ? destroyVAOEXT : function () {}\n  }\n\n  function destroyBuffer (buffer) {\n    for (var i = 0; i < attributeBindings.length; ++i) {\n      var record = attributeBindings[i]\n      if (record.buffer === buffer) {\n        gl.disableVertexAttribArray(i)\n        record.buffer = null\n      }\n    }\n  }\n\n  function extVAO () {\n    return extensions.oes_vertex_array_object\n  }\n\n  function extInstanced () {\n    return extensions.angle_instanced_arrays\n  }\n\n  function getVAO (vao) {\n    if (typeof vao === 'function' && vao._vao) {\n      return vao._vao\n    }\n    return null\n  }\n\n  function setVAOEXT (vao) {\n    if (vao === state.currentVAO) {\n      return\n    }\n    var ext = extVAO()\n    if (vao) {\n      ext.bindVertexArrayOES(vao.vao)\n    } else {\n      ext.bindVertexArrayOES(null)\n    }\n    state.currentVAO = vao\n  }\n\n  function setVAOEmulated (vao) {\n    if (vao === state.currentVAO) {\n      return\n    }\n    if (vao) {\n      vao.bindAttrs()\n    } else {\n      var exti = extInstanced()\n      for (var i = 0; i < attributeBindings.length; ++i) {\n        var binding = attributeBindings[i]\n        if (binding.buffer) {\n          gl.enableVertexAttribArray(i)\n          binding.buffer.bind()\n          gl.vertexAttribPointer(i, binding.size, binding.type, binding.normalized, binding.stride, binding.offfset)\n          if (exti && binding.divisor) {\n            exti.vertexAttribDivisorANGLE(i, binding.divisor)\n          }\n        } else {\n          gl.disableVertexAttribArray(i)\n          gl.vertexAttrib4f(i, binding.x, binding.y, binding.z, binding.w)\n        }\n      }\n      if (drawState.elements) {\n        gl.bindBuffer(GL_ELEMENT_ARRAY_BUFFER$1, drawState.elements.buffer.buffer)\n      } else {\n        gl.bindBuffer(GL_ELEMENT_ARRAY_BUFFER$1, null)\n      }\n    }\n    state.currentVAO = vao\n  }\n\n  function destroyVAOEXT () {\n    values(vaoSet).forEach(function (vao) {\n      vao.destroy()\n    })\n  }\n\n  function REGLVAO () {\n    this.id = ++vaoCount\n    this.attributes = []\n    this.elements = null\n    this.ownsElements = false\n    this.count = 0\n    this.offset = 0\n    this.instances = -1\n    this.primitive = 4\n    var extension = extVAO()\n    if (extension) {\n      this.vao = extension.createVertexArrayOES()\n    } else {\n      this.vao = null\n    }\n    vaoSet[this.id] = this\n    this.buffers = []\n  }\n\n  REGLVAO.prototype.bindAttrs = function () {\n    var exti = extInstanced()\n    var attributes = this.attributes\n    for (var i = 0; i < attributes.length; ++i) {\n      var attr = attributes[i]\n      if (attr.buffer) {\n        gl.enableVertexAttribArray(i)\n        gl.bindBuffer(GL_ARRAY_BUFFER$1, attr.buffer.buffer)\n        gl.vertexAttribPointer(i, attr.size, attr.type, attr.normalized, attr.stride, attr.offset)\n        if (exti && attr.divisor) {\n          exti.vertexAttribDivisorANGLE(i, attr.divisor)\n        }\n      } else {\n        gl.disableVertexAttribArray(i)\n        gl.vertexAttrib4f(i, attr.x, attr.y, attr.z, attr.w)\n      }\n    }\n    for (var j = attributes.length; j < NUM_ATTRIBUTES; ++j) {\n      gl.disableVertexAttribArray(j)\n    }\n    var elements = elementState.getElements(this.elements)\n    if (elements) {\n      gl.bindBuffer(GL_ELEMENT_ARRAY_BUFFER$1, elements.buffer.buffer)\n    } else {\n      gl.bindBuffer(GL_ELEMENT_ARRAY_BUFFER$1, null)\n    }\n  }\n\n  REGLVAO.prototype.refresh = function () {\n    var ext = extVAO()\n    if (ext) {\n      ext.bindVertexArrayOES(this.vao)\n      this.bindAttrs()\n      state.currentVAO = this\n    }\n  }\n\n  REGLVAO.prototype.destroy = function () {\n    if (this.vao) {\n      var extension = extVAO()\n      if (this === state.currentVAO) {\n        state.currentVAO = null\n        extension.bindVertexArrayOES(null)\n      }\n      extension.deleteVertexArrayOES(this.vao)\n      this.vao = null\n    }\n    if (this.ownsElements) {\n      this.elements.destroy()\n      this.elements = null\n      this.ownsElements = false\n    }\n    if (vaoSet[this.id]) {\n      delete vaoSet[this.id]\n      stats.vaoCount -= 1\n    }\n  }\n\n  function restoreVAO () {\n    var ext = extVAO()\n    if (ext) {\n      values(vaoSet).forEach(function (vao) {\n        vao.refresh()\n      })\n    }\n  }\n\n  function createVAO (_attr) {\n    var vao = new REGLVAO()\n    stats.vaoCount += 1\n\n    function updateVAO (options) {\n      var attributes\n      if (Array.isArray(options)) {\n        attributes = options\n        if (vao.elements && vao.ownsElements) {\n          vao.elements.destroy()\n        }\n        vao.elements = null\n        vao.ownsElements = false\n        vao.offset = 0\n        vao.count = 0\n        vao.instances = -1\n        vao.primitive = 4\n      } else {\n        \n        \n        if (options.elements) {\n          var elements = options.elements\n          if (vao.ownsElements) {\n            if (typeof elements === 'function' && elements._reglType === 'elements') {\n              vao.elements.destroy()\n              vao.ownsElements = false\n            } else {\n              vao.elements(elements)\n              vao.ownsElements = false\n            }\n          } else if (elementState.getElements(options.elements)) {\n            vao.elements = options.elements\n            vao.ownsElements = false\n          } else {\n            vao.elements = elementState.create(options.elements)\n            vao.ownsElements = true\n          }\n        } else {\n          vao.elements = null\n          vao.ownsElements = false\n        }\n        attributes = options.attributes\n\n        // set default vao\n        vao.offset = 0\n        vao.count = -1\n        vao.instances = -1\n        vao.primitive = 4\n\n        // copy element properties\n        if (vao.elements) {\n          vao.count = vao.elements._elements.vertCount\n          vao.primitive = vao.elements._elements.primType\n        }\n\n        if ('offset' in options) {\n          vao.offset = options.offset | 0\n        }\n        if ('count' in options) {\n          vao.count = options.count | 0\n        }\n        if ('instances' in options) {\n          vao.instances = options.instances | 0\n        }\n        if ('primitive' in options) {\n          \n          vao.primitive = primTypes[options.primitive]\n        }\n\n        \n        \n      }\n\n      \n      \n\n      var bufUpdated = {}\n      var nattributes = vao.attributes\n      nattributes.length = attributes.length\n      for (var i = 0; i < attributes.length; ++i) {\n        var spec = attributes[i]\n        var rec = nattributes[i] = new AttributeRecord()\n        var data = spec.data || spec\n        if (Array.isArray(data) || isTypedArray(data) || isNDArrayLike(data)) {\n          var buf\n          if (vao.buffers[i]) {\n            buf = vao.buffers[i]\n            if (isTypedArray(data) && buf._buffer.byteLength >= data.byteLength) {\n              buf.subdata(data)\n            } else {\n              buf.destroy()\n              vao.buffers[i] = null\n            }\n          }\n          if (!vao.buffers[i]) {\n            buf = vao.buffers[i] = bufferState.create(spec, GL_ARRAY_BUFFER$1, false, true)\n          }\n          rec.buffer = bufferState.getBuffer(buf)\n          rec.size = rec.buffer.dimension | 0\n          rec.normalized = false\n          rec.type = rec.buffer.dtype\n          rec.offset = 0\n          rec.stride = 0\n          rec.divisor = 0\n          rec.state = 1\n          bufUpdated[i] = 1\n        } else if (bufferState.getBuffer(spec)) {\n          rec.buffer = bufferState.getBuffer(spec)\n          rec.size = rec.buffer.dimension | 0\n          rec.normalized = false\n          rec.type = rec.buffer.dtype\n          rec.offset = 0\n          rec.stride = 0\n          rec.divisor = 0\n          rec.state = 1\n        } else if (bufferState.getBuffer(spec.buffer)) {\n          rec.buffer = bufferState.getBuffer(spec.buffer)\n          rec.size = ((+spec.size) || rec.buffer.dimension) | 0\n          rec.normalized = !!spec.normalized || false\n          if ('type' in spec) {\n            \n            rec.type = glTypes[spec.type]\n          } else {\n            rec.type = rec.buffer.dtype\n          }\n          rec.offset = (spec.offset || 0) | 0\n          rec.stride = (spec.stride || 0) | 0\n          rec.divisor = (spec.divisor || 0) | 0\n          rec.state = 1\n\n          \n          \n          \n          \n          \n        } else if ('x' in spec) {\n          \n          rec.x = +spec.x || 0\n          rec.y = +spec.y || 0\n          rec.z = +spec.z || 0\n          rec.w = +spec.w || 0\n          rec.state = 2\n        } else {\n          \n        }\n      }\n\n      // retire unused buffers\n      for (var j = 0; j < vao.buffers.length; ++j) {\n        if (!bufUpdated[j] && vao.buffers[j]) {\n          vao.buffers[j].destroy()\n          vao.buffers[j] = null\n        }\n      }\n\n      vao.refresh()\n      return updateVAO\n    }\n\n    updateVAO.destroy = function () {\n      for (var j = 0; j < vao.buffers.length; ++j) {\n        if (vao.buffers[j]) {\n          vao.buffers[j].destroy()\n        }\n      }\n      vao.buffers.length = 0\n\n      if (vao.ownsElements) {\n        vao.elements.destroy()\n        vao.elements = null\n        vao.ownsElements = false\n      }\n\n      vao.destroy()\n    }\n\n    updateVAO._vao = vao\n    updateVAO._reglType = 'vao'\n\n    return updateVAO(_attr)\n  }\n\n  return state\n}\n\nvar GL_FRAGMENT_SHADER = 35632\nvar GL_VERTEX_SHADER = 35633\n\nvar GL_ACTIVE_UNIFORMS = 0x8B86\nvar GL_ACTIVE_ATTRIBUTES = 0x8B89\n\nfunction wrapShaderState (gl, stringStore, stats, config) {\n  // ===================================================\n  // glsl compilation and linking\n  // ===================================================\n  var fragShaders = {}\n  var vertShaders = {}\n\n  function ActiveInfo (name, id, location, info) {\n    this.name = name\n    this.id = id\n    this.location = location\n    this.info = info\n  }\n\n  function insertActiveInfo (list, info) {\n    for (var i = 0; i < list.length; ++i) {\n      if (list[i].id === info.id) {\n        list[i].location = info.location\n        return\n      }\n    }\n    list.push(info)\n  }\n\n  function getShader (type, id, command) {\n    var cache = type === GL_FRAGMENT_SHADER ? fragShaders : vertShaders\n    var shader = cache[id]\n\n    if (!shader) {\n      var source = stringStore.str(id)\n      shader = gl.createShader(type)\n      gl.shaderSource(shader, source)\n      gl.compileShader(shader)\n      \n      cache[id] = shader\n    }\n\n    return shader\n  }\n\n  // ===================================================\n  // program linking\n  // ===================================================\n  var programCache = {}\n  var programList = []\n\n  var PROGRAM_COUNTER = 0\n\n  function REGLProgram (fragId, vertId) {\n    this.id = PROGRAM_COUNTER++\n    this.fragId = fragId\n    this.vertId = vertId\n    this.program = null\n    this.uniforms = []\n    this.attributes = []\n    this.refCount = 1\n\n    if (config.profile) {\n      this.stats = {\n        uniformsCount: 0,\n        attributesCount: 0\n      }\n    }\n  }\n\n  function linkProgram (desc, command, attributeLocations) {\n    var i, info\n\n    // -------------------------------\n    // compile & link\n    // -------------------------------\n    var fragShader = getShader(GL_FRAGMENT_SHADER, desc.fragId)\n    var vertShader = getShader(GL_VERTEX_SHADER, desc.vertId)\n\n    var program = desc.program = gl.createProgram()\n    gl.attachShader(program, fragShader)\n    gl.attachShader(program, vertShader)\n    if (attributeLocations) {\n      for (i = 0; i < attributeLocations.length; ++i) {\n        var binding = attributeLocations[i]\n        gl.bindAttribLocation(program, binding[0], binding[1])\n      }\n    }\n\n    gl.linkProgram(program)\n    \n\n    // -------------------------------\n    // grab uniforms\n    // -------------------------------\n    var numUniforms = gl.getProgramParameter(program, GL_ACTIVE_UNIFORMS)\n    if (config.profile) {\n      desc.stats.uniformsCount = numUniforms\n    }\n    var uniforms = desc.uniforms\n    for (i = 0; i < numUniforms; ++i) {\n      info = gl.getActiveUniform(program, i)\n      if (info) {\n        if (info.size > 1) {\n          for (var j = 0; j < info.size; ++j) {\n            var name = info.name.replace('[0]', '[' + j + ']')\n            insertActiveInfo(uniforms, new ActiveInfo(\n              name,\n              stringStore.id(name),\n              gl.getUniformLocation(program, name),\n              info))\n          }\n        } else {\n          insertActiveInfo(uniforms, new ActiveInfo(\n            info.name,\n            stringStore.id(info.name),\n            gl.getUniformLocation(program, info.name),\n            info))\n        }\n      }\n    }\n\n    // -------------------------------\n    // grab attributes\n    // -------------------------------\n    var numAttributes = gl.getProgramParameter(program, GL_ACTIVE_ATTRIBUTES)\n    if (config.profile) {\n      desc.stats.attributesCount = numAttributes\n    }\n\n    var attributes = desc.attributes\n    for (i = 0; i < numAttributes; ++i) {\n      info = gl.getActiveAttrib(program, i)\n      if (info) {\n        insertActiveInfo(attributes, new ActiveInfo(\n          info.name,\n          stringStore.id(info.name),\n          gl.getAttribLocation(program, info.name),\n          info))\n      }\n    }\n  }\n\n  if (config.profile) {\n    stats.getMaxUniformsCount = function () {\n      var m = 0\n      programList.forEach(function (desc) {\n        if (desc.stats.uniformsCount > m) {\n          m = desc.stats.uniformsCount\n        }\n      })\n      return m\n    }\n\n    stats.getMaxAttributesCount = function () {\n      var m = 0\n      programList.forEach(function (desc) {\n        if (desc.stats.attributesCount > m) {\n          m = desc.stats.attributesCount\n        }\n      })\n      return m\n    }\n  }\n\n  function restoreShaders () {\n    fragShaders = {}\n    vertShaders = {}\n    for (var i = 0; i < programList.length; ++i) {\n      linkProgram(programList[i], null, programList[i].attributes.map(function (info) {\n        return [info.location, info.name]\n      }))\n    }\n  }\n\n  return {\n    clear: function () {\n      var deleteShader = gl.deleteShader.bind(gl)\n      values(fragShaders).forEach(deleteShader)\n      fragShaders = {}\n      values(vertShaders).forEach(deleteShader)\n      vertShaders = {}\n\n      programList.forEach(function (desc) {\n        gl.deleteProgram(desc.program)\n      })\n      programList.length = 0\n      programCache = {}\n\n      stats.shaderCount = 0\n    },\n\n    program: function (vertId, fragId, command, attribLocations) {\n      \n      \n\n      var cache = programCache[fragId]\n      if (!cache) {\n        cache = programCache[fragId] = {}\n      }\n      var prevProgram = cache[vertId]\n      if (prevProgram) {\n        prevProgram.refCount++\n        if (!attribLocations) {\n          return prevProgram\n        }\n      }\n      var program = new REGLProgram(fragId, vertId)\n      stats.shaderCount++\n      linkProgram(program, command, attribLocations)\n      if (!prevProgram) {\n        cache[vertId] = program\n      }\n      programList.push(program)\n      return extend(program, {\n        destroy: function () {\n          program.refCount--\n          if (program.refCount <= 0) {\n            gl.deleteProgram(program.program)\n            var idx = programList.indexOf(program)\n            programList.splice(idx, 1)\n            stats.shaderCount--\n          }\n          // no program is linked to this vert anymore\n          if (cache[program.vertId].refCount <= 0) {\n            gl.deleteShader(vertShaders[program.vertId])\n            delete vertShaders[program.vertId]\n            delete programCache[program.fragId][program.vertId]\n          }\n          // no program is linked to this frag anymore\n          if (!Object.keys(programCache[program.fragId]).length) {\n            gl.deleteShader(fragShaders[program.fragId])\n            delete fragShaders[program.fragId]\n            delete programCache[program.fragId]\n          }\n        }\n      })\n    },\n\n    restore: restoreShaders,\n\n    shader: getShader,\n\n    frag: -1,\n    vert: -1\n  }\n}\n\nvar GL_RGBA$3 = 6408\nvar GL_UNSIGNED_BYTE$6 = 5121\nvar GL_PACK_ALIGNMENT = 0x0D05\nvar GL_FLOAT$6 = 0x1406 // 5126\n\nfunction wrapReadPixels (\n  gl,\n  framebufferState,\n  reglPoll,\n  context,\n  glAttributes,\n  extensions,\n  limits) {\n  function readPixelsImpl (input) {\n    var type\n    if (framebufferState.next === null) {\n      \n      type = GL_UNSIGNED_BYTE$6\n    } else {\n      \n      type = framebufferState.next.colorAttachments[0].texture._texture.type\n\n      \n    }\n\n    var x = 0\n    var y = 0\n    var width = context.framebufferWidth\n    var height = context.framebufferHeight\n    var data = null\n\n    if (isTypedArray(input)) {\n      data = input\n    } else if (input) {\n      \n      x = input.x | 0\n      y = input.y | 0\n      \n      \n      width = (input.width || (context.framebufferWidth - x)) | 0\n      height = (input.height || (context.framebufferHeight - y)) | 0\n      data = input.data || null\n    }\n\n    // sanity check input.data\n    if (data) {\n      if (type === GL_UNSIGNED_BYTE$6) {\n        \n      } else if (type === GL_FLOAT$6) {\n        \n      }\n    }\n\n    \n    \n\n    // Update WebGL state\n    reglPoll()\n\n    // Compute size\n    var size = width * height * 4\n\n    // Allocate data\n    if (!data) {\n      if (type === GL_UNSIGNED_BYTE$6) {\n        data = new Uint8Array(size)\n      } else if (type === GL_FLOAT$6) {\n        data = data || new Float32Array(size)\n      }\n    }\n\n    // Type check\n    \n    \n\n    // Run read pixels\n    gl.pixelStorei(GL_PACK_ALIGNMENT, 4)\n    gl.readPixels(x, y, width, height, GL_RGBA$3,\n      type,\n      data)\n\n    return data\n  }\n\n  function readPixelsFBO (options) {\n    var result\n    framebufferState.setFBO({\n      framebuffer: options.framebuffer\n    }, function () {\n      result = readPixelsImpl(options)\n    })\n    return result\n  }\n\n  function readPixels (options) {\n    if (!options || !('framebuffer' in options)) {\n      return readPixelsImpl(options)\n    } else {\n      return readPixelsFBO(options)\n    }\n  }\n\n  return readPixels\n}\n\nfunction slice (x) {\n  return Array.prototype.slice.call(x)\n}\n\nfunction join (x) {\n  return slice(x).join('')\n}\n\nfunction createEnvironment () {\n  // Unique variable id counter\n  var varCounter = 0\n\n  // Linked values are passed from this scope into the generated code block\n  // Calling link() passes a value into the generated scope and returns\n  // the variable name which it is bound to\n  var linkedNames = []\n  var linkedValues = []\n  function link (value) {\n    for (var i = 0; i < linkedValues.length; ++i) {\n      if (linkedValues[i] === value) {\n        return linkedNames[i]\n      }\n    }\n\n    var name = 'g' + (varCounter++)\n    linkedNames.push(name)\n    linkedValues.push(value)\n    return name\n  }\n\n  // create a code block\n  function block () {\n    var code = []\n    function push () {\n      code.push.apply(code, slice(arguments))\n    }\n\n    var vars = []\n    function def () {\n      var name = 'v' + (varCounter++)\n      vars.push(name)\n\n      if (arguments.length > 0) {\n        code.push(name, '=')\n        code.push.apply(code, slice(arguments))\n        code.push(';')\n      }\n\n      return name\n    }\n\n    return extend(push, {\n      def: def,\n      toString: function () {\n        return join([\n          (vars.length > 0 ? 'var ' + vars.join(',') + ';' : ''),\n          join(code)\n        ])\n      }\n    })\n  }\n\n  function scope () {\n    var entry = block()\n    var exit = block()\n\n    var entryToString = entry.toString\n    var exitToString = exit.toString\n\n    function save (object, prop) {\n      exit(object, prop, '=', entry.def(object, prop), ';')\n    }\n\n    return extend(function () {\n      entry.apply(entry, slice(arguments))\n    }, {\n      def: entry.def,\n      entry: entry,\n      exit: exit,\n      save: save,\n      set: function (object, prop, value) {\n        save(object, prop)\n        entry(object, prop, '=', value, ';')\n      },\n      toString: function () {\n        return entryToString() + exitToString()\n      }\n    })\n  }\n\n  function conditional () {\n    var pred = join(arguments)\n    var thenBlock = scope()\n    var elseBlock = scope()\n\n    var thenToString = thenBlock.toString\n    var elseToString = elseBlock.toString\n\n    return extend(thenBlock, {\n      then: function () {\n        thenBlock.apply(thenBlock, slice(arguments))\n        return this\n      },\n      else: function () {\n        elseBlock.apply(elseBlock, slice(arguments))\n        return this\n      },\n      toString: function () {\n        var elseClause = elseToString()\n        if (elseClause) {\n          elseClause = 'else{' + elseClause + '}'\n        }\n        return join([\n          'if(', pred, '){',\n          thenToString(),\n          '}', elseClause\n        ])\n      }\n    })\n  }\n\n  // procedure list\n  var globalBlock = block()\n  var procedures = {}\n  function proc (name, count) {\n    var args = []\n    function arg () {\n      var name = 'a' + args.length\n      args.push(name)\n      return name\n    }\n\n    count = count || 0\n    for (var i = 0; i < count; ++i) {\n      arg()\n    }\n\n    var body = scope()\n    var bodyToString = body.toString\n\n    var result = procedures[name] = extend(body, {\n      arg: arg,\n      toString: function () {\n        return join([\n          'function(', args.join(), '){',\n          bodyToString(),\n          '}'\n        ])\n      }\n    })\n\n    return result\n  }\n\n  function compile () {\n    var code = ['\"use strict\";',\n      globalBlock,\n      'return {']\n    Object.keys(procedures).forEach(function (name) {\n      code.push('\"', name, '\":', procedures[name].toString(), ',')\n    })\n    code.push('}')\n    var src = join(code)\n      .replace(/;/g, ';\\n')\n      .replace(/}/g, '}\\n')\n      .replace(/{/g, '{\\n')\n    var proc = Function.apply(null, linkedNames.concat(src))\n    return proc.apply(null, linkedValues)\n  }\n\n  return {\n    global: globalBlock,\n    link: link,\n    block: block,\n    proc: proc,\n    scope: scope,\n    cond: conditional,\n    compile: compile\n  }\n}\n\n// \"cute\" names for vector components\nvar CUTE_COMPONENTS = 'xyzw'.split('')\n\nvar GL_UNSIGNED_BYTE$7 = 5121\n\nvar ATTRIB_STATE_POINTER = 1\nvar ATTRIB_STATE_CONSTANT = 2\n\nvar DYN_FUNC$1 = 0\nvar DYN_PROP$1 = 1\nvar DYN_CONTEXT$1 = 2\nvar DYN_STATE$1 = 3\nvar DYN_THUNK = 4\nvar DYN_CONSTANT$1 = 5\nvar DYN_ARRAY$1 = 6\n\nvar S_DITHER = 'dither'\nvar S_BLEND_ENABLE = 'blend.enable'\nvar S_BLEND_COLOR = 'blend.color'\nvar S_BLEND_EQUATION = 'blend.equation'\nvar S_BLEND_FUNC = 'blend.func'\nvar S_DEPTH_ENABLE = 'depth.enable'\nvar S_DEPTH_FUNC = 'depth.func'\nvar S_DEPTH_RANGE = 'depth.range'\nvar S_DEPTH_MASK = 'depth.mask'\nvar S_COLOR_MASK = 'colorMask'\nvar S_CULL_ENABLE = 'cull.enable'\nvar S_CULL_FACE = 'cull.face'\nvar S_FRONT_FACE = 'frontFace'\nvar S_LINE_WIDTH = 'lineWidth'\nvar S_POLYGON_OFFSET_ENABLE = 'polygonOffset.enable'\nvar S_POLYGON_OFFSET_OFFSET = 'polygonOffset.offset'\nvar S_SAMPLE_ALPHA = 'sample.alpha'\nvar S_SAMPLE_ENABLE = 'sample.enable'\nvar S_SAMPLE_COVERAGE = 'sample.coverage'\nvar S_STENCIL_ENABLE = 'stencil.enable'\nvar S_STENCIL_MASK = 'stencil.mask'\nvar S_STENCIL_FUNC = 'stencil.func'\nvar S_STENCIL_OPFRONT = 'stencil.opFront'\nvar S_STENCIL_OPBACK = 'stencil.opBack'\nvar S_SCISSOR_ENABLE = 'scissor.enable'\nvar S_SCISSOR_BOX = 'scissor.box'\nvar S_VIEWPORT = 'viewport'\n\nvar S_PROFILE = 'profile'\n\nvar S_FRAMEBUFFER = 'framebuffer'\nvar S_VERT = 'vert'\nvar S_FRAG = 'frag'\nvar S_ELEMENTS = 'elements'\nvar S_PRIMITIVE = 'primitive'\nvar S_COUNT = 'count'\nvar S_OFFSET = 'offset'\nvar S_INSTANCES = 'instances'\nvar S_VAO = 'vao'\n\nvar SUFFIX_WIDTH = 'Width'\nvar SUFFIX_HEIGHT = 'Height'\n\nvar S_FRAMEBUFFER_WIDTH = S_FRAMEBUFFER + SUFFIX_WIDTH\nvar S_FRAMEBUFFER_HEIGHT = S_FRAMEBUFFER + SUFFIX_HEIGHT\nvar S_VIEWPORT_WIDTH = S_VIEWPORT + SUFFIX_WIDTH\nvar S_VIEWPORT_HEIGHT = S_VIEWPORT + SUFFIX_HEIGHT\nvar S_DRAWINGBUFFER = 'drawingBuffer'\nvar S_DRAWINGBUFFER_WIDTH = S_DRAWINGBUFFER + SUFFIX_WIDTH\nvar S_DRAWINGBUFFER_HEIGHT = S_DRAWINGBUFFER + SUFFIX_HEIGHT\n\nvar NESTED_OPTIONS = [\n  S_BLEND_FUNC,\n  S_BLEND_EQUATION,\n  S_STENCIL_FUNC,\n  S_STENCIL_OPFRONT,\n  S_STENCIL_OPBACK,\n  S_SAMPLE_COVERAGE,\n  S_VIEWPORT,\n  S_SCISSOR_BOX,\n  S_POLYGON_OFFSET_OFFSET\n]\n\nvar GL_ARRAY_BUFFER$2 = 34962\nvar GL_ELEMENT_ARRAY_BUFFER$2 = 34963\n\nvar GL_CULL_FACE = 0x0B44\nvar GL_BLEND = 0x0BE2\nvar GL_DITHER = 0x0BD0\nvar GL_STENCIL_TEST = 0x0B90\nvar GL_DEPTH_TEST = 0x0B71\nvar GL_SCISSOR_TEST = 0x0C11\nvar GL_POLYGON_OFFSET_FILL = 0x8037\nvar GL_SAMPLE_ALPHA_TO_COVERAGE = 0x809E\nvar GL_SAMPLE_COVERAGE = 0x80A0\n\nvar GL_FLOAT$7 = 5126\nvar GL_FLOAT_VEC2 = 35664\nvar GL_FLOAT_VEC3 = 35665\nvar GL_FLOAT_VEC4 = 35666\nvar GL_INT$2 = 5124\nvar GL_INT_VEC2 = 35667\nvar GL_INT_VEC3 = 35668\nvar GL_INT_VEC4 = 35669\nvar GL_BOOL = 35670\nvar GL_BOOL_VEC2 = 35671\nvar GL_BOOL_VEC3 = 35672\nvar GL_BOOL_VEC4 = 35673\nvar GL_FLOAT_MAT2 = 35674\nvar GL_FLOAT_MAT3 = 35675\nvar GL_FLOAT_MAT4 = 35676\nvar GL_SAMPLER_2D = 35678\nvar GL_SAMPLER_CUBE = 35680\n\nvar GL_TRIANGLES$1 = 4\n\nvar GL_FRONT = 1028\nvar GL_BACK = 1029\nvar GL_CW = 0x0900\nvar GL_CCW = 0x0901\nvar GL_MIN_EXT = 0x8007\nvar GL_MAX_EXT = 0x8008\nvar GL_ALWAYS = 519\nvar GL_KEEP = 7680\nvar GL_ZERO = 0\nvar GL_ONE = 1\nvar GL_FUNC_ADD = 0x8006\nvar GL_LESS = 513\n\nvar GL_FRAMEBUFFER$2 = 0x8D40\nvar GL_COLOR_ATTACHMENT0$2 = 0x8CE0\n\nvar blendFuncs = {\n  '0': 0,\n  '1': 1,\n  'zero': 0,\n  'one': 1,\n  'src color': 768,\n  'one minus src color': 769,\n  'src alpha': 770,\n  'one minus src alpha': 771,\n  'dst color': 774,\n  'one minus dst color': 775,\n  'dst alpha': 772,\n  'one minus dst alpha': 773,\n  'constant color': 32769,\n  'one minus constant color': 32770,\n  'constant alpha': 32771,\n  'one minus constant alpha': 32772,\n  'src alpha saturate': 776\n}\n\nvar compareFuncs = {\n  'never': 512,\n  'less': 513,\n  '<': 513,\n  'equal': 514,\n  '=': 514,\n  '==': 514,\n  '===': 514,\n  'lequal': 515,\n  '<=': 515,\n  'greater': 516,\n  '>': 516,\n  'notequal': 517,\n  '!=': 517,\n  '!==': 517,\n  'gequal': 518,\n  '>=': 518,\n  'always': 519\n}\n\nvar stencilOps = {\n  '0': 0,\n  'zero': 0,\n  'keep': 7680,\n  'replace': 7681,\n  'increment': 7682,\n  'decrement': 7683,\n  'increment wrap': 34055,\n  'decrement wrap': 34056,\n  'invert': 5386\n}\n\nvar orientationType = {\n  'cw': GL_CW,\n  'ccw': GL_CCW\n}\n\nfunction isBufferArgs (x) {\n  return Array.isArray(x) ||\n    isTypedArray(x) ||\n    isNDArrayLike(x)\n}\n\n// Make sure viewport is processed first\nfunction sortState (state) {\n  return state.sort(function (a, b) {\n    if (a === S_VIEWPORT) {\n      return -1\n    } else if (b === S_VIEWPORT) {\n      return 1\n    }\n    return (a < b) ? -1 : 1\n  })\n}\n\nfunction Declaration (thisDep, contextDep, propDep, append) {\n  this.thisDep = thisDep\n  this.contextDep = contextDep\n  this.propDep = propDep\n  this.append = append\n}\n\nfunction isStatic (decl) {\n  return decl && !(decl.thisDep || decl.contextDep || decl.propDep)\n}\n\nfunction createStaticDecl (append) {\n  return new Declaration(false, false, false, append)\n}\n\nfunction createDynamicDecl (dyn, append) {\n  var type = dyn.type\n  if (type === DYN_FUNC$1) {\n    var numArgs = dyn.data.length\n    return new Declaration(\n      true,\n      numArgs >= 1,\n      numArgs >= 2,\n      append)\n  } else if (type === DYN_THUNK) {\n    var data = dyn.data\n    return new Declaration(\n      data.thisDep,\n      data.contextDep,\n      data.propDep,\n      append)\n  } else if (type === DYN_CONSTANT$1) {\n    return new Declaration(\n      false,\n      false,\n      false,\n      append)\n  } else if (type === DYN_ARRAY$1) {\n    var thisDep = false\n    var contextDep = false\n    var propDep = false\n    for (var i = 0; i < dyn.data.length; ++i) {\n      var subDyn = dyn.data[i]\n      if (subDyn.type === DYN_PROP$1) {\n        propDep = true\n      } else if (subDyn.type === DYN_CONTEXT$1) {\n        contextDep = true\n      } else if (subDyn.type === DYN_STATE$1) {\n        thisDep = true\n      } else if (subDyn.type === DYN_FUNC$1) {\n        thisDep = true\n        var subArgs = subDyn.data\n        if (subArgs >= 1) {\n          contextDep = true\n        }\n        if (subArgs >= 2) {\n          propDep = true\n        }\n      } else if (subDyn.type === DYN_THUNK) {\n        thisDep = thisDep || subDyn.data.thisDep\n        contextDep = contextDep || subDyn.data.contextDep\n        propDep = propDep || subDyn.data.propDep\n      }\n    }\n    return new Declaration(\n      thisDep,\n      contextDep,\n      propDep,\n      append)\n  } else {\n    return new Declaration(\n      type === DYN_STATE$1,\n      type === DYN_CONTEXT$1,\n      type === DYN_PROP$1,\n      append)\n  }\n}\n\nvar SCOPE_DECL = new Declaration(false, false, false, function () {})\n\nfunction reglCore (\n  gl,\n  stringStore,\n  extensions,\n  limits,\n  bufferState,\n  elementState,\n  textureState,\n  framebufferState,\n  uniformState,\n  attributeState,\n  shaderState,\n  drawState,\n  contextState,\n  timer,\n  config) {\n  var AttributeRecord = attributeState.Record\n\n  var blendEquations = {\n    'add': 32774,\n    'subtract': 32778,\n    'reverse subtract': 32779\n  }\n  if (extensions.ext_blend_minmax) {\n    blendEquations.min = GL_MIN_EXT\n    blendEquations.max = GL_MAX_EXT\n  }\n\n  var extInstancing = extensions.angle_instanced_arrays\n  var extDrawBuffers = extensions.webgl_draw_buffers\n  var extVertexArrays = extensions.oes_vertex_array_object\n\n  // ===================================================\n  // ===================================================\n  // WEBGL STATE\n  // ===================================================\n  // ===================================================\n  var currentState = {\n    dirty: true,\n    profile: config.profile\n  }\n  var nextState = {}\n  var GL_STATE_NAMES = []\n  var GL_FLAGS = {}\n  var GL_VARIABLES = {}\n\n  function propName (name) {\n    return name.replace('.', '_')\n  }\n\n  function stateFlag (sname, cap, init) {\n    var name = propName(sname)\n    GL_STATE_NAMES.push(sname)\n    nextState[name] = currentState[name] = !!init\n    GL_FLAGS[name] = cap\n  }\n\n  function stateVariable (sname, func, init) {\n    var name = propName(sname)\n    GL_STATE_NAMES.push(sname)\n    if (Array.isArray(init)) {\n      currentState[name] = init.slice()\n      nextState[name] = init.slice()\n    } else {\n      currentState[name] = nextState[name] = init\n    }\n    GL_VARIABLES[name] = func\n  }\n\n  // Dithering\n  stateFlag(S_DITHER, GL_DITHER)\n\n  // Blending\n  stateFlag(S_BLEND_ENABLE, GL_BLEND)\n  stateVariable(S_BLEND_COLOR, 'blendColor', [0, 0, 0, 0])\n  stateVariable(S_BLEND_EQUATION, 'blendEquationSeparate',\n    [GL_FUNC_ADD, GL_FUNC_ADD])\n  stateVariable(S_BLEND_FUNC, 'blendFuncSeparate',\n    [GL_ONE, GL_ZERO, GL_ONE, GL_ZERO])\n\n  // Depth\n  stateFlag(S_DEPTH_ENABLE, GL_DEPTH_TEST, true)\n  stateVariable(S_DEPTH_FUNC, 'depthFunc', GL_LESS)\n  stateVariable(S_DEPTH_RANGE, 'depthRange', [0, 1])\n  stateVariable(S_DEPTH_MASK, 'depthMask', true)\n\n  // Color mask\n  stateVariable(S_COLOR_MASK, S_COLOR_MASK, [true, true, true, true])\n\n  // Face culling\n  stateFlag(S_CULL_ENABLE, GL_CULL_FACE)\n  stateVariable(S_CULL_FACE, 'cullFace', GL_BACK)\n\n  // Front face orientation\n  stateVariable(S_FRONT_FACE, S_FRONT_FACE, GL_CCW)\n\n  // Line width\n  stateVariable(S_LINE_WIDTH, S_LINE_WIDTH, 1)\n\n  // Polygon offset\n  stateFlag(S_POLYGON_OFFSET_ENABLE, GL_POLYGON_OFFSET_FILL)\n  stateVariable(S_POLYGON_OFFSET_OFFSET, 'polygonOffset', [0, 0])\n\n  // Sample coverage\n  stateFlag(S_SAMPLE_ALPHA, GL_SAMPLE_ALPHA_TO_COVERAGE)\n  stateFlag(S_SAMPLE_ENABLE, GL_SAMPLE_COVERAGE)\n  stateVariable(S_SAMPLE_COVERAGE, 'sampleCoverage', [1, false])\n\n  // Stencil\n  stateFlag(S_STENCIL_ENABLE, GL_STENCIL_TEST)\n  stateVariable(S_STENCIL_MASK, 'stencilMask', -1)\n  stateVariable(S_STENCIL_FUNC, 'stencilFunc', [GL_ALWAYS, 0, -1])\n  stateVariable(S_STENCIL_OPFRONT, 'stencilOpSeparate',\n    [GL_FRONT, GL_KEEP, GL_KEEP, GL_KEEP])\n  stateVariable(S_STENCIL_OPBACK, 'stencilOpSeparate',\n    [GL_BACK, GL_KEEP, GL_KEEP, GL_KEEP])\n\n  // Scissor\n  stateFlag(S_SCISSOR_ENABLE, GL_SCISSOR_TEST)\n  stateVariable(S_SCISSOR_BOX, 'scissor',\n    [0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight])\n\n  // Viewport\n  stateVariable(S_VIEWPORT, S_VIEWPORT,\n    [0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight])\n\n  // ===================================================\n  // ===================================================\n  // ENVIRONMENT\n  // ===================================================\n  // ===================================================\n  var sharedState = {\n    gl: gl,\n    context: contextState,\n    strings: stringStore,\n    next: nextState,\n    current: currentState,\n    draw: drawState,\n    elements: elementState,\n    buffer: bufferState,\n    shader: shaderState,\n    attributes: attributeState.state,\n    vao: attributeState,\n    uniforms: uniformState,\n    framebuffer: framebufferState,\n    extensions: extensions,\n\n    timer: timer,\n    isBufferArgs: isBufferArgs\n  }\n\n  var sharedConstants = {\n    primTypes: primTypes,\n    compareFuncs: compareFuncs,\n    blendFuncs: blendFuncs,\n    blendEquations: blendEquations,\n    stencilOps: stencilOps,\n    glTypes: glTypes,\n    orientationType: orientationType\n  }\n\n  \n\n  if (extDrawBuffers) {\n    sharedConstants.backBuffer = [GL_BACK]\n    sharedConstants.drawBuffer = loop(limits.maxDrawbuffers, function (i) {\n      if (i === 0) {\n        return [0]\n      }\n      return loop(i, function (j) {\n        return GL_COLOR_ATTACHMENT0$2 + j\n      })\n    })\n  }\n\n  var drawCallCounter = 0\n  function createREGLEnvironment () {\n    var env = createEnvironment()\n    var link = env.link\n    var global = env.global\n    env.id = drawCallCounter++\n\n    env.batchId = '0'\n\n    // link shared state\n    var SHARED = link(sharedState)\n    var shared = env.shared = {\n      props: 'a0'\n    }\n    Object.keys(sharedState).forEach(function (prop) {\n      shared[prop] = global.def(SHARED, '.', prop)\n    })\n\n    // Inject runtime assertion stuff for debug builds\n    \n\n    // Copy GL state variables over\n    var nextVars = env.next = {}\n    var currentVars = env.current = {}\n    Object.keys(GL_VARIABLES).forEach(function (variable) {\n      if (Array.isArray(currentState[variable])) {\n        nextVars[variable] = global.def(shared.next, '.', variable)\n        currentVars[variable] = global.def(shared.current, '.', variable)\n      }\n    })\n\n    // Initialize shared constants\n    var constants = env.constants = {}\n    Object.keys(sharedConstants).forEach(function (name) {\n      constants[name] = global.def(JSON.stringify(sharedConstants[name]))\n    })\n\n    // Helper function for calling a block\n    env.invoke = function (block, x) {\n      switch (x.type) {\n        case DYN_FUNC$1:\n          var argList = [\n            'this',\n            shared.context,\n            shared.props,\n            env.batchId\n          ]\n          return block.def(\n            link(x.data), '.call(',\n            argList.slice(0, Math.max(x.data.length + 1, 4)),\n            ')')\n        case DYN_PROP$1:\n          return block.def(shared.props, x.data)\n        case DYN_CONTEXT$1:\n          return block.def(shared.context, x.data)\n        case DYN_STATE$1:\n          return block.def('this', x.data)\n        case DYN_THUNK:\n          x.data.append(env, block)\n          return x.data.ref\n        case DYN_CONSTANT$1:\n          return x.data.toString()\n        case DYN_ARRAY$1:\n          return x.data.map(function (y) {\n            return env.invoke(block, y)\n          })\n      }\n    }\n\n    env.attribCache = {}\n\n    var scopeAttribs = {}\n    env.scopeAttrib = function (name) {\n      var id = stringStore.id(name)\n      if (id in scopeAttribs) {\n        return scopeAttribs[id]\n      }\n      var binding = attributeState.scope[id]\n      if (!binding) {\n        binding = attributeState.scope[id] = new AttributeRecord()\n      }\n      var result = scopeAttribs[id] = link(binding)\n      return result\n    }\n\n    return env\n  }\n\n  // ===================================================\n  // ===================================================\n  // PARSING\n  // ===================================================\n  // ===================================================\n  function parseProfile (options) {\n    var staticOptions = options.static\n    var dynamicOptions = options.dynamic\n\n    var profileEnable\n    if (S_PROFILE in staticOptions) {\n      var value = !!staticOptions[S_PROFILE]\n      profileEnable = createStaticDecl(function (env, scope) {\n        return value\n      })\n      profileEnable.enable = value\n    } else if (S_PROFILE in dynamicOptions) {\n      var dyn = dynamicOptions[S_PROFILE]\n      profileEnable = createDynamicDecl(dyn, function (env, scope) {\n        return env.invoke(scope, dyn)\n      })\n    }\n\n    return profileEnable\n  }\n\n  function parseFramebuffer (options, env) {\n    var staticOptions = options.static\n    var dynamicOptions = options.dynamic\n\n    if (S_FRAMEBUFFER in staticOptions) {\n      var framebuffer = staticOptions[S_FRAMEBUFFER]\n      if (framebuffer) {\n        framebuffer = framebufferState.getFramebuffer(framebuffer)\n        \n        return createStaticDecl(function (env, block) {\n          var FRAMEBUFFER = env.link(framebuffer)\n          var shared = env.shared\n          block.set(\n            shared.framebuffer,\n            '.next',\n            FRAMEBUFFER)\n          var CONTEXT = shared.context\n          block.set(\n            CONTEXT,\n            '.' + S_FRAMEBUFFER_WIDTH,\n            FRAMEBUFFER + '.width')\n          block.set(\n            CONTEXT,\n            '.' + S_FRAMEBUFFER_HEIGHT,\n            FRAMEBUFFER + '.height')\n          return FRAMEBUFFER\n        })\n      } else {\n        return createStaticDecl(function (env, scope) {\n          var shared = env.shared\n          scope.set(\n            shared.framebuffer,\n            '.next',\n            'null')\n          var CONTEXT = shared.context\n          scope.set(\n            CONTEXT,\n            '.' + S_FRAMEBUFFER_WIDTH,\n            CONTEXT + '.' + S_DRAWINGBUFFER_WIDTH)\n          scope.set(\n            CONTEXT,\n            '.' + S_FRAMEBUFFER_HEIGHT,\n            CONTEXT + '.' + S_DRAWINGBUFFER_HEIGHT)\n          return 'null'\n        })\n      }\n    } else if (S_FRAMEBUFFER in dynamicOptions) {\n      var dyn = dynamicOptions[S_FRAMEBUFFER]\n      return createDynamicDecl(dyn, function (env, scope) {\n        var FRAMEBUFFER_FUNC = env.invoke(scope, dyn)\n        var shared = env.shared\n        var FRAMEBUFFER_STATE = shared.framebuffer\n        var FRAMEBUFFER = scope.def(\n          FRAMEBUFFER_STATE, '.getFramebuffer(', FRAMEBUFFER_FUNC, ')')\n\n        \n\n        scope.set(\n          FRAMEBUFFER_STATE,\n          '.next',\n          FRAMEBUFFER)\n        var CONTEXT = shared.context\n        scope.set(\n          CONTEXT,\n          '.' + S_FRAMEBUFFER_WIDTH,\n          FRAMEBUFFER + '?' + FRAMEBUFFER + '.width:' +\n          CONTEXT + '.' + S_DRAWINGBUFFER_WIDTH)\n        scope.set(\n          CONTEXT,\n          '.' + S_FRAMEBUFFER_HEIGHT,\n          FRAMEBUFFER +\n          '?' + FRAMEBUFFER + '.height:' +\n          CONTEXT + '.' + S_DRAWINGBUFFER_HEIGHT)\n        return FRAMEBUFFER\n      })\n    } else {\n      return null\n    }\n  }\n\n  function parseViewportScissor (options, framebuffer, env) {\n    var staticOptions = options.static\n    var dynamicOptions = options.dynamic\n\n    function parseBox (param) {\n      if (param in staticOptions) {\n        var box = staticOptions[param]\n        \n\n        var isStatic = true\n        var x = box.x | 0\n        var y = box.y | 0\n        var w, h\n        if ('width' in box) {\n          w = box.width | 0\n          \n        } else {\n          isStatic = false\n        }\n        if ('height' in box) {\n          h = box.height | 0\n          \n        } else {\n          isStatic = false\n        }\n\n        return new Declaration(\n          !isStatic && framebuffer && framebuffer.thisDep,\n          !isStatic && framebuffer && framebuffer.contextDep,\n          !isStatic && framebuffer && framebuffer.propDep,\n          function (env, scope) {\n            var CONTEXT = env.shared.context\n            var BOX_W = w\n            if (!('width' in box)) {\n              BOX_W = scope.def(CONTEXT, '.', S_FRAMEBUFFER_WIDTH, '-', x)\n            }\n            var BOX_H = h\n            if (!('height' in box)) {\n              BOX_H = scope.def(CONTEXT, '.', S_FRAMEBUFFER_HEIGHT, '-', y)\n            }\n            return [x, y, BOX_W, BOX_H]\n          })\n      } else if (param in dynamicOptions) {\n        var dynBox = dynamicOptions[param]\n        var result = createDynamicDecl(dynBox, function (env, scope) {\n          var BOX = env.invoke(scope, dynBox)\n\n          \n\n          var CONTEXT = env.shared.context\n          var BOX_X = scope.def(BOX, '.x|0')\n          var BOX_Y = scope.def(BOX, '.y|0')\n          var BOX_W = scope.def(\n            '\"width\" in ', BOX, '?', BOX, '.width|0:',\n            '(', CONTEXT, '.', S_FRAMEBUFFER_WIDTH, '-', BOX_X, ')')\n          var BOX_H = scope.def(\n            '\"height\" in ', BOX, '?', BOX, '.height|0:',\n            '(', CONTEXT, '.', S_FRAMEBUFFER_HEIGHT, '-', BOX_Y, ')')\n\n          \n\n          return [BOX_X, BOX_Y, BOX_W, BOX_H]\n        })\n        if (framebuffer) {\n          result.thisDep = result.thisDep || framebuffer.thisDep\n          result.contextDep = result.contextDep || framebuffer.contextDep\n          result.propDep = result.propDep || framebuffer.propDep\n        }\n        return result\n      } else if (framebuffer) {\n        return new Declaration(\n          framebuffer.thisDep,\n          framebuffer.contextDep,\n          framebuffer.propDep,\n          function (env, scope) {\n            var CONTEXT = env.shared.context\n            return [\n              0, 0,\n              scope.def(CONTEXT, '.', S_FRAMEBUFFER_WIDTH),\n              scope.def(CONTEXT, '.', S_FRAMEBUFFER_HEIGHT)]\n          })\n      } else {\n        return null\n      }\n    }\n\n    var viewport = parseBox(S_VIEWPORT)\n\n    if (viewport) {\n      var prevViewport = viewport\n      viewport = new Declaration(\n        viewport.thisDep,\n        viewport.contextDep,\n        viewport.propDep,\n        function (env, scope) {\n          var VIEWPORT = prevViewport.append(env, scope)\n          var CONTEXT = env.shared.context\n          scope.set(\n            CONTEXT,\n            '.' + S_VIEWPORT_WIDTH,\n            VIEWPORT[2])\n          scope.set(\n            CONTEXT,\n            '.' + S_VIEWPORT_HEIGHT,\n            VIEWPORT[3])\n          return VIEWPORT\n        })\n    }\n\n    return {\n      viewport: viewport,\n      scissor_box: parseBox(S_SCISSOR_BOX)\n    }\n  }\n\n  function parseAttribLocations (options, attributes) {\n    var staticOptions = options.static\n    var staticProgram =\n      typeof staticOptions[S_FRAG] === 'string' &&\n      typeof staticOptions[S_VERT] === 'string'\n    if (staticProgram) {\n      if (Object.keys(attributes.dynamic).length > 0) {\n        return null\n      }\n      var staticAttributes = attributes.static\n      var sAttributes = Object.keys(staticAttributes)\n      if (sAttributes.length > 0 && typeof staticAttributes[sAttributes[0]] === 'number') {\n        var bindings = []\n        for (var i = 0; i < sAttributes.length; ++i) {\n          \n          bindings.push([staticAttributes[sAttributes[i]] | 0, sAttributes[i]])\n        }\n        return bindings\n      }\n    }\n    return null\n  }\n\n  function parseProgram (options, env, attribLocations) {\n    var staticOptions = options.static\n    var dynamicOptions = options.dynamic\n\n    function parseShader (name) {\n      if (name in staticOptions) {\n        var id = stringStore.id(staticOptions[name])\n        \n        var result = createStaticDecl(function () {\n          return id\n        })\n        result.id = id\n        return result\n      } else if (name in dynamicOptions) {\n        var dyn = dynamicOptions[name]\n        return createDynamicDecl(dyn, function (env, scope) {\n          var str = env.invoke(scope, dyn)\n          var id = scope.def(env.shared.strings, '.id(', str, ')')\n          \n          return id\n        })\n      }\n      return null\n    }\n\n    var frag = parseShader(S_FRAG)\n    var vert = parseShader(S_VERT)\n\n    var program = null\n    var progVar\n    if (isStatic(frag) && isStatic(vert)) {\n      program = shaderState.program(vert.id, frag.id, null, attribLocations)\n      progVar = createStaticDecl(function (env, scope) {\n        return env.link(program)\n      })\n    } else {\n      progVar = new Declaration(\n        (frag && frag.thisDep) || (vert && vert.thisDep),\n        (frag && frag.contextDep) || (vert && vert.contextDep),\n        (frag && frag.propDep) || (vert && vert.propDep),\n        function (env, scope) {\n          var SHADER_STATE = env.shared.shader\n          var fragId\n          if (frag) {\n            fragId = frag.append(env, scope)\n          } else {\n            fragId = scope.def(SHADER_STATE, '.', S_FRAG)\n          }\n          var vertId\n          if (vert) {\n            vertId = vert.append(env, scope)\n          } else {\n            vertId = scope.def(SHADER_STATE, '.', S_VERT)\n          }\n          var progDef = SHADER_STATE + '.program(' + vertId + ',' + fragId\n          \n          return scope.def(progDef + ')')\n        })\n    }\n\n    return {\n      frag: frag,\n      vert: vert,\n      progVar: progVar,\n      program: program\n    }\n  }\n\n  function parseDraw (options, env) {\n    var staticOptions = options.static\n    var dynamicOptions = options.dynamic\n\n    // TODO: should use VAO to get default values for offset properties\n    // should move vao parse into here and out of the old stuff\n\n    var staticDraw = {}\n    var vaoActive = false\n    var vaoLive = false\n\n    function parseVAO () {\n      if (S_VAO in staticOptions) {\n        \n\n        var vao = staticOptions[S_VAO]\n        if (vao !== null && attributeState.getVAO(vao) === null) {\n          vao = attributeState.createVAO(vao)\n        }\n\n        vaoActive = true\n        vaoLive = !!vao\n        staticDraw.vao = vao\n\n        return createStaticDecl(function (env) {\n          var vaoRef = attributeState.getVAO(vao)\n          if (vaoRef) {\n            return env.link(vaoRef)\n          } else {\n            return 'null'\n          }\n        })\n      } else if (S_VAO in dynamicOptions) {\n        \n        vaoActive = true\n        vaoLive = true\n        var dyn = dynamicOptions[S_VAO]\n        return createDynamicDecl(dyn, function (env, scope) {\n          var vaoRef = env.invoke(scope, dyn)\n          return scope.def(env.shared.vao + '.getVAO(' + vaoRef + ')')\n        })\n      }\n      return null\n    }\n\n    var vao = parseVAO()\n\n    var elementsActive = false\n\n    function parseElements () {\n      if (S_ELEMENTS in staticOptions) {\n        \n\n        var elements = staticOptions[S_ELEMENTS]\n        staticDraw.elements = elements\n        if (isBufferArgs(elements)) {\n          var e = staticDraw.elements = elementState.create(elements, true)\n          elements = elementState.getElements(e)\n          elementsActive = true\n        } else if (elements) {\n          elements = elementState.getElements(elements)\n          elementsActive = true\n          \n        }\n\n        var result = createStaticDecl(function (env, scope) {\n          if (elements) {\n            var result = env.link(elements)\n            env.ELEMENTS = result\n            return result\n          }\n          env.ELEMENTS = null\n          return null\n        })\n        result.value = elements\n        return result\n      } else if (S_ELEMENTS in dynamicOptions) {\n        \n        elementsActive = true\n\n        var dyn = dynamicOptions[S_ELEMENTS]\n        return createDynamicDecl(dyn, function (env, scope) {\n          var shared = env.shared\n\n          var IS_BUFFER_ARGS = shared.isBufferArgs\n          var ELEMENT_STATE = shared.elements\n\n          var elementDefn = env.invoke(scope, dyn)\n          var elements = scope.def('null')\n          var elementStream = scope.def(IS_BUFFER_ARGS, '(', elementDefn, ')')\n\n          var ifte = env.cond(elementStream)\n            .then(elements, '=', ELEMENT_STATE, '.createStream(', elementDefn, ');')\n            .else(elements, '=', ELEMENT_STATE, '.getElements(', elementDefn, ');')\n\n          \n\n          scope.entry(ifte)\n          scope.exit(\n            env.cond(elementStream)\n              .then(ELEMENT_STATE, '.destroyStream(', elements, ');'))\n\n          env.ELEMENTS = elements\n\n          return elements\n        })\n      } else if (vaoActive) {\n        return new Declaration(\n          vao.thisDep,\n          vao.contextDep,\n          vao.propDep,\n          function (env, scope) {\n            return scope.def(env.shared.vao + '.currentVAO?' + env.shared.elements + '.getElements(' + env.shared.vao + '.currentVAO.elements):null')\n          })\n      }\n      return null\n    }\n\n    var elements = parseElements()\n    if (elementsActive) {\n      vao = createStaticDecl(function () {\n        return 'null'\n      })\n    }\n\n    function parsePrimitive () {\n      if (S_PRIMITIVE in staticOptions) {\n        var primitive = staticOptions[S_PRIMITIVE]\n        staticDraw.primitive = primitive\n        \n        return createStaticDecl(function (env, scope) {\n          return primTypes[primitive]\n        })\n      } else if (S_PRIMITIVE in dynamicOptions) {\n        var dynPrimitive = dynamicOptions[S_PRIMITIVE]\n        return createDynamicDecl(dynPrimitive, function (env, scope) {\n          var PRIM_TYPES = env.constants.primTypes\n          var prim = env.invoke(scope, dynPrimitive)\n          \n          return scope.def(PRIM_TYPES, '[', prim, ']')\n        })\n      } else if (elementsActive) {\n        if (isStatic(elements)) {\n          if (elements.value) {\n            return createStaticDecl(function (env, scope) {\n              return scope.def(env.ELEMENTS, '.primType')\n            })\n          } else {\n            return createStaticDecl(function () {\n              return GL_TRIANGLES$1\n            })\n          }\n        } else {\n          return new Declaration(\n            elements.thisDep,\n            elements.contextDep,\n            elements.propDep,\n            function (env, scope) {\n              var elements = env.ELEMENTS\n              return scope.def(elements, '?', elements, '.primType:', GL_TRIANGLES$1)\n            })\n        }\n      } else if (vaoActive) {\n        return new Declaration(\n          vao.thisDep,\n          vao.contextDep,\n          vao.propDep,\n          function (env, scope) {\n            return scope.def(env.shared.vao + '.currentVAO?' + env.shared.vao + '.currentVAO.primitive:' + GL_TRIANGLES$1)\n          })\n      }\n      return null\n    }\n\n    function parseParam (param, isOffset) {\n      if (param in staticOptions) {\n        var value = staticOptions[param] | 0\n        if (isOffset) {\n          staticDraw.offset = value\n        } else {\n          staticDraw.instances = value\n        }\n        \n        return createStaticDecl(function (env, scope) {\n          if (isOffset) {\n            env.OFFSET = value\n          }\n          return value\n        })\n      } else if (param in dynamicOptions) {\n        var dynValue = dynamicOptions[param]\n        return createDynamicDecl(dynValue, function (env, scope) {\n          var result = env.invoke(scope, dynValue)\n          if (isOffset) {\n            env.OFFSET = result\n            \n          }\n          return result\n        })\n      } else if (isOffset) {\n        if (elementsActive) {\n          return createStaticDecl(function (env, scope) {\n            env.OFFSET = 0\n            return 0\n          })\n        } else if (vaoActive) {\n          return new Declaration(\n            vao.thisDep,\n            vao.contextDep,\n            vao.propDep,\n            function (env, scope) {\n              return scope.def(env.shared.vao + '.currentVAO?' + env.shared.vao + '.currentVAO.offset:0')\n            })\n        }\n      } else if (vaoActive) {\n        return new Declaration(\n          vao.thisDep,\n          vao.contextDep,\n          vao.propDep,\n          function (env, scope) {\n            return scope.def(env.shared.vao + '.currentVAO?' + env.shared.vao + '.currentVAO.instances:-1')\n          })\n      }\n      return null\n    }\n\n    var OFFSET = parseParam(S_OFFSET, true)\n\n    function parseVertCount () {\n      if (S_COUNT in staticOptions) {\n        var count = staticOptions[S_COUNT] | 0\n        staticDraw.count = count\n        \n        return createStaticDecl(function () {\n          return count\n        })\n      } else if (S_COUNT in dynamicOptions) {\n        var dynCount = dynamicOptions[S_COUNT]\n        return createDynamicDecl(dynCount, function (env, scope) {\n          var result = env.invoke(scope, dynCount)\n          \n          return result\n        })\n      } else if (elementsActive) {\n        if (isStatic(elements)) {\n          if (elements) {\n            if (OFFSET) {\n              return new Declaration(\n                OFFSET.thisDep,\n                OFFSET.contextDep,\n                OFFSET.propDep,\n                function (env, scope) {\n                  var result = scope.def(\n                    env.ELEMENTS, '.vertCount-', env.OFFSET)\n\n                  \n\n                  return result\n                })\n            } else {\n              return createStaticDecl(function (env, scope) {\n                return scope.def(env.ELEMENTS, '.vertCount')\n              })\n            }\n          } else {\n            var result = createStaticDecl(function () {\n              return -1\n            })\n            \n            return result\n          }\n        } else {\n          var variable = new Declaration(\n            elements.thisDep || OFFSET.thisDep,\n            elements.contextDep || OFFSET.contextDep,\n            elements.propDep || OFFSET.propDep,\n            function (env, scope) {\n              var elements = env.ELEMENTS\n              if (env.OFFSET) {\n                return scope.def(elements, '?', elements, '.vertCount-',\n                  env.OFFSET, ':-1')\n              }\n              return scope.def(elements, '?', elements, '.vertCount:-1')\n            })\n          \n          return variable\n        }\n      } else if (vaoActive) {\n        var countVariable = new Declaration(\n          vao.thisDep,\n          vao.contextDep,\n          vao.propDep,\n          function (env, scope) {\n            return scope.def(env.shared.vao, '.currentVAO?', env.shared.vao, '.currentVAO.count:-1')\n          })\n        return countVariable\n      }\n      return null\n    }\n\n    var primitive = parsePrimitive()\n    var count = parseVertCount()\n    var instances = parseParam(S_INSTANCES, false)\n\n    return {\n      elements: elements,\n      primitive: primitive,\n      count: count,\n      instances: instances,\n      offset: OFFSET,\n      vao: vao,\n\n      vaoActive: vaoActive,\n      elementsActive: elementsActive,\n\n      // static draw props\n      static: staticDraw\n    }\n  }\n\n  function parseGLState (options, env) {\n    var staticOptions = options.static\n    var dynamicOptions = options.dynamic\n\n    var STATE = {}\n\n    GL_STATE_NAMES.forEach(function (prop) {\n      var param = propName(prop)\n\n      function parseParam (parseStatic, parseDynamic) {\n        if (prop in staticOptions) {\n          var value = parseStatic(staticOptions[prop])\n          STATE[param] = createStaticDecl(function () {\n            return value\n          })\n        } else if (prop in dynamicOptions) {\n          var dyn = dynamicOptions[prop]\n          STATE[param] = createDynamicDecl(dyn, function (env, scope) {\n            return parseDynamic(env, scope, env.invoke(scope, dyn))\n          })\n        }\n      }\n\n      switch (prop) {\n        case S_CULL_ENABLE:\n        case S_BLEND_ENABLE:\n        case S_DITHER:\n        case S_STENCIL_ENABLE:\n        case S_DEPTH_ENABLE:\n        case S_SCISSOR_ENABLE:\n        case S_POLYGON_OFFSET_ENABLE:\n        case S_SAMPLE_ALPHA:\n        case S_SAMPLE_ENABLE:\n        case S_DEPTH_MASK:\n          return parseParam(\n            function (value) {\n              \n              return value\n            },\n            function (env, scope, value) {\n              \n              return value\n            })\n\n        case S_DEPTH_FUNC:\n          return parseParam(\n            function (value) {\n              \n              return compareFuncs[value]\n            },\n            function (env, scope, value) {\n              var COMPARE_FUNCS = env.constants.compareFuncs\n              \n              return scope.def(COMPARE_FUNCS, '[', value, ']')\n            })\n\n        case S_DEPTH_RANGE:\n          return parseParam(\n            function (value) {\n              \n              return value\n            },\n            function (env, scope, value) {\n              \n\n              var Z_NEAR = scope.def('+', value, '[0]')\n              var Z_FAR = scope.def('+', value, '[1]')\n              return [Z_NEAR, Z_FAR]\n            })\n\n        case S_BLEND_FUNC:\n          return parseParam(\n            function (value) {\n              \n              var srcRGB = ('srcRGB' in value ? value.srcRGB : value.src)\n              var srcAlpha = ('srcAlpha' in value ? value.srcAlpha : value.src)\n              var dstRGB = ('dstRGB' in value ? value.dstRGB : value.dst)\n              var dstAlpha = ('dstAlpha' in value ? value.dstAlpha : value.dst)\n              \n              \n              \n              \n\n              \n\n              return [\n                blendFuncs[srcRGB],\n                blendFuncs[dstRGB],\n                blendFuncs[srcAlpha],\n                blendFuncs[dstAlpha]\n              ]\n            },\n            function (env, scope, value) {\n              var BLEND_FUNCS = env.constants.blendFuncs\n\n              \n\n              function read (prefix, suffix) {\n                var func = scope.def(\n                  '\"', prefix, suffix, '\" in ', value,\n                  '?', value, '.', prefix, suffix,\n                  ':', value, '.', prefix)\n\n                \n\n                return func\n              }\n\n              var srcRGB = read('src', 'RGB')\n              var dstRGB = read('dst', 'RGB')\n\n              \n\n              var SRC_RGB = scope.def(BLEND_FUNCS, '[', srcRGB, ']')\n              var SRC_ALPHA = scope.def(BLEND_FUNCS, '[', read('src', 'Alpha'), ']')\n              var DST_RGB = scope.def(BLEND_FUNCS, '[', dstRGB, ']')\n              var DST_ALPHA = scope.def(BLEND_FUNCS, '[', read('dst', 'Alpha'), ']')\n\n              return [SRC_RGB, DST_RGB, SRC_ALPHA, DST_ALPHA]\n            })\n\n        case S_BLEND_EQUATION:\n          return parseParam(\n            function (value) {\n              if (typeof value === 'string') {\n                \n                return [\n                  blendEquations[value],\n                  blendEquations[value]\n                ]\n              } else if (typeof value === 'object') {\n                \n                \n                return [\n                  blendEquations[value.rgb],\n                  blendEquations[value.alpha]\n                ]\n              } else {\n                \n              }\n            },\n            function (env, scope, value) {\n              var BLEND_EQUATIONS = env.constants.blendEquations\n\n              var RGB = scope.def()\n              var ALPHA = scope.def()\n\n              var ifte = env.cond('typeof ', value, '===\"string\"')\n\n              \n\n              ifte.then(\n                RGB, '=', ALPHA, '=', BLEND_EQUATIONS, '[', value, '];')\n              ifte.else(\n                RGB, '=', BLEND_EQUATIONS, '[', value, '.rgb];',\n                ALPHA, '=', BLEND_EQUATIONS, '[', value, '.alpha];')\n\n              scope(ifte)\n\n              return [RGB, ALPHA]\n            })\n\n        case S_BLEND_COLOR:\n          return parseParam(\n            function (value) {\n              \n              return loop(4, function (i) {\n                return +value[i]\n              })\n            },\n            function (env, scope, value) {\n              \n              return loop(4, function (i) {\n                return scope.def('+', value, '[', i, ']')\n              })\n            })\n\n        case S_STENCIL_MASK:\n          return parseParam(\n            function (value) {\n              \n              return value | 0\n            },\n            function (env, scope, value) {\n              \n              return scope.def(value, '|0')\n            })\n\n        case S_STENCIL_FUNC:\n          return parseParam(\n            function (value) {\n              \n              var cmp = value.cmp || 'keep'\n              var ref = value.ref || 0\n              var mask = 'mask' in value ? value.mask : -1\n              \n              \n              \n              return [\n                compareFuncs[cmp],\n                ref,\n                mask\n              ]\n            },\n            function (env, scope, value) {\n              var COMPARE_FUNCS = env.constants.compareFuncs\n              \n              var cmp = scope.def(\n                '\"cmp\" in ', value,\n                '?', COMPARE_FUNCS, '[', value, '.cmp]',\n                ':', GL_KEEP)\n              var ref = scope.def(value, '.ref|0')\n              var mask = scope.def(\n                '\"mask\" in ', value,\n                '?', value, '.mask|0:-1')\n              return [cmp, ref, mask]\n            })\n\n        case S_STENCIL_OPFRONT:\n        case S_STENCIL_OPBACK:\n          return parseParam(\n            function (value) {\n              \n              var fail = value.fail || 'keep'\n              var zfail = value.zfail || 'keep'\n              var zpass = value.zpass || 'keep'\n              \n              \n              \n              return [\n                prop === S_STENCIL_OPBACK ? GL_BACK : GL_FRONT,\n                stencilOps[fail],\n                stencilOps[zfail],\n                stencilOps[zpass]\n              ]\n            },\n            function (env, scope, value) {\n              var STENCIL_OPS = env.constants.stencilOps\n\n              \n\n              function read (name) {\n                \n\n                return scope.def(\n                  '\"', name, '\" in ', value,\n                  '?', STENCIL_OPS, '[', value, '.', name, ']:',\n                  GL_KEEP)\n              }\n\n              return [\n                prop === S_STENCIL_OPBACK ? GL_BACK : GL_FRONT,\n                read('fail'),\n                read('zfail'),\n                read('zpass')\n              ]\n            })\n\n        case S_POLYGON_OFFSET_OFFSET:\n          return parseParam(\n            function (value) {\n              \n              var factor = value.factor | 0\n              var units = value.units | 0\n              \n              \n              return [factor, units]\n            },\n            function (env, scope, value) {\n              \n\n              var FACTOR = scope.def(value, '.factor|0')\n              var UNITS = scope.def(value, '.units|0')\n\n              return [FACTOR, UNITS]\n            })\n\n        case S_CULL_FACE:\n          return parseParam(\n            function (value) {\n              var face = 0\n              if (value === 'front') {\n                face = GL_FRONT\n              } else if (value === 'back') {\n                face = GL_BACK\n              }\n              \n              return face\n            },\n            function (env, scope, value) {\n              \n              return scope.def(value, '===\"front\"?', GL_FRONT, ':', GL_BACK)\n            })\n\n        case S_LINE_WIDTH:\n          return parseParam(\n            function (value) {\n              \n              return value\n            },\n            function (env, scope, value) {\n              \n\n              return value\n            })\n\n        case S_FRONT_FACE:\n          return parseParam(\n            function (value) {\n              \n              return orientationType[value]\n            },\n            function (env, scope, value) {\n              \n              return scope.def(value + '===\"cw\"?' + GL_CW + ':' + GL_CCW)\n            })\n\n        case S_COLOR_MASK:\n          return parseParam(\n            function (value) {\n              \n              return value.map(function (v) { return !!v })\n            },\n            function (env, scope, value) {\n              \n              return loop(4, function (i) {\n                return '!!' + value + '[' + i + ']'\n              })\n            })\n\n        case S_SAMPLE_COVERAGE:\n          return parseParam(\n            function (value) {\n              \n              var sampleValue = 'value' in value ? value.value : 1\n              var sampleInvert = !!value.invert\n              \n              return [sampleValue, sampleInvert]\n            },\n            function (env, scope, value) {\n              \n              var VALUE = scope.def(\n                '\"value\" in ', value, '?+', value, '.value:1')\n              var INVERT = scope.def('!!', value, '.invert')\n              return [VALUE, INVERT]\n            })\n      }\n    })\n\n    return STATE\n  }\n\n  function parseUniforms (uniforms, env) {\n    var staticUniforms = uniforms.static\n    var dynamicUniforms = uniforms.dynamic\n\n    var UNIFORMS = {}\n\n    Object.keys(staticUniforms).forEach(function (name) {\n      var value = staticUniforms[name]\n      var result\n      if (typeof value === 'number' ||\n          typeof value === 'boolean') {\n        result = createStaticDecl(function () {\n          return value\n        })\n      } else if (typeof value === 'function') {\n        var reglType = value._reglType\n        if (reglType === 'texture2d' ||\n            reglType === 'textureCube') {\n          result = createStaticDecl(function (env) {\n            return env.link(value)\n          })\n        } else if (reglType === 'framebuffer' ||\n                   reglType === 'framebufferCube') {\n          \n          result = createStaticDecl(function (env) {\n            return env.link(value.color[0])\n          })\n        } else {\n          \n        }\n      } else if (isArrayLike(value)) {\n        result = createStaticDecl(function (env) {\n          var ITEM = env.global.def('[',\n            loop(value.length, function (i) {\n              \n              return value[i]\n            }), ']')\n          return ITEM\n        })\n      } else {\n        \n      }\n      result.value = value\n      UNIFORMS[name] = result\n    })\n\n    Object.keys(dynamicUniforms).forEach(function (key) {\n      var dyn = dynamicUniforms[key]\n      UNIFORMS[key] = createDynamicDecl(dyn, function (env, scope) {\n        return env.invoke(scope, dyn)\n      })\n    })\n\n    return UNIFORMS\n  }\n\n  function parseAttributes (attributes, env) {\n    var staticAttributes = attributes.static\n    var dynamicAttributes = attributes.dynamic\n\n    var attributeDefs = {}\n\n    Object.keys(staticAttributes).forEach(function (attribute) {\n      var value = staticAttributes[attribute]\n      var id = stringStore.id(attribute)\n\n      var record = new AttributeRecord()\n      if (isBufferArgs(value)) {\n        record.state = ATTRIB_STATE_POINTER\n        record.buffer = bufferState.getBuffer(\n          bufferState.create(value, GL_ARRAY_BUFFER$2, false, true))\n        record.type = 0\n      } else {\n        var buffer = bufferState.getBuffer(value)\n        if (buffer) {\n          record.state = ATTRIB_STATE_POINTER\n          record.buffer = buffer\n          record.type = 0\n        } else {\n          \n          if ('constant' in value) {\n            var constant = value.constant\n            record.buffer = 'null'\n            record.state = ATTRIB_STATE_CONSTANT\n            if (typeof constant === 'number') {\n              record.x = constant\n            } else {\n              \n              CUTE_COMPONENTS.forEach(function (c, i) {\n                if (i < constant.length) {\n                  record[c] = constant[i]\n                }\n              })\n            }\n          } else {\n            if (isBufferArgs(value.buffer)) {\n              buffer = bufferState.getBuffer(\n                bufferState.create(value.buffer, GL_ARRAY_BUFFER$2, false, true))\n            } else {\n              buffer = bufferState.getBuffer(value.buffer)\n            }\n            \n\n            var offset = value.offset | 0\n            \n\n            var stride = value.stride | 0\n            \n\n            var size = value.size | 0\n            \n\n            var normalized = !!value.normalized\n\n            var type = 0\n            if ('type' in value) {\n              \n              type = glTypes[value.type]\n            }\n\n            var divisor = value.divisor | 0\n            \n\n            record.buffer = buffer\n            record.state = ATTRIB_STATE_POINTER\n            record.size = size\n            record.normalized = normalized\n            record.type = type || buffer.dtype\n            record.offset = offset\n            record.stride = stride\n            record.divisor = divisor\n          }\n        }\n      }\n\n      attributeDefs[attribute] = createStaticDecl(function (env, scope) {\n        var cache = env.attribCache\n        if (id in cache) {\n          return cache[id]\n        }\n        var result = {\n          isStream: false\n        }\n        Object.keys(record).forEach(function (key) {\n          result[key] = record[key]\n        })\n        if (record.buffer) {\n          result.buffer = env.link(record.buffer)\n          result.type = result.type || (result.buffer + '.dtype')\n        }\n        cache[id] = result\n        return result\n      })\n    })\n\n    Object.keys(dynamicAttributes).forEach(function (attribute) {\n      var dyn = dynamicAttributes[attribute]\n\n      function appendAttributeCode (env, block) {\n        var VALUE = env.invoke(block, dyn)\n\n        var shared = env.shared\n        var constants = env.constants\n\n        var IS_BUFFER_ARGS = shared.isBufferArgs\n        var BUFFER_STATE = shared.buffer\n\n        // Perform validation on attribute\n        \n\n        // allocate names for result\n        var result = {\n          isStream: block.def(false)\n        }\n        var defaultRecord = new AttributeRecord()\n        defaultRecord.state = ATTRIB_STATE_POINTER\n        Object.keys(defaultRecord).forEach(function (key) {\n          result[key] = block.def('' + defaultRecord[key])\n        })\n\n        var BUFFER = result.buffer\n        var TYPE = result.type\n        block(\n          'if(', IS_BUFFER_ARGS, '(', VALUE, ')){',\n          result.isStream, '=true;',\n          BUFFER, '=', BUFFER_STATE, '.createStream(', GL_ARRAY_BUFFER$2, ',', VALUE, ');',\n          TYPE, '=', BUFFER, '.dtype;',\n          '}else{',\n          BUFFER, '=', BUFFER_STATE, '.getBuffer(', VALUE, ');',\n          'if(', BUFFER, '){',\n          TYPE, '=', BUFFER, '.dtype;',\n          '}else if(\"constant\" in ', VALUE, '){',\n          result.state, '=', ATTRIB_STATE_CONSTANT, ';',\n          'if(typeof ' + VALUE + '.constant === \"number\"){',\n          result[CUTE_COMPONENTS[0]], '=', VALUE, '.constant;',\n          CUTE_COMPONENTS.slice(1).map(function (n) {\n            return result[n]\n          }).join('='), '=0;',\n          '}else{',\n          CUTE_COMPONENTS.map(function (name, i) {\n            return (\n              result[name] + '=' + VALUE + '.constant.length>' + i +\n              '?' + VALUE + '.constant[' + i + ']:0;'\n            )\n          }).join(''),\n          '}}else{',\n          'if(', IS_BUFFER_ARGS, '(', VALUE, '.buffer)){',\n          BUFFER, '=', BUFFER_STATE, '.createStream(', GL_ARRAY_BUFFER$2, ',', VALUE, '.buffer);',\n          '}else{',\n          BUFFER, '=', BUFFER_STATE, '.getBuffer(', VALUE, '.buffer);',\n          '}',\n          TYPE, '=\"type\" in ', VALUE, '?',\n          constants.glTypes, '[', VALUE, '.type]:', BUFFER, '.dtype;',\n          result.normalized, '=!!', VALUE, '.normalized;')\n        function emitReadRecord (name) {\n          block(result[name], '=', VALUE, '.', name, '|0;')\n        }\n        emitReadRecord('size')\n        emitReadRecord('offset')\n        emitReadRecord('stride')\n        emitReadRecord('divisor')\n\n        block('}}')\n\n        block.exit(\n          'if(', result.isStream, '){',\n          BUFFER_STATE, '.destroyStream(', BUFFER, ');',\n          '}')\n\n        return result\n      }\n\n      attributeDefs[attribute] = createDynamicDecl(dyn, appendAttributeCode)\n    })\n\n    return attributeDefs\n  }\n\n  function parseContext (context) {\n    var staticContext = context.static\n    var dynamicContext = context.dynamic\n    var result = {}\n\n    Object.keys(staticContext).forEach(function (name) {\n      var value = staticContext[name]\n      result[name] = createStaticDecl(function (env, scope) {\n        if (typeof value === 'number' || typeof value === 'boolean') {\n          return '' + value\n        } else {\n          return env.link(value)\n        }\n      })\n    })\n\n    Object.keys(dynamicContext).forEach(function (name) {\n      var dyn = dynamicContext[name]\n      result[name] = createDynamicDecl(dyn, function (env, scope) {\n        return env.invoke(scope, dyn)\n      })\n    })\n\n    return result\n  }\n\n  function parseArguments (options, attributes, uniforms, context, env) {\n    var staticOptions = options.static\n    var dynamicOptions = options.dynamic\n\n    \n\n    var attribLocations = parseAttribLocations(options, attributes)\n\n    var framebuffer = parseFramebuffer(options, env)\n    var viewportAndScissor = parseViewportScissor(options, framebuffer, env)\n    var draw = parseDraw(options, env)\n    var state = parseGLState(options, env)\n    var shader = parseProgram(options, env, attribLocations)\n\n    function copyBox (name) {\n      var defn = viewportAndScissor[name]\n      if (defn) {\n        state[name] = defn\n      }\n    }\n    copyBox(S_VIEWPORT)\n    copyBox(propName(S_SCISSOR_BOX))\n\n    var dirty = Object.keys(state).length > 0\n\n    var result = {\n      framebuffer: framebuffer,\n      draw: draw,\n      shader: shader,\n      state: state,\n      dirty: dirty,\n      scopeVAO: null,\n      drawVAO: null,\n      useVAO: false,\n      attributes: {}\n    }\n\n    result.profile = parseProfile(options, env)\n    result.uniforms = parseUniforms(uniforms, env)\n    result.drawVAO = result.scopeVAO = draw.vao\n    // special case: check if we can statically allocate a vertex array object for this program\n    if (!result.drawVAO &&\n      shader.program &&\n      !attribLocations &&\n      extensions.angle_instanced_arrays &&\n      draw.static.elements) {\n      var useVAO = true\n      var staticBindings = shader.program.attributes.map(function (attr) {\n        var binding = attributes.static[attr]\n        useVAO = useVAO && !!binding\n        return binding\n      })\n      if (useVAO && staticBindings.length > 0) {\n        var vao = attributeState.getVAO(attributeState.createVAO({\n          attributes: staticBindings,\n          elements: draw.static.elements\n        }))\n        result.drawVAO = new Declaration(null, null, null, function (env, scope) {\n          return env.link(vao)\n        })\n        result.useVAO = true\n      }\n    }\n    if (attribLocations) {\n      \n      result.useVAO = true\n    } else {\n      result.attributes = parseAttributes(attributes, env)\n    }\n    result.context = parseContext(context, env)\n    return result\n  }\n\n  // ===================================================\n  // ===================================================\n  // COMMON UPDATE FUNCTIONS\n  // ===================================================\n  // ===================================================\n  function emitContext (env, scope, context) {\n    var shared = env.shared\n    var CONTEXT = shared.context\n\n    var contextEnter = env.scope()\n\n    Object.keys(context).forEach(function (name) {\n      scope.save(CONTEXT, '.' + name)\n      var defn = context[name]\n      var value = defn.append(env, scope)\n      if (Array.isArray(value)) {\n        contextEnter(CONTEXT, '.', name, '=[', value.join(), '];')\n      } else {\n        contextEnter(CONTEXT, '.', name, '=', value, ';')\n      }\n    })\n\n    scope(contextEnter)\n  }\n\n  // ===================================================\n  // ===================================================\n  // COMMON DRAWING FUNCTIONS\n  // ===================================================\n  // ===================================================\n  function emitPollFramebuffer (env, scope, framebuffer, skipCheck) {\n    var shared = env.shared\n\n    var GL = shared.gl\n    var FRAMEBUFFER_STATE = shared.framebuffer\n    var EXT_DRAW_BUFFERS\n    if (extDrawBuffers) {\n      EXT_DRAW_BUFFERS = scope.def(shared.extensions, '.webgl_draw_buffers')\n    }\n\n    var constants = env.constants\n\n    var DRAW_BUFFERS = constants.drawBuffer\n    var BACK_BUFFER = constants.backBuffer\n\n    var NEXT\n    if (framebuffer) {\n      NEXT = framebuffer.append(env, scope)\n    } else {\n      NEXT = scope.def(FRAMEBUFFER_STATE, '.next')\n    }\n\n    if (!skipCheck) {\n      scope('if(', NEXT, '!==', FRAMEBUFFER_STATE, '.cur){')\n    }\n    scope(\n      'if(', NEXT, '){',\n      GL, '.bindFramebuffer(', GL_FRAMEBUFFER$2, ',', NEXT, '.framebuffer);')\n    if (extDrawBuffers) {\n      scope(EXT_DRAW_BUFFERS, '.drawBuffersWEBGL(',\n        DRAW_BUFFERS, '[', NEXT, '.colorAttachments.length]);')\n    }\n    scope('}else{',\n      GL, '.bindFramebuffer(', GL_FRAMEBUFFER$2, ',null);')\n    if (extDrawBuffers) {\n      scope(EXT_DRAW_BUFFERS, '.drawBuffersWEBGL(', BACK_BUFFER, ');')\n    }\n    scope(\n      '}',\n      FRAMEBUFFER_STATE, '.cur=', NEXT, ';')\n    if (!skipCheck) {\n      scope('}')\n    }\n  }\n\n  function emitPollState (env, scope, args) {\n    var shared = env.shared\n\n    var GL = shared.gl\n\n    var CURRENT_VARS = env.current\n    var NEXT_VARS = env.next\n    var CURRENT_STATE = shared.current\n    var NEXT_STATE = shared.next\n\n    var block = env.cond(CURRENT_STATE, '.dirty')\n\n    GL_STATE_NAMES.forEach(function (prop) {\n      var param = propName(prop)\n      if (param in args.state) {\n        return\n      }\n\n      var NEXT, CURRENT\n      if (param in NEXT_VARS) {\n        NEXT = NEXT_VARS[param]\n        CURRENT = CURRENT_VARS[param]\n        var parts = loop(currentState[param].length, function (i) {\n          return block.def(NEXT, '[', i, ']')\n        })\n        block(env.cond(parts.map(function (p, i) {\n          return p + '!==' + CURRENT + '[' + i + ']'\n        }).join('||'))\n          .then(\n            GL, '.', GL_VARIABLES[param], '(', parts, ');',\n            parts.map(function (p, i) {\n              return CURRENT + '[' + i + ']=' + p\n            }).join(';'), ';'))\n      } else {\n        NEXT = block.def(NEXT_STATE, '.', param)\n        var ifte = env.cond(NEXT, '!==', CURRENT_STATE, '.', param)\n        block(ifte)\n        if (param in GL_FLAGS) {\n          ifte(\n            env.cond(NEXT)\n              .then(GL, '.enable(', GL_FLAGS[param], ');')\n              .else(GL, '.disable(', GL_FLAGS[param], ');'),\n            CURRENT_STATE, '.', param, '=', NEXT, ';')\n        } else {\n          ifte(\n            GL, '.', GL_VARIABLES[param], '(', NEXT, ');',\n            CURRENT_STATE, '.', param, '=', NEXT, ';')\n        }\n      }\n    })\n    if (Object.keys(args.state).length === 0) {\n      block(CURRENT_STATE, '.dirty=false;')\n    }\n    scope(block)\n  }\n\n  function emitSetOptions (env, scope, options, filter) {\n    var shared = env.shared\n    var CURRENT_VARS = env.current\n    var CURRENT_STATE = shared.current\n    var GL = shared.gl\n    sortState(Object.keys(options)).forEach(function (param) {\n      var defn = options[param]\n      if (filter && !filter(defn)) {\n        return\n      }\n      var variable = defn.append(env, scope)\n      if (GL_FLAGS[param]) {\n        var flag = GL_FLAGS[param]\n        if (isStatic(defn)) {\n          if (variable) {\n            scope(GL, '.enable(', flag, ');')\n          } else {\n            scope(GL, '.disable(', flag, ');')\n          }\n        } else {\n          scope(env.cond(variable)\n            .then(GL, '.enable(', flag, ');')\n            .else(GL, '.disable(', flag, ');'))\n        }\n        scope(CURRENT_STATE, '.', param, '=', variable, ';')\n      } else if (isArrayLike(variable)) {\n        var CURRENT = CURRENT_VARS[param]\n        scope(\n          GL, '.', GL_VARIABLES[param], '(', variable, ');',\n          variable.map(function (v, i) {\n            return CURRENT + '[' + i + ']=' + v\n          }).join(';'), ';')\n      } else {\n        scope(\n          GL, '.', GL_VARIABLES[param], '(', variable, ');',\n          CURRENT_STATE, '.', param, '=', variable, ';')\n      }\n    })\n  }\n\n  function injectExtensions (env, scope) {\n    if (extInstancing) {\n      env.instancing = scope.def(\n        env.shared.extensions, '.angle_instanced_arrays')\n    }\n  }\n\n  function emitProfile (env, scope, args, useScope, incrementCounter) {\n    var shared = env.shared\n    var STATS = env.stats\n    var CURRENT_STATE = shared.current\n    var TIMER = shared.timer\n    var profileArg = args.profile\n\n    function perfCounter () {\n      if (typeof performance === 'undefined') {\n        return 'Date.now()'\n      } else {\n        return 'performance.now()'\n      }\n    }\n\n    var CPU_START, QUERY_COUNTER\n    function emitProfileStart (block) {\n      CPU_START = scope.def()\n      block(CPU_START, '=', perfCounter(), ';')\n      if (typeof incrementCounter === 'string') {\n        block(STATS, '.count+=', incrementCounter, ';')\n      } else {\n        block(STATS, '.count++;')\n      }\n      if (timer) {\n        if (useScope) {\n          QUERY_COUNTER = scope.def()\n          block(QUERY_COUNTER, '=', TIMER, '.getNumPendingQueries();')\n        } else {\n          block(TIMER, '.beginQuery(', STATS, ');')\n        }\n      }\n    }\n\n    function emitProfileEnd (block) {\n      block(STATS, '.cpuTime+=', perfCounter(), '-', CPU_START, ';')\n      if (timer) {\n        if (useScope) {\n          block(TIMER, '.pushScopeStats(',\n            QUERY_COUNTER, ',',\n            TIMER, '.getNumPendingQueries(),',\n            STATS, ');')\n        } else {\n          block(TIMER, '.endQuery();')\n        }\n      }\n    }\n\n    function scopeProfile (value) {\n      var prev = scope.def(CURRENT_STATE, '.profile')\n      scope(CURRENT_STATE, '.profile=', value, ';')\n      scope.exit(CURRENT_STATE, '.profile=', prev, ';')\n    }\n\n    var USE_PROFILE\n    if (profileArg) {\n      if (isStatic(profileArg)) {\n        if (profileArg.enable) {\n          emitProfileStart(scope)\n          emitProfileEnd(scope.exit)\n          scopeProfile('true')\n        } else {\n          scopeProfile('false')\n        }\n        return\n      }\n      USE_PROFILE = profileArg.append(env, scope)\n      scopeProfile(USE_PROFILE)\n    } else {\n      USE_PROFILE = scope.def(CURRENT_STATE, '.profile')\n    }\n\n    var start = env.block()\n    emitProfileStart(start)\n    scope('if(', USE_PROFILE, '){', start, '}')\n    var end = env.block()\n    emitProfileEnd(end)\n    scope.exit('if(', USE_PROFILE, '){', end, '}')\n  }\n\n  function emitAttributes (env, scope, args, attributes, filter) {\n    var shared = env.shared\n\n    function typeLength (x) {\n      switch (x) {\n        case GL_FLOAT_VEC2:\n        case GL_INT_VEC2:\n        case GL_BOOL_VEC2:\n          return 2\n        case GL_FLOAT_VEC3:\n        case GL_INT_VEC3:\n        case GL_BOOL_VEC3:\n          return 3\n        case GL_FLOAT_VEC4:\n        case GL_INT_VEC4:\n        case GL_BOOL_VEC4:\n          return 4\n        default:\n          return 1\n      }\n    }\n\n    function emitBindAttribute (ATTRIBUTE, size, record) {\n      var GL = shared.gl\n\n      var LOCATION = scope.def(ATTRIBUTE, '.location')\n      var BINDING = scope.def(shared.attributes, '[', LOCATION, ']')\n\n      var STATE = record.state\n      var BUFFER = record.buffer\n      var CONST_COMPONENTS = [\n        record.x,\n        record.y,\n        record.z,\n        record.w\n      ]\n\n      var COMMON_KEYS = [\n        'buffer',\n        'normalized',\n        'offset',\n        'stride'\n      ]\n\n      function emitBuffer () {\n        scope(\n          'if(!', BINDING, '.buffer){',\n          GL, '.enableVertexAttribArray(', LOCATION, ');}')\n\n        var TYPE = record.type\n        var SIZE\n        if (!record.size) {\n          SIZE = size\n        } else {\n          SIZE = scope.def(record.size, '||', size)\n        }\n\n        scope('if(',\n          BINDING, '.type!==', TYPE, '||',\n          BINDING, '.size!==', SIZE, '||',\n          COMMON_KEYS.map(function (key) {\n            return BINDING + '.' + key + '!==' + record[key]\n          }).join('||'),\n          '){',\n          GL, '.bindBuffer(', GL_ARRAY_BUFFER$2, ',', BUFFER, '.buffer);',\n          GL, '.vertexAttribPointer(', [\n            LOCATION,\n            SIZE,\n            TYPE,\n            record.normalized,\n            record.stride,\n            record.offset\n          ], ');',\n          BINDING, '.type=', TYPE, ';',\n          BINDING, '.size=', SIZE, ';',\n          COMMON_KEYS.map(function (key) {\n            return BINDING + '.' + key + '=' + record[key] + ';'\n          }).join(''),\n          '}')\n\n        if (extInstancing) {\n          var DIVISOR = record.divisor\n          scope(\n            'if(', BINDING, '.divisor!==', DIVISOR, '){',\n            env.instancing, '.vertexAttribDivisorANGLE(', [LOCATION, DIVISOR], ');',\n            BINDING, '.divisor=', DIVISOR, ';}')\n        }\n      }\n\n      function emitConstant () {\n        scope(\n          'if(', BINDING, '.buffer){',\n          GL, '.disableVertexAttribArray(', LOCATION, ');',\n          BINDING, '.buffer=null;',\n          '}if(', CUTE_COMPONENTS.map(function (c, i) {\n            return BINDING + '.' + c + '!==' + CONST_COMPONENTS[i]\n          }).join('||'), '){',\n          GL, '.vertexAttrib4f(', LOCATION, ',', CONST_COMPONENTS, ');',\n          CUTE_COMPONENTS.map(function (c, i) {\n            return BINDING + '.' + c + '=' + CONST_COMPONENTS[i] + ';'\n          }).join(''),\n          '}')\n      }\n\n      if (STATE === ATTRIB_STATE_POINTER) {\n        emitBuffer()\n      } else if (STATE === ATTRIB_STATE_CONSTANT) {\n        emitConstant()\n      } else {\n        scope('if(', STATE, '===', ATTRIB_STATE_POINTER, '){')\n        emitBuffer()\n        scope('}else{')\n        emitConstant()\n        scope('}')\n      }\n    }\n\n    attributes.forEach(function (attribute) {\n      var name = attribute.name\n      var arg = args.attributes[name]\n      var record\n      if (arg) {\n        if (!filter(arg)) {\n          return\n        }\n        record = arg.append(env, scope)\n      } else {\n        if (!filter(SCOPE_DECL)) {\n          return\n        }\n        var scopeAttrib = env.scopeAttrib(name)\n        \n        record = {}\n        Object.keys(new AttributeRecord()).forEach(function (key) {\n          record[key] = scope.def(scopeAttrib, '.', key)\n        })\n      }\n      emitBindAttribute(\n        env.link(attribute), typeLength(attribute.info.type), record)\n    })\n  }\n\n  function emitUniforms (env, scope, args, uniforms, filter, isBatchInnerLoop) {\n    var shared = env.shared\n    var GL = shared.gl\n\n    var infix\n    for (var i = 0; i < uniforms.length; ++i) {\n      var uniform = uniforms[i]\n      var name = uniform.name\n      var type = uniform.info.type\n      var arg = args.uniforms[name]\n      var UNIFORM = env.link(uniform)\n      var LOCATION = UNIFORM + '.location'\n\n      var VALUE\n      if (arg) {\n        if (!filter(arg)) {\n          continue\n        }\n        if (isStatic(arg)) {\n          var value = arg.value\n          \n          if (type === GL_SAMPLER_2D || type === GL_SAMPLER_CUBE) {\n            \n            var TEX_VALUE = env.link(value._texture || value.color[0]._texture)\n            scope(GL, '.uniform1i(', LOCATION, ',', TEX_VALUE + '.bind());')\n            scope.exit(TEX_VALUE, '.unbind();')\n          } else if (\n            type === GL_FLOAT_MAT2 ||\n            type === GL_FLOAT_MAT3 ||\n            type === GL_FLOAT_MAT4) {\n            \n            var MAT_VALUE = env.global.def('new Float32Array([' +\n              Array.prototype.slice.call(value) + '])')\n            var dim = 2\n            if (type === GL_FLOAT_MAT3) {\n              dim = 3\n            } else if (type === GL_FLOAT_MAT4) {\n              dim = 4\n            }\n            scope(\n              GL, '.uniformMatrix', dim, 'fv(',\n              LOCATION, ',false,', MAT_VALUE, ');')\n          } else {\n            switch (type) {\n              case GL_FLOAT$7:\n                \n                infix = '1f'\n                break\n              case GL_FLOAT_VEC2:\n                \n                infix = '2f'\n                break\n              case GL_FLOAT_VEC3:\n                \n                infix = '3f'\n                break\n              case GL_FLOAT_VEC4:\n                \n                infix = '4f'\n                break\n              case GL_BOOL:\n                \n                infix = '1i'\n                break\n              case GL_INT$2:\n                \n                infix = '1i'\n                break\n              case GL_BOOL_VEC2:\n                \n                infix = '2i'\n                break\n              case GL_INT_VEC2:\n                \n                infix = '2i'\n                break\n              case GL_BOOL_VEC3:\n                \n                infix = '3i'\n                break\n              case GL_INT_VEC3:\n                \n                infix = '3i'\n                break\n              case GL_BOOL_VEC4:\n                \n                infix = '4i'\n                break\n              case GL_INT_VEC4:\n                \n                infix = '4i'\n                break\n            }\n            scope(GL, '.uniform', infix, '(', LOCATION, ',',\n              isArrayLike(value) ? Array.prototype.slice.call(value) : value,\n              ');')\n          }\n          continue\n        } else {\n          VALUE = arg.append(env, scope)\n        }\n      } else {\n        if (!filter(SCOPE_DECL)) {\n          continue\n        }\n        VALUE = scope.def(shared.uniforms, '[', stringStore.id(name), ']')\n      }\n\n      if (type === GL_SAMPLER_2D) {\n        \n        scope(\n          'if(', VALUE, '&&', VALUE, '._reglType===\"framebuffer\"){',\n          VALUE, '=', VALUE, '.color[0];',\n          '}')\n      } else if (type === GL_SAMPLER_CUBE) {\n        \n        scope(\n          'if(', VALUE, '&&', VALUE, '._reglType===\"framebufferCube\"){',\n          VALUE, '=', VALUE, '.color[0];',\n          '}')\n      }\n\n      // perform type validation\n      \n\n      var unroll = 1\n      switch (type) {\n        case GL_SAMPLER_2D:\n        case GL_SAMPLER_CUBE:\n          var TEX = scope.def(VALUE, '._texture')\n          scope(GL, '.uniform1i(', LOCATION, ',', TEX, '.bind());')\n          scope.exit(TEX, '.unbind();')\n          continue\n\n        case GL_INT$2:\n        case GL_BOOL:\n          infix = '1i'\n          break\n\n        case GL_INT_VEC2:\n        case GL_BOOL_VEC2:\n          infix = '2i'\n          unroll = 2\n          break\n\n        case GL_INT_VEC3:\n        case GL_BOOL_VEC3:\n          infix = '3i'\n          unroll = 3\n          break\n\n        case GL_INT_VEC4:\n        case GL_BOOL_VEC4:\n          infix = '4i'\n          unroll = 4\n          break\n\n        case GL_FLOAT$7:\n          infix = '1f'\n          break\n\n        case GL_FLOAT_VEC2:\n          infix = '2f'\n          unroll = 2\n          break\n\n        case GL_FLOAT_VEC3:\n          infix = '3f'\n          unroll = 3\n          break\n\n        case GL_FLOAT_VEC4:\n          infix = '4f'\n          unroll = 4\n          break\n\n        case GL_FLOAT_MAT2:\n          infix = 'Matrix2fv'\n          break\n\n        case GL_FLOAT_MAT3:\n          infix = 'Matrix3fv'\n          break\n\n        case GL_FLOAT_MAT4:\n          infix = 'Matrix4fv'\n          break\n      }\n\n      if (infix.charAt(0) === 'M') {\n        scope(GL, '.uniform', infix, '(', LOCATION, ',')\n        var matSize = Math.pow(type - GL_FLOAT_MAT2 + 2, 2)\n        var STORAGE = env.global.def('new Float32Array(', matSize, ')')\n        if (Array.isArray(VALUE)) {\n          scope(\n            'false,(',\n            loop(matSize, function (i) {\n              return STORAGE + '[' + i + ']=' + VALUE[i]\n            }), ',', STORAGE, ')')\n        } else {\n          scope(\n            'false,(Array.isArray(', VALUE, ')||', VALUE, ' instanceof Float32Array)?', VALUE, ':(',\n            loop(matSize, function (i) {\n              return STORAGE + '[' + i + ']=' + VALUE + '[' + i + ']'\n            }), ',', STORAGE, ')')\n        }\n        scope(');')\n      } else if (unroll > 1) {\n        var prev = []\n        var cur = []\n        for (var j = 0; j < unroll; ++j) {\n          if (Array.isArray(VALUE)) {\n            cur.push(VALUE[j])\n          } else {\n            cur.push(scope.def(VALUE + '[' + j + ']'))\n          }\n          if (isBatchInnerLoop) {\n            prev.push(scope.def())\n          }\n        }\n        if (isBatchInnerLoop) {\n          scope('if(!', env.batchId, '||', prev.map(function (p, i) {\n            return p + '!==' + cur[i]\n          }).join('||'), '){', prev.map(function (p, i) {\n            return p + '=' + cur[i] + ';'\n          }).join(''))\n        }\n        scope(GL, '.uniform', infix, '(', LOCATION, ',', cur.join(','), ');')\n        if (isBatchInnerLoop) {\n          scope('}')\n        }\n      } else {\n        \n        if (isBatchInnerLoop) {\n          var prevS = scope.def()\n          scope('if(!', env.batchId, '||', prevS, '!==', VALUE, '){',\n            prevS, '=', VALUE, ';')\n        }\n        scope(GL, '.uniform', infix, '(', LOCATION, ',', VALUE, ');')\n        if (isBatchInnerLoop) {\n          scope('}')\n        }\n      }\n    }\n  }\n\n  function emitDraw (env, outer, inner, args) {\n    var shared = env.shared\n    var GL = shared.gl\n    var DRAW_STATE = shared.draw\n\n    var drawOptions = args.draw\n\n    function emitElements () {\n      var defn = drawOptions.elements\n      var ELEMENTS\n      var scope = outer\n      if (defn) {\n        if ((defn.contextDep && args.contextDynamic) || defn.propDep) {\n          scope = inner\n        }\n        if (drawOptions.vaoActive) {\n          ELEMENTS = defn.append(env, scope)\n        } else {\n          ELEMENTS = defn.append(env, scope)\n          scope(\n            'if(' + ELEMENTS + ')' +\n            GL + '.bindBuffer(' + GL_ELEMENT_ARRAY_BUFFER$2 + ',' + ELEMENTS + '.buffer.buffer);')\n        }\n      } else {\n        ELEMENTS = scope.def()\n        scope('if(', shared.vao, '.currentVAO){',\n          ELEMENTS, '=', env.shared.elements + '.getElements(' + shared.vao, '.currentVAO.elements);',\n          (!extVertexArrays ? 'if(' + ELEMENTS + ')' + GL + '.bindBuffer(' + GL_ELEMENT_ARRAY_BUFFER$2 + ',' + ELEMENTS + '.buffer.buffer);' : ''),\n          '}else{',\n          ELEMENTS, '=', DRAW_STATE, '.', S_ELEMENTS, ';',\n          'if(', ELEMENTS, '){',\n          GL, '.bindBuffer(', GL_ELEMENT_ARRAY_BUFFER$2, ',', ELEMENTS, '.buffer.buffer);}}')\n      }\n      return ELEMENTS\n    }\n\n    function emitCount () {\n      var defn = drawOptions.count\n      var COUNT\n      var scope = outer\n      if (defn) {\n        if ((defn.contextDep && args.contextDynamic) || defn.propDep) {\n          scope = inner\n        }\n        COUNT = defn.append(env, scope)\n        \n      } else {\n        COUNT = scope.def(DRAW_STATE, '.', S_COUNT)\n        \n      }\n      return COUNT\n    }\n\n    var ELEMENTS = emitElements()\n    function emitValue (name) {\n      var defn = drawOptions[name]\n      if (defn) {\n        if ((defn.contextDep && args.contextDynamic) || defn.propDep) {\n          return defn.append(env, inner)\n        } else {\n          return defn.append(env, outer)\n        }\n      } else {\n        return outer.def(DRAW_STATE, '.', name)\n      }\n    }\n\n    var PRIMITIVE = emitValue(S_PRIMITIVE)\n    var OFFSET = emitValue(S_OFFSET)\n\n    var COUNT = emitCount()\n    if (typeof COUNT === 'number') {\n      if (COUNT === 0) {\n        return\n      }\n    } else {\n      inner('if(', COUNT, '){')\n      inner.exit('}')\n    }\n\n    var INSTANCES, EXT_INSTANCING\n    if (extInstancing) {\n      INSTANCES = emitValue(S_INSTANCES)\n      EXT_INSTANCING = env.instancing\n    }\n\n    var ELEMENT_TYPE = ELEMENTS + '.type'\n\n    var elementsStatic = drawOptions.elements && isStatic(drawOptions.elements) && !drawOptions.vaoActive\n\n    function emitInstancing () {\n      function drawElements () {\n        inner(EXT_INSTANCING, '.drawElementsInstancedANGLE(', [\n          PRIMITIVE,\n          COUNT,\n          ELEMENT_TYPE,\n          OFFSET + '<<((' + ELEMENT_TYPE + '-' + GL_UNSIGNED_BYTE$7 + ')>>1)',\n          INSTANCES\n        ], ');')\n      }\n\n      function drawArrays () {\n        inner(EXT_INSTANCING, '.drawArraysInstancedANGLE(',\n          [PRIMITIVE, OFFSET, COUNT, INSTANCES], ');')\n      }\n\n      if (ELEMENTS && ELEMENTS !== 'null') {\n        if (!elementsStatic) {\n          inner('if(', ELEMENTS, '){')\n          drawElements()\n          inner('}else{')\n          drawArrays()\n          inner('}')\n        } else {\n          drawElements()\n        }\n      } else {\n        drawArrays()\n      }\n    }\n\n    function emitRegular () {\n      function drawElements () {\n        inner(GL + '.drawElements(' + [\n          PRIMITIVE,\n          COUNT,\n          ELEMENT_TYPE,\n          OFFSET + '<<((' + ELEMENT_TYPE + '-' + GL_UNSIGNED_BYTE$7 + ')>>1)'\n        ] + ');')\n      }\n\n      function drawArrays () {\n        inner(GL + '.drawArrays(' + [PRIMITIVE, OFFSET, COUNT] + ');')\n      }\n\n      if (ELEMENTS && ELEMENTS !== 'null') {\n        if (!elementsStatic) {\n          inner('if(', ELEMENTS, '){')\n          drawElements()\n          inner('}else{')\n          drawArrays()\n          inner('}')\n        } else {\n          drawElements()\n        }\n      } else {\n        drawArrays()\n      }\n    }\n\n    if (extInstancing && (typeof INSTANCES !== 'number' || INSTANCES >= 0)) {\n      if (typeof INSTANCES === 'string') {\n        inner('if(', INSTANCES, '>0){')\n        emitInstancing()\n        inner('}else if(', INSTANCES, '<0){')\n        emitRegular()\n        inner('}')\n      } else {\n        emitInstancing()\n      }\n    } else {\n      emitRegular()\n    }\n  }\n\n  function createBody (emitBody, parentEnv, args, program, count) {\n    var env = createREGLEnvironment()\n    var scope = env.proc('body', count)\n    \n    if (extInstancing) {\n      env.instancing = scope.def(\n        env.shared.extensions, '.angle_instanced_arrays')\n    }\n    emitBody(env, scope, args, program)\n    return env.compile().body\n  }\n\n  // ===================================================\n  // ===================================================\n  // DRAW PROC\n  // ===================================================\n  // ===================================================\n  function emitDrawBody (env, draw, args, program) {\n    injectExtensions(env, draw)\n    if (args.useVAO) {\n      if (args.drawVAO) {\n        draw(env.shared.vao, '.setVAO(', args.drawVAO.append(env, draw), ');')\n      } else {\n        draw(env.shared.vao, '.setVAO(', env.shared.vao, '.targetVAO);')\n      }\n    } else {\n      draw(env.shared.vao, '.setVAO(null);')\n      emitAttributes(env, draw, args, program.attributes, function () {\n        return true\n      })\n    }\n    emitUniforms(env, draw, args, program.uniforms, function () {\n      return true\n    }, false)\n    emitDraw(env, draw, draw, args)\n  }\n\n  function emitDrawProc (env, args) {\n    var draw = env.proc('draw', 1)\n\n    injectExtensions(env, draw)\n\n    emitContext(env, draw, args.context)\n    emitPollFramebuffer(env, draw, args.framebuffer)\n\n    emitPollState(env, draw, args)\n    emitSetOptions(env, draw, args.state)\n\n    emitProfile(env, draw, args, false, true)\n\n    var program = args.shader.progVar.append(env, draw)\n    draw(env.shared.gl, '.useProgram(', program, '.program);')\n\n    if (args.shader.program) {\n      emitDrawBody(env, draw, args, args.shader.program)\n    } else {\n      draw(env.shared.vao, '.setVAO(null);')\n      var drawCache = env.global.def('{}')\n      var PROG_ID = draw.def(program, '.id')\n      var CACHED_PROC = draw.def(drawCache, '[', PROG_ID, ']')\n      draw(\n        env.cond(CACHED_PROC)\n          .then(CACHED_PROC, '.call(this,a0);')\n          .else(\n            CACHED_PROC, '=', drawCache, '[', PROG_ID, ']=',\n            env.link(function (program) {\n              return createBody(emitDrawBody, env, args, program, 1)\n            }), '(', program, ');',\n            CACHED_PROC, '.call(this,a0);'))\n    }\n\n    if (Object.keys(args.state).length > 0) {\n      draw(env.shared.current, '.dirty=true;')\n    }\n  }\n\n  // ===================================================\n  // ===================================================\n  // BATCH PROC\n  // ===================================================\n  // ===================================================\n\n  function emitBatchDynamicShaderBody (env, scope, args, program) {\n    env.batchId = 'a1'\n\n    injectExtensions(env, scope)\n\n    function all () {\n      return true\n    }\n\n    emitAttributes(env, scope, args, program.attributes, all)\n    emitUniforms(env, scope, args, program.uniforms, all, false)\n    emitDraw(env, scope, scope, args)\n  }\n\n  function emitBatchBody (env, scope, args, program) {\n    injectExtensions(env, scope)\n\n    var contextDynamic = args.contextDep\n\n    var BATCH_ID = scope.def()\n    var PROP_LIST = 'a0'\n    var NUM_PROPS = 'a1'\n    var PROPS = scope.def()\n    env.shared.props = PROPS\n    env.batchId = BATCH_ID\n\n    var outer = env.scope()\n    var inner = env.scope()\n\n    scope(\n      outer.entry,\n      'for(', BATCH_ID, '=0;', BATCH_ID, '<', NUM_PROPS, ';++', BATCH_ID, '){',\n      PROPS, '=', PROP_LIST, '[', BATCH_ID, '];',\n      inner,\n      '}',\n      outer.exit)\n\n    function isInnerDefn (defn) {\n      return ((defn.contextDep && contextDynamic) || defn.propDep)\n    }\n\n    function isOuterDefn (defn) {\n      return !isInnerDefn(defn)\n    }\n\n    if (args.needsContext) {\n      emitContext(env, inner, args.context)\n    }\n    if (args.needsFramebuffer) {\n      emitPollFramebuffer(env, inner, args.framebuffer)\n    }\n    emitSetOptions(env, inner, args.state, isInnerDefn)\n\n    if (args.profile && isInnerDefn(args.profile)) {\n      emitProfile(env, inner, args, false, true)\n    }\n\n    if (!program) {\n      var progCache = env.global.def('{}')\n      var PROGRAM = args.shader.progVar.append(env, inner)\n      var PROG_ID = inner.def(PROGRAM, '.id')\n      var CACHED_PROC = inner.def(progCache, '[', PROG_ID, ']')\n      inner(\n        env.shared.gl, '.useProgram(', PROGRAM, '.program);',\n        'if(!', CACHED_PROC, '){',\n        CACHED_PROC, '=', progCache, '[', PROG_ID, ']=',\n        env.link(function (program) {\n          return createBody(\n            emitBatchDynamicShaderBody, env, args, program, 2)\n        }), '(', PROGRAM, ');}',\n        CACHED_PROC, '.call(this,a0[', BATCH_ID, '],', BATCH_ID, ');')\n    } else {\n      if (args.useVAO) {\n        if (args.drawVAO) {\n          if (isInnerDefn(args.drawVAO)) {\n            // vao is a prop\n            inner(env.shared.vao, '.setVAO(', args.drawVAO.append(env, inner), ');')\n          } else {\n            // vao is invariant\n            outer(env.shared.vao, '.setVAO(', args.drawVAO.append(env, outer), ');')\n          }\n        } else {\n          // scoped vao binding\n          outer(env.shared.vao, '.setVAO(', env.shared.vao, '.targetVAO);')\n        }\n      } else {\n        outer(env.shared.vao, '.setVAO(null);')\n        emitAttributes(env, outer, args, program.attributes, isOuterDefn)\n        emitAttributes(env, inner, args, program.attributes, isInnerDefn)\n      }\n      emitUniforms(env, outer, args, program.uniforms, isOuterDefn, false)\n      emitUniforms(env, inner, args, program.uniforms, isInnerDefn, true)\n      emitDraw(env, outer, inner, args)\n    }\n  }\n\n  function emitBatchProc (env, args) {\n    var batch = env.proc('batch', 2)\n    env.batchId = '0'\n\n    injectExtensions(env, batch)\n\n    // Check if any context variables depend on props\n    var contextDynamic = false\n    var needsContext = true\n    Object.keys(args.context).forEach(function (name) {\n      contextDynamic = contextDynamic || args.context[name].propDep\n    })\n    if (!contextDynamic) {\n      emitContext(env, batch, args.context)\n      needsContext = false\n    }\n\n    // framebuffer state affects framebufferWidth/height context vars\n    var framebuffer = args.framebuffer\n    var needsFramebuffer = false\n    if (framebuffer) {\n      if (framebuffer.propDep) {\n        contextDynamic = needsFramebuffer = true\n      } else if (framebuffer.contextDep && contextDynamic) {\n        needsFramebuffer = true\n      }\n      if (!needsFramebuffer) {\n        emitPollFramebuffer(env, batch, framebuffer)\n      }\n    } else {\n      emitPollFramebuffer(env, batch, null)\n    }\n\n    // viewport is weird because it can affect context vars\n    if (args.state.viewport && args.state.viewport.propDep) {\n      contextDynamic = true\n    }\n\n    function isInnerDefn (defn) {\n      return (defn.contextDep && contextDynamic) || defn.propDep\n    }\n\n    // set webgl options\n    emitPollState(env, batch, args)\n    emitSetOptions(env, batch, args.state, function (defn) {\n      return !isInnerDefn(defn)\n    })\n\n    if (!args.profile || !isInnerDefn(args.profile)) {\n      emitProfile(env, batch, args, false, 'a1')\n    }\n\n    // Save these values to args so that the batch body routine can use them\n    args.contextDep = contextDynamic\n    args.needsContext = needsContext\n    args.needsFramebuffer = needsFramebuffer\n\n    // determine if shader is dynamic\n    var progDefn = args.shader.progVar\n    if ((progDefn.contextDep && contextDynamic) || progDefn.propDep) {\n      emitBatchBody(\n        env,\n        batch,\n        args,\n        null)\n    } else {\n      var PROGRAM = progDefn.append(env, batch)\n      batch(env.shared.gl, '.useProgram(', PROGRAM, '.program);')\n      if (args.shader.program) {\n        emitBatchBody(\n          env,\n          batch,\n          args,\n          args.shader.program)\n      } else {\n        batch(env.shared.vao, '.setVAO(null);')\n        var batchCache = env.global.def('{}')\n        var PROG_ID = batch.def(PROGRAM, '.id')\n        var CACHED_PROC = batch.def(batchCache, '[', PROG_ID, ']')\n        batch(\n          env.cond(CACHED_PROC)\n            .then(CACHED_PROC, '.call(this,a0,a1);')\n            .else(\n              CACHED_PROC, '=', batchCache, '[', PROG_ID, ']=',\n              env.link(function (program) {\n                return createBody(emitBatchBody, env, args, program, 2)\n              }), '(', PROGRAM, ');',\n              CACHED_PROC, '.call(this,a0,a1);'))\n      }\n    }\n\n    if (Object.keys(args.state).length > 0) {\n      batch(env.shared.current, '.dirty=true;')\n    }\n  }\n\n  // ===================================================\n  // ===================================================\n  // SCOPE COMMAND\n  // ===================================================\n  // ===================================================\n  function emitScopeProc (env, args) {\n    var scope = env.proc('scope', 3)\n    env.batchId = 'a2'\n\n    var shared = env.shared\n    var CURRENT_STATE = shared.current\n\n    emitContext(env, scope, args.context)\n\n    if (args.framebuffer) {\n      args.framebuffer.append(env, scope)\n    }\n\n    sortState(Object.keys(args.state)).forEach(function (name) {\n      var defn = args.state[name]\n      var value = defn.append(env, scope)\n      if (isArrayLike(value)) {\n        value.forEach(function (v, i) {\n          scope.set(env.next[name], '[' + i + ']', v)\n        })\n      } else {\n        scope.set(shared.next, '.' + name, value)\n      }\n    })\n\n    emitProfile(env, scope, args, true, true)\n\n    ;[S_ELEMENTS, S_OFFSET, S_COUNT, S_INSTANCES, S_PRIMITIVE].forEach(\n      function (opt) {\n        var variable = args.draw[opt]\n        if (!variable) {\n          return\n        }\n        scope.set(shared.draw, '.' + opt, '' + variable.append(env, scope))\n      })\n\n    Object.keys(args.uniforms).forEach(function (opt) {\n      var value = args.uniforms[opt].append(env, scope)\n      if (Array.isArray(value)) {\n        value = '[' + value.join() + ']'\n      }\n      scope.set(\n        shared.uniforms,\n        '[' + stringStore.id(opt) + ']',\n        value)\n    })\n\n    Object.keys(args.attributes).forEach(function (name) {\n      var record = args.attributes[name].append(env, scope)\n      var scopeAttrib = env.scopeAttrib(name)\n      Object.keys(new AttributeRecord()).forEach(function (prop) {\n        scope.set(scopeAttrib, '.' + prop, record[prop])\n      })\n    })\n\n    if (args.scopeVAO) {\n      scope.set(shared.vao, '.targetVAO', args.scopeVAO.append(env, scope))\n    }\n\n    function saveShader (name) {\n      var shader = args.shader[name]\n      if (shader) {\n        scope.set(shared.shader, '.' + name, shader.append(env, scope))\n      }\n    }\n    saveShader(S_VERT)\n    saveShader(S_FRAG)\n\n    if (Object.keys(args.state).length > 0) {\n      scope(CURRENT_STATE, '.dirty=true;')\n      scope.exit(CURRENT_STATE, '.dirty=true;')\n    }\n\n    scope('a1(', env.shared.context, ',a0,', env.batchId, ');')\n  }\n\n  function isDynamicObject (object) {\n    if (typeof object !== 'object' || isArrayLike(object)) {\n      return\n    }\n    var props = Object.keys(object)\n    for (var i = 0; i < props.length; ++i) {\n      if (dynamic.isDynamic(object[props[i]])) {\n        return true\n      }\n    }\n    return false\n  }\n\n  function splatObject (env, options, name) {\n    var object = options.static[name]\n    if (!object || !isDynamicObject(object)) {\n      return\n    }\n\n    var globals = env.global\n    var keys = Object.keys(object)\n    var thisDep = false\n    var contextDep = false\n    var propDep = false\n    var objectRef = env.global.def('{}')\n    keys.forEach(function (key) {\n      var value = object[key]\n      if (dynamic.isDynamic(value)) {\n        if (typeof value === 'function') {\n          value = object[key] = dynamic.unbox(value)\n        }\n        var deps = createDynamicDecl(value, null)\n        thisDep = thisDep || deps.thisDep\n        propDep = propDep || deps.propDep\n        contextDep = contextDep || deps.contextDep\n      } else {\n        globals(objectRef, '.', key, '=')\n        switch (typeof value) {\n          case 'number':\n            globals(value)\n            break\n          case 'string':\n            globals('\"', value, '\"')\n            break\n          case 'object':\n            if (Array.isArray(value)) {\n              globals('[', value.join(), ']')\n            }\n            break\n          default:\n            globals(env.link(value))\n            break\n        }\n        globals(';')\n      }\n    })\n\n    function appendBlock (env, block) {\n      keys.forEach(function (key) {\n        var value = object[key]\n        if (!dynamic.isDynamic(value)) {\n          return\n        }\n        var ref = env.invoke(block, value)\n        block(objectRef, '.', key, '=', ref, ';')\n      })\n    }\n\n    options.dynamic[name] = new dynamic.DynamicVariable(DYN_THUNK, {\n      thisDep: thisDep,\n      contextDep: contextDep,\n      propDep: propDep,\n      ref: objectRef,\n      append: appendBlock\n    })\n    delete options.static[name]\n  }\n\n  // ===========================================================================\n  // ===========================================================================\n  // MAIN DRAW COMMAND\n  // ===========================================================================\n  // ===========================================================================\n  function compileCommand (options, attributes, uniforms, context, stats) {\n    var env = createREGLEnvironment()\n\n    // link stats, so that we can easily access it in the program.\n    env.stats = env.link(stats)\n\n    // splat options and attributes to allow for dynamic nested properties\n    Object.keys(attributes.static).forEach(function (key) {\n      splatObject(env, attributes, key)\n    })\n    NESTED_OPTIONS.forEach(function (name) {\n      splatObject(env, options, name)\n    })\n\n    var args = parseArguments(options, attributes, uniforms, context, env)\n\n    emitDrawProc(env, args)\n    emitScopeProc(env, args)\n    emitBatchProc(env, args)\n\n    return extend(env.compile(), {\n      destroy: function () {\n        args.shader.program.destroy()\n      }\n    })\n  }\n\n  // ===========================================================================\n  // ===========================================================================\n  // POLL / REFRESH\n  // ===========================================================================\n  // ===========================================================================\n  return {\n    next: nextState,\n    current: currentState,\n    procs: (function () {\n      var env = createREGLEnvironment()\n      var poll = env.proc('poll')\n      var refresh = env.proc('refresh')\n      var common = env.block()\n      poll(common)\n      refresh(common)\n\n      var shared = env.shared\n      var GL = shared.gl\n      var NEXT_STATE = shared.next\n      var CURRENT_STATE = shared.current\n\n      common(CURRENT_STATE, '.dirty=false;')\n\n      emitPollFramebuffer(env, poll)\n      emitPollFramebuffer(env, refresh, null, true)\n\n      // Refresh updates all attribute state changes\n      var INSTANCING\n      if (extInstancing) {\n        INSTANCING = env.link(extInstancing)\n      }\n\n      // update vertex array bindings\n      if (extensions.oes_vertex_array_object) {\n        refresh(env.link(extensions.oes_vertex_array_object), '.bindVertexArrayOES(null);')\n      }\n      for (var i = 0; i < limits.maxAttributes; ++i) {\n        var BINDING = refresh.def(shared.attributes, '[', i, ']')\n        var ifte = env.cond(BINDING, '.buffer')\n        ifte.then(\n          GL, '.enableVertexAttribArray(', i, ');',\n          GL, '.bindBuffer(',\n          GL_ARRAY_BUFFER$2, ',',\n          BINDING, '.buffer.buffer);',\n          GL, '.vertexAttribPointer(',\n          i, ',',\n          BINDING, '.size,',\n          BINDING, '.type,',\n          BINDING, '.normalized,',\n          BINDING, '.stride,',\n          BINDING, '.offset);'\n        ).else(\n          GL, '.disableVertexAttribArray(', i, ');',\n          GL, '.vertexAttrib4f(',\n          i, ',',\n          BINDING, '.x,',\n          BINDING, '.y,',\n          BINDING, '.z,',\n          BINDING, '.w);',\n          BINDING, '.buffer=null;')\n        refresh(ifte)\n        if (extInstancing) {\n          refresh(\n            INSTANCING, '.vertexAttribDivisorANGLE(',\n            i, ',',\n            BINDING, '.divisor);')\n        }\n      }\n      refresh(\n        env.shared.vao, '.currentVAO=null;',\n        env.shared.vao, '.setVAO(', env.shared.vao, '.targetVAO);')\n\n      Object.keys(GL_FLAGS).forEach(function (flag) {\n        var cap = GL_FLAGS[flag]\n        var NEXT = common.def(NEXT_STATE, '.', flag)\n        var block = env.block()\n        block('if(', NEXT, '){',\n          GL, '.enable(', cap, ')}else{',\n          GL, '.disable(', cap, ')}',\n          CURRENT_STATE, '.', flag, '=', NEXT, ';')\n        refresh(block)\n        poll(\n          'if(', NEXT, '!==', CURRENT_STATE, '.', flag, '){',\n          block,\n          '}')\n      })\n\n      Object.keys(GL_VARIABLES).forEach(function (name) {\n        var func = GL_VARIABLES[name]\n        var init = currentState[name]\n        var NEXT, CURRENT\n        var block = env.block()\n        block(GL, '.', func, '(')\n        if (isArrayLike(init)) {\n          var n = init.length\n          NEXT = env.global.def(NEXT_STATE, '.', name)\n          CURRENT = env.global.def(CURRENT_STATE, '.', name)\n          block(\n            loop(n, function (i) {\n              return NEXT + '[' + i + ']'\n            }), ');',\n            loop(n, function (i) {\n              return CURRENT + '[' + i + ']=' + NEXT + '[' + i + '];'\n            }).join(''))\n          poll(\n            'if(', loop(n, function (i) {\n              return NEXT + '[' + i + ']!==' + CURRENT + '[' + i + ']'\n            }).join('||'), '){',\n            block,\n            '}')\n        } else {\n          NEXT = common.def(NEXT_STATE, '.', name)\n          CURRENT = common.def(CURRENT_STATE, '.', name)\n          block(\n            NEXT, ');',\n            CURRENT_STATE, '.', name, '=', NEXT, ';')\n          poll(\n            'if(', NEXT, '!==', CURRENT, '){',\n            block,\n            '}')\n        }\n        refresh(block)\n      })\n\n      return env.compile()\n    })(),\n    compile: compileCommand\n  }\n}\n\nfunction stats () {\n  return {\n    vaoCount: 0,\n    bufferCount: 0,\n    elementsCount: 0,\n    framebufferCount: 0,\n    shaderCount: 0,\n    textureCount: 0,\n    cubeCount: 0,\n    renderbufferCount: 0,\n    maxTextureUnits: 0\n  }\n}\n\nvar GL_QUERY_RESULT_EXT = 0x8866\nvar GL_QUERY_RESULT_AVAILABLE_EXT = 0x8867\nvar GL_TIME_ELAPSED_EXT = 0x88BF\n\nvar createTimer = function (gl, extensions) {\n  if (!extensions.ext_disjoint_timer_query) {\n    return null\n  }\n\n  // QUERY POOL BEGIN\n  var queryPool = []\n  function allocQuery () {\n    return queryPool.pop() || extensions.ext_disjoint_timer_query.createQueryEXT()\n  }\n  function freeQuery (query) {\n    queryPool.push(query)\n  }\n  // QUERY POOL END\n\n  var pendingQueries = []\n  function beginQuery (stats) {\n    var query = allocQuery()\n    extensions.ext_disjoint_timer_query.beginQueryEXT(GL_TIME_ELAPSED_EXT, query)\n    pendingQueries.push(query)\n    pushScopeStats(pendingQueries.length - 1, pendingQueries.length, stats)\n  }\n\n  function endQuery () {\n    extensions.ext_disjoint_timer_query.endQueryEXT(GL_TIME_ELAPSED_EXT)\n  }\n\n  //\n  // Pending stats pool.\n  //\n  function PendingStats () {\n    this.startQueryIndex = -1\n    this.endQueryIndex = -1\n    this.sum = 0\n    this.stats = null\n  }\n  var pendingStatsPool = []\n  function allocPendingStats () {\n    return pendingStatsPool.pop() || new PendingStats()\n  }\n  function freePendingStats (pendingStats) {\n    pendingStatsPool.push(pendingStats)\n  }\n  // Pending stats pool end\n\n  var pendingStats = []\n  function pushScopeStats (start, end, stats) {\n    var ps = allocPendingStats()\n    ps.startQueryIndex = start\n    ps.endQueryIndex = end\n    ps.sum = 0\n    ps.stats = stats\n    pendingStats.push(ps)\n  }\n\n  // we should call this at the beginning of the frame,\n  // in order to update gpuTime\n  var timeSum = []\n  var queryPtr = []\n  function update () {\n    var ptr, i\n\n    var n = pendingQueries.length\n    if (n === 0) {\n      return\n    }\n\n    // Reserve space\n    queryPtr.length = Math.max(queryPtr.length, n + 1)\n    timeSum.length = Math.max(timeSum.length, n + 1)\n    timeSum[0] = 0\n    queryPtr[0] = 0\n\n    // Update all pending timer queries\n    var queryTime = 0\n    ptr = 0\n    for (i = 0; i < pendingQueries.length; ++i) {\n      var query = pendingQueries[i]\n      if (extensions.ext_disjoint_timer_query.getQueryObjectEXT(query, GL_QUERY_RESULT_AVAILABLE_EXT)) {\n        queryTime += extensions.ext_disjoint_timer_query.getQueryObjectEXT(query, GL_QUERY_RESULT_EXT)\n        freeQuery(query)\n      } else {\n        pendingQueries[ptr++] = query\n      }\n      timeSum[i + 1] = queryTime\n      queryPtr[i + 1] = ptr\n    }\n    pendingQueries.length = ptr\n\n    // Update all pending stat queries\n    ptr = 0\n    for (i = 0; i < pendingStats.length; ++i) {\n      var stats = pendingStats[i]\n      var start = stats.startQueryIndex\n      var end = stats.endQueryIndex\n      stats.sum += timeSum[end] - timeSum[start]\n      var startPtr = queryPtr[start]\n      var endPtr = queryPtr[end]\n      if (endPtr === startPtr) {\n        stats.stats.gpuTime += stats.sum / 1e6\n        freePendingStats(stats)\n      } else {\n        stats.startQueryIndex = startPtr\n        stats.endQueryIndex = endPtr\n        pendingStats[ptr++] = stats\n      }\n    }\n    pendingStats.length = ptr\n  }\n\n  return {\n    beginQuery: beginQuery,\n    endQuery: endQuery,\n    pushScopeStats: pushScopeStats,\n    update: update,\n    getNumPendingQueries: function () {\n      return pendingQueries.length\n    },\n    clear: function () {\n      queryPool.push.apply(queryPool, pendingQueries)\n      for (var i = 0; i < queryPool.length; i++) {\n        extensions.ext_disjoint_timer_query.deleteQueryEXT(queryPool[i])\n      }\n      pendingQueries.length = 0\n      queryPool.length = 0\n    },\n    restore: function () {\n      pendingQueries.length = 0\n      queryPool.length = 0\n    }\n  }\n}\n\nvar GL_COLOR_BUFFER_BIT = 16384\nvar GL_DEPTH_BUFFER_BIT = 256\nvar GL_STENCIL_BUFFER_BIT = 1024\n\nvar GL_ARRAY_BUFFER = 34962\n\nvar CONTEXT_LOST_EVENT = 'webglcontextlost'\nvar CONTEXT_RESTORED_EVENT = 'webglcontextrestored'\n\nvar DYN_PROP = 1\nvar DYN_CONTEXT = 2\nvar DYN_STATE = 3\n\nfunction find (haystack, needle) {\n  for (var i = 0; i < haystack.length; ++i) {\n    if (haystack[i] === needle) {\n      return i\n    }\n  }\n  return -1\n}\n\nfunction wrapREGL (args) {\n  var config = parseArgs(args)\n  if (!config) {\n    return null\n  }\n\n  var gl = config.gl\n  var glAttributes = gl.getContextAttributes()\n  var contextLost = gl.isContextLost()\n\n  var extensionState = createExtensionCache(gl, config)\n  if (!extensionState) {\n    return null\n  }\n\n  var stringStore = createStringStore()\n  var stats$$1 = stats()\n  var extensions = extensionState.extensions\n  var timer = createTimer(gl, extensions)\n\n  var START_TIME = clock()\n  var WIDTH = gl.drawingBufferWidth\n  var HEIGHT = gl.drawingBufferHeight\n\n  var contextState = {\n    tick: 0,\n    time: 0,\n    viewportWidth: WIDTH,\n    viewportHeight: HEIGHT,\n    framebufferWidth: WIDTH,\n    framebufferHeight: HEIGHT,\n    drawingBufferWidth: WIDTH,\n    drawingBufferHeight: HEIGHT,\n    pixelRatio: config.pixelRatio\n  }\n  var uniformState = {}\n  var drawState = {\n    elements: null,\n    primitive: 4, // GL_TRIANGLES\n    count: -1,\n    offset: 0,\n    instances: -1\n  }\n\n  var limits = wrapLimits(gl, extensions)\n  var bufferState = wrapBufferState(\n    gl,\n    stats$$1,\n    config,\n    destroyBuffer)\n  var elementState = wrapElementsState(gl, extensions, bufferState, stats$$1)\n  var attributeState = wrapAttributeState(\n    gl,\n    extensions,\n    limits,\n    stats$$1,\n    bufferState,\n    elementState,\n    drawState)\n  function destroyBuffer (buffer) {\n    return attributeState.destroyBuffer(buffer)\n  }\n  var shaderState = wrapShaderState(gl, stringStore, stats$$1, config)\n  var textureState = createTextureSet(\n    gl,\n    extensions,\n    limits,\n    function () { core.procs.poll() },\n    contextState,\n    stats$$1,\n    config)\n  var renderbufferState = wrapRenderbuffers(gl, extensions, limits, stats$$1, config)\n  var framebufferState = wrapFBOState(\n    gl,\n    extensions,\n    limits,\n    textureState,\n    renderbufferState,\n    stats$$1)\n  var core = reglCore(\n    gl,\n    stringStore,\n    extensions,\n    limits,\n    bufferState,\n    elementState,\n    textureState,\n    framebufferState,\n    uniformState,\n    attributeState,\n    shaderState,\n    drawState,\n    contextState,\n    timer,\n    config)\n  var readPixels = wrapReadPixels(\n    gl,\n    framebufferState,\n    core.procs.poll,\n    contextState,\n    glAttributes, extensions, limits)\n\n  var nextState = core.next\n  var canvas = gl.canvas\n\n  var rafCallbacks = []\n  var lossCallbacks = []\n  var restoreCallbacks = []\n  var destroyCallbacks = [config.onDestroy]\n\n  var activeRAF = null\n  function handleRAF () {\n    if (rafCallbacks.length === 0) {\n      if (timer) {\n        timer.update()\n      }\n      activeRAF = null\n      return\n    }\n\n    // schedule next animation frame\n    activeRAF = raf.next(handleRAF)\n\n    // poll for changes\n    poll()\n\n    // fire a callback for all pending rafs\n    for (var i = rafCallbacks.length - 1; i >= 0; --i) {\n      var cb = rafCallbacks[i]\n      if (cb) {\n        cb(contextState, null, 0)\n      }\n    }\n\n    // flush all pending webgl calls\n    gl.flush()\n\n    // poll GPU timers *after* gl.flush so we don't delay command dispatch\n    if (timer) {\n      timer.update()\n    }\n  }\n\n  function startRAF () {\n    if (!activeRAF && rafCallbacks.length > 0) {\n      activeRAF = raf.next(handleRAF)\n    }\n  }\n\n  function stopRAF () {\n    if (activeRAF) {\n      raf.cancel(handleRAF)\n      activeRAF = null\n    }\n  }\n\n  function handleContextLoss (event) {\n    event.preventDefault()\n\n    // set context lost flag\n    contextLost = true\n\n    // pause request animation frame\n    stopRAF()\n\n    // lose context\n    lossCallbacks.forEach(function (cb) {\n      cb()\n    })\n  }\n\n  function handleContextRestored (event) {\n    // clear error code\n    gl.getError()\n\n    // clear context lost flag\n    contextLost = false\n\n    // refresh state\n    extensionState.restore()\n    shaderState.restore()\n    bufferState.restore()\n    textureState.restore()\n    renderbufferState.restore()\n    framebufferState.restore()\n    attributeState.restore()\n    if (timer) {\n      timer.restore()\n    }\n\n    // refresh state\n    core.procs.refresh()\n\n    // restart RAF\n    startRAF()\n\n    // restore context\n    restoreCallbacks.forEach(function (cb) {\n      cb()\n    })\n  }\n\n  if (canvas) {\n    canvas.addEventListener(CONTEXT_LOST_EVENT, handleContextLoss, false)\n    canvas.addEventListener(CONTEXT_RESTORED_EVENT, handleContextRestored, false)\n  }\n\n  function destroy () {\n    rafCallbacks.length = 0\n    stopRAF()\n\n    if (canvas) {\n      canvas.removeEventListener(CONTEXT_LOST_EVENT, handleContextLoss)\n      canvas.removeEventListener(CONTEXT_RESTORED_EVENT, handleContextRestored)\n    }\n\n    shaderState.clear()\n    framebufferState.clear()\n    renderbufferState.clear()\n    attributeState.clear()\n    textureState.clear()\n    elementState.clear()\n    bufferState.clear()\n\n    if (timer) {\n      timer.clear()\n    }\n\n    destroyCallbacks.forEach(function (cb) {\n      cb()\n    })\n  }\n\n  function compileProcedure (options) {\n    \n    \n\n    function flattenNestedOptions (options) {\n      var result = extend({}, options)\n      delete result.uniforms\n      delete result.attributes\n      delete result.context\n      delete result.vao\n\n      if ('stencil' in result && result.stencil.op) {\n        result.stencil.opBack = result.stencil.opFront = result.stencil.op\n        delete result.stencil.op\n      }\n\n      function merge (name) {\n        if (name in result) {\n          var child = result[name]\n          delete result[name]\n          Object.keys(child).forEach(function (prop) {\n            result[name + '.' + prop] = child[prop]\n          })\n        }\n      }\n      merge('blend')\n      merge('depth')\n      merge('cull')\n      merge('stencil')\n      merge('polygonOffset')\n      merge('scissor')\n      merge('sample')\n\n      if ('vao' in options) {\n        result.vao = options.vao\n      }\n\n      return result\n    }\n\n    function separateDynamic (object, useArrays) {\n      var staticItems = {}\n      var dynamicItems = {}\n      Object.keys(object).forEach(function (option) {\n        var value = object[option]\n        if (dynamic.isDynamic(value)) {\n          dynamicItems[option] = dynamic.unbox(value, option)\n          return\n        } else if (useArrays && Array.isArray(value)) {\n          for (var i = 0; i < value.length; ++i) {\n            if (dynamic.isDynamic(value[i])) {\n              dynamicItems[option] = dynamic.unbox(value, option)\n              return\n            }\n          }\n        }\n        staticItems[option] = value\n      })\n      return {\n        dynamic: dynamicItems,\n        static: staticItems\n      }\n    }\n\n    // Treat context variables separate from other dynamic variables\n    var context = separateDynamic(options.context || {}, true)\n    var uniforms = separateDynamic(options.uniforms || {}, true)\n    var attributes = separateDynamic(options.attributes || {}, false)\n    var opts = separateDynamic(flattenNestedOptions(options), false)\n\n    var stats$$1 = {\n      gpuTime: 0.0,\n      cpuTime: 0.0,\n      count: 0\n    }\n\n    var compiled = core.compile(opts, attributes, uniforms, context, stats$$1)\n\n    var draw = compiled.draw\n    var batch = compiled.batch\n    var scope = compiled.scope\n\n    // FIXME: we should modify code generation for batch commands so this\n    // isn't necessary\n    var EMPTY_ARRAY = []\n    function reserve (count) {\n      while (EMPTY_ARRAY.length < count) {\n        EMPTY_ARRAY.push(null)\n      }\n      return EMPTY_ARRAY\n    }\n\n    function REGLCommand (args, body) {\n      var i\n      if (contextLost) {\n        \n      }\n      if (typeof args === 'function') {\n        return scope.call(this, null, args, 0)\n      } else if (typeof body === 'function') {\n        if (typeof args === 'number') {\n          for (i = 0; i < args; ++i) {\n            scope.call(this, null, body, i)\n          }\n        } else if (Array.isArray(args)) {\n          for (i = 0; i < args.length; ++i) {\n            scope.call(this, args[i], body, i)\n          }\n        } else {\n          return scope.call(this, args, body, 0)\n        }\n      } else if (typeof args === 'number') {\n        if (args > 0) {\n          return batch.call(this, reserve(args | 0), args | 0)\n        }\n      } else if (Array.isArray(args)) {\n        if (args.length) {\n          return batch.call(this, args, args.length)\n        }\n      } else {\n        return draw.call(this, args)\n      }\n    }\n\n    return extend(REGLCommand, {\n      stats: stats$$1,\n      destroy: function () {\n        compiled.destroy()\n      }\n    })\n  }\n\n  var setFBO = framebufferState.setFBO = compileProcedure({\n    framebuffer: dynamic.define.call(null, DYN_PROP, 'framebuffer')\n  })\n\n  function clearImpl (_, options) {\n    var clearFlags = 0\n    core.procs.poll()\n\n    var c = options.color\n    if (c) {\n      gl.clearColor(+c[0] || 0, +c[1] || 0, +c[2] || 0, +c[3] || 0)\n      clearFlags |= GL_COLOR_BUFFER_BIT\n    }\n    if ('depth' in options) {\n      gl.clearDepth(+options.depth)\n      clearFlags |= GL_DEPTH_BUFFER_BIT\n    }\n    if ('stencil' in options) {\n      gl.clearStencil(options.stencil | 0)\n      clearFlags |= GL_STENCIL_BUFFER_BIT\n    }\n\n    \n    gl.clear(clearFlags)\n  }\n\n  function clear (options) {\n    \n    if ('framebuffer' in options) {\n      if (options.framebuffer &&\n          options.framebuffer_reglType === 'framebufferCube') {\n        for (var i = 0; i < 6; ++i) {\n          setFBO(extend({\n            framebuffer: options.framebuffer.faces[i]\n          }, options), clearImpl)\n        }\n      } else {\n        setFBO(options, clearImpl)\n      }\n    } else {\n      clearImpl(null, options)\n    }\n  }\n\n  function frame (cb) {\n    \n    rafCallbacks.push(cb)\n\n    function cancel () {\n      // FIXME:  should we check something other than equals cb here?\n      // what if a user calls frame twice with the same callback...\n      //\n      var i = find(rafCallbacks, cb)\n      \n      function pendingCancel () {\n        var index = find(rafCallbacks, pendingCancel)\n        rafCallbacks[index] = rafCallbacks[rafCallbacks.length - 1]\n        rafCallbacks.length -= 1\n        if (rafCallbacks.length <= 0) {\n          stopRAF()\n        }\n      }\n      rafCallbacks[i] = pendingCancel\n    }\n\n    startRAF()\n\n    return {\n      cancel: cancel\n    }\n  }\n\n  // poll viewport\n  function pollViewport () {\n    var viewport = nextState.viewport\n    var scissorBox = nextState.scissor_box\n    viewport[0] = viewport[1] = scissorBox[0] = scissorBox[1] = 0\n    contextState.viewportWidth =\n      contextState.framebufferWidth =\n      contextState.drawingBufferWidth =\n      viewport[2] =\n      scissorBox[2] = gl.drawingBufferWidth\n    contextState.viewportHeight =\n      contextState.framebufferHeight =\n      contextState.drawingBufferHeight =\n      viewport[3] =\n      scissorBox[3] = gl.drawingBufferHeight\n  }\n\n  function poll () {\n    contextState.tick += 1\n    contextState.time = now()\n    pollViewport()\n    core.procs.poll()\n  }\n\n  function refresh () {\n    textureState.refresh()\n    pollViewport()\n    core.procs.refresh()\n    if (timer) {\n      timer.update()\n    }\n  }\n\n  function now () {\n    return (clock() - START_TIME) / 1000.0\n  }\n\n  refresh()\n\n  function addListener (event, callback) {\n    \n\n    var callbacks\n    switch (event) {\n      case 'frame':\n        return frame(callback)\n      case 'lost':\n        callbacks = lossCallbacks\n        break\n      case 'restore':\n        callbacks = restoreCallbacks\n        break\n      case 'destroy':\n        callbacks = destroyCallbacks\n        break\n      default:\n        \n    }\n\n    callbacks.push(callback)\n    return {\n      cancel: function () {\n        for (var i = 0; i < callbacks.length; ++i) {\n          if (callbacks[i] === callback) {\n            callbacks[i] = callbacks[callbacks.length - 1]\n            callbacks.pop()\n            return\n          }\n        }\n      }\n    }\n  }\n\n  var regl = extend(compileProcedure, {\n    // Clear current FBO\n    clear: clear,\n\n    // Short cuts for dynamic variables\n    prop: dynamic.define.bind(null, DYN_PROP),\n    context: dynamic.define.bind(null, DYN_CONTEXT),\n    this: dynamic.define.bind(null, DYN_STATE),\n\n    // executes an empty draw command\n    draw: compileProcedure({}),\n\n    // Resources\n    buffer: function (options) {\n      return bufferState.create(options, GL_ARRAY_BUFFER, false, false)\n    },\n    elements: function (options) {\n      return elementState.create(options, false)\n    },\n    texture: textureState.create2D,\n    cube: textureState.createCube,\n    renderbuffer: renderbufferState.create,\n    framebuffer: framebufferState.create,\n    framebufferCube: framebufferState.createCube,\n    vao: attributeState.createVAO,\n\n    // Expose context attributes\n    attributes: glAttributes,\n\n    // Frame rendering\n    frame: frame,\n    on: addListener,\n\n    // System limits\n    limits: limits,\n    hasExtension: function (name) {\n      return limits.extensions.indexOf(name.toLowerCase()) >= 0\n    },\n\n    // Read pixels\n    read: readPixels,\n\n    // Destroy regl and all associated resources\n    destroy: destroy,\n\n    // Direct GL state manipulation\n    _gl: gl,\n    _refresh: refresh,\n\n    poll: function () {\n      poll()\n      if (timer) {\n        timer.update()\n      }\n    },\n\n    // Current time\n    now: now,\n\n    // regl Statistics Information\n    stats: stats$$1\n  })\n\n  config.onDone(null, regl)\n\n  return regl\n}\n\nreturn wrapREGL;\n\n})));\n","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","// @ts-check\n/** @typedef {import('glsl-resolve')} GlslResolve */\nconst EventEmitter = require('events').EventEmitter\nconst map = require('map-limit')\n\nconst {\n  genInlineName,\n  cacheWrap,\n  parseFiles,\n  getImportName,\n  extractPreprocessors,\n  asyncify\n} = require('./utils.js')\n\n/**\n * @callback GlslTransformSync\n * @param {String} filename The absolute path of the file you're transforming.\n * @param {String} src The shader source you'd like to transform.\n * @param {Object} opts The transform options.\n * @returns {String} transformed shader\n */\n\n/**\n * @callback GlslTransformAsync\n * @param {String} filename The absolute path of the file you're transforming.\n * @param {String} src The shader source you'd like to transform.\n * @param {Object} opts The transform options.\n * @param {(err: Error, result: String) => any} [cb] callback with the transformed shader\n */\n\n/**\n * @typedef {GlslTransformSync|GlslTransformAsync} GlslTransform\n */\n\n/**\n * @callback TransformRequireSync\n * @param {String|GlslTransform} transform\n * @param {Object} opts\n * @returns {GlslTransform}\n */\n\n/**\n * @callback TransformRequireAsync\n * @param {String|GlslTransform} transform\n * @param {Object} opts\n * @param {(err: Error, transform: GlslTransform) => any} [cb]\n */\n\n/**\n * @typedef {TransformRequireSync|TransformRequireAsync} TransformRequire\n */\n\n/**\n * @typedef {Object} TransformDefinition\n * @prop {string|GlslTransform} tr\n * @prop {string} name\n * @prop {any} opts\n */\n\n/**\n * @typedef {Object} TransformResolved\n * @prop {GlslTransform} tr\n * @prop {string} name\n * @prop {any} opts\n */\n\n/**\n * @typedef {Object} DepperOptions\n * @prop {Boolean} [async] Defines the mechanism flow resolution.\n * @prop {Function} [readFile] pass in a custom function reading files.\n * @prop {GlslResolve} [resolve] pass in a custom function for resolving require calls. It has the same signature as glsl-resolve.\n * @prop {Object<string, string>} [files] a filename/source object mapping of files to prepopulate the file cache with. Useful for overriding.\n * @prop {TransformRequireAsync|TransformRequireSync} [transformRequire] pass in a custom function for resolving non function transforms.\n */\n\n/**\n * @typedef {Object} DepperGraph\n * @prop {Number} id\n * @prop {Object<string, number>} deps\n * @prop {String} file\n * @prop {String} source\n * @prop {Boolean} entry\n */\n\n/**\n * Creates a new instance of glslify-deps. Generally, you'll\n * want to use one instance per bundle.\n *\n * note: this is an interface to be extended with a top class\n * @abstract\n */\nclass Depper extends EventEmitter {\n  /**\n   * @param {DepperOptions} [opts] options\n   */\n  constructor (opts) {\n    super()\n    if (this.constructor === Depper) {\n      throw new Error(\"Depper classes can't be instantiated.\")\n    }\n    opts = opts || {}\n    this._inlineSource = ''\n    this._inlineName = genInlineName()\n    this._async = opts.async || false\n    this._i = 0\n    this._deps = []\n\n    this._cache = {}\n    this._fileCache = parseFiles(Object.assign({}, opts.files) || {})\n\n    /** @type {TransformDefinition[]} */\n    this._transforms = []\n    /** @type {TransformDefinition[]} */\n    this._globalTransforms = []\n\n    if (!opts.readFile) {\n      throw new Error('glslify-deps: readFile must be defined')\n    }\n\n    this._readFile = cacheWrap(opts.readFile, this._fileCache)\n\n    if (!opts.resolve) {\n      throw new Error('glslify-deps: resolve must be defined')\n    }\n\n    this.resolve = opts.resolve\n\n    if (!opts.transformRequire) {\n      throw new Error('glslify-deps: transformRequire must be defined')\n    }\n\n    this.transformRequire = opts.transformRequire\n\n    // @ts-ignore\n    this._transformRequireAsync = !!opts.transformRequire.sync\n\n    if (!this._async && this._transformRequireAsync) {\n      throw new Error('glslify-deps: transformRequire async detected \\n when sync context, please ensure your resolver is even with the context')\n    }\n  }\n\n  /**\n   * Adds a new inline file to the dependency graph, where source is the GLSL source\n   * to include and filename is the identifier of the source\n   * @param {string} source\n   * @param {string} filename\n   * @param {(err: Error, deps: DepperGraph[]) => any} [done]\n   * @returns {DepperGraph[]}\n   */\n  inline (source, filename, done) {\n    this._inlineSource = source\n    return this.add(filename || this._inlineName, done)\n  }\n\n  /**\n   * Adds a shader file to the graph, including its dependencies\n   * which are resolved in this step. Transforms are also applied\n   * in the process too, as they may potentially add or remove dependent\n   * modules.\n   *\n   * @param {String} filename The absolute path of this file.\n   * @param {Object} [opts] The options will be pased to _resolveImports function.\n   * @param {(err: Error, deps?: DepperGraph[]) => any} [done]\n   *\n   * If async is defined then `done` callback will be called when the entire graph has been\n   * resolved, and will include an array of dependencies discovered\n   * so far as its second argument.\n   *\n   * If sync returns an array of dependencies discovered so far as its second argument.\n   */\n  add (filename, opts, done) {\n    if (typeof opts === 'function') {\n      done = opts\n      opts = {}\n    }\n\n    const self = this\n    const exports = []\n    const imports = []\n    const dep = this._addDep(filename)\n    const resolveOpts = Object.assign({\n      deps: dep.deps\n    }, opts)\n\n    const process = asyncify(\n      (_, next) => self.readFile(filename, next),\n      (_, next) => self.getTransformsForFile(filename, next),\n      (result, next) => {\n        // @ts-ignore\n        self.emit('file', filename)\n        return self.applyTransforms(filename, result[0], result[1], next)\n      },\n      (result, next) => {\n        extractPreprocessors(dep.source = result[2], imports, exports)\n        return self._resolveImports(imports, resolveOpts, next)\n      }, (_, next) => {\n        if (next) {\n          next(null, self._deps)\n        }\n      })\n\n    if (this._async) {\n      process(done || (() => {\n        console.warn('glslify-deps: depper.add() has not a callback defined using async flow')\n      }))\n      return dep\n    } else {\n      process()\n      return this._deps\n    }\n  }\n\n  /**\n   * Dummy internal function for resolve transforms for a file\n   * @param {String} filename The absolute path of the file in question.\n   * @param {(err: Error, transforms?: TransformResolved[]) => any} [done] Applies when async true\n   * @returns {TransformResolved[]} List of transform for a file\n   */\n  getTransformsForFile (filename, done) {\n    if (done) {\n      done(null, [])\n    }\n    console.warn('glslify-deps: depper.getTransformsForFile() not yet implemented')\n    return []\n  }\n\n  /**\n   * Adds a transform to use on your local dependencies.\n   * Note that this should be used before calling `add`.\n   *\n   * Transforms are handled using a different API to browserify, e.g.:\n   *\n   * ``` js\n   * module.exports = function transform(filename, src, opts, done) {\n   *   done(null, src.toUpperCase())\n   * }\n   * ```\n   *\n   * Where `filename` is the absolute file path, `src` is the shader source\n   * as a string, `opts` is an options object for configuration, and `done`\n   * is a callback which takes the transformed shader source.\n   *\n   * @param {String|GlslTransform} transform\n   * @param {Object} [opts]\n   * @param {Boolean} [opts.global] adds transform to global scope\n   * @param {Boolean} [opts.post]\n   */\n  transform (transform, opts) {\n    const name = typeof transform === 'string' ? transform : null\n    const list = opts && opts.global\n      ? this._globalTransforms\n      : this._transforms\n\n    // post transforms are ignored by glslify-deps, to be handled\n    // by glslify after the file has been bundled.\n    if (opts && opts.post) return this\n\n    list.push({ tr: transform, opts: opts, name: name })\n\n    return this\n  }\n\n  /**\n   * Resolves a transform.\n   * Works for both contexts async and sync\n   * Functions are retained as-is.\n   * Strings are resolved using the transformRequire option\n   *\n   *\n   * @param {String|GlslTransform} transform\n   * @param {Object} [opts] The options will be pased to transformRequire function.\n   * @param {(err: Error, transform?: GlslTransform) => any} [done] Applies if is defined\n   * @return {Function}\n   */\n  resolveTransform (transform, opts, done) {\n    if (typeof opts === 'function') {\n      done = opts\n      opts = {}\n    }\n\n    if (typeof transform === 'function') {\n      if (done) done(null, transform)\n      return transform\n    }\n\n    const selectTransform = (tr) => {\n      if (this._async) return tr\n      if (!tr || typeof tr.sync !== 'function') {\n        const err = new Error('transform ' + transform + ' does not provide a' +\n        ' synchronous interface')\n        if (done) {\n          done(err)\n          return null\n        } else {\n          throw err\n        }\n      }\n      return tr.sync\n    }\n\n    if (this._transformRequireAsync) {\n      this.transformRequire(transform, opts, (err, resolved) => {\n        if (err) return done(err)\n        return done(null, selectTransform(resolved))\n      })\n    } else {\n      const tr = selectTransform(this.transformRequire(transform, opts))\n      if (tr && done) done(null, tr)\n      return tr\n    }\n  }\n\n  /**\n   * Applies a transform to a string.\n   *\n   * Note that transforms here are passed in differently to other methods:\n   * - `tr.tr` should point to the transform function.\n   * - `tr.opts` should contain the options for the transform, if applicable.\n   *\n   * @param {String} filename The absolute path of the file you're transforming.\n   * @param {String} src The shader source you'd like to transform.\n   * @param {TransformResolved[]} transforms The transforms you'd like to apply.\n   * @param {(err: Error, result?: string) => any} [done] Applies when async true\n   */\n  applyTransforms (filename, src, transforms, done) {\n    if (this._async) {\n      let i = 0\n      const next = (err, updated) => {\n        if (err) return done(err)\n        if (i >= transforms.length) return done(null, updated)\n\n        const tr = transforms[i++]\n        let opts = tr.opts\n\n        if (!opts || typeof opts !== 'object') opts = {}\n        tr.tr(filename, updated + '', tr.opts, next)\n      }\n      next(null, src)\n    } else {\n      transforms.forEach((tr) => {\n        let opts = tr.opts\n        if (!opts || typeof opts !== 'object') opts = {}\n        src = tr.tr(filename, src + '', tr.opts)\n      })\n      return src\n    }\n  }\n\n  /**\n   * Internal method to add dependencies\n   * @param {object} [extra]\n   */\n  _addDep (file, extra) {\n    const dep = Object.assign({\n      id: this._i++,\n      file: file,\n      deps: {},\n      source: null,\n      entry: this._i === 1\n    }, extra)\n\n    this._deps.push(dep)\n\n    return dep\n  }\n\n  /**\n   * Internal method to register transforms\n   * @param {TransformDefinition[]} transforms\n   * @param {(err: Error, resolved?: TransformResolved[]) => any} [cb]\n   * @returns {TransformResolved[]}\n   */\n  _register (transforms, cb) {\n    /** @type {TransformResolved[]} */\n    // @ts-ignore\n    const result = transforms\n      .concat(this._globalTransforms)\n      // map acts as synchronous if the iterator is always in\n      // the main thread so is compatible with resolveTransform\n    map(result, 1, (tr, next) => {\n      this.resolveTransform(tr.tr, next)\n    }, (err, resolved) => {\n      if (err) {\n        if (cb) return cb(err)\n        throw err\n      }\n      result.forEach((tr, idx) => {\n        tr.tr = resolved[idx]\n      })\n      if (cb) cb(null, result)\n    })\n\n    return result\n  }\n\n  /**\n   * Internal async method to retrieve dependencies\n   * resolving imports using the internal cache\n   *\n   * @param {string[]} imports\n   * @param {object} [opts] The options will be pased to resolve function.\n   * @param {object} [opts.deps] Existing dependencies\n   * @param {number} [opts.parallel=10] Parallel threads when async\n   * @param {(err: Error) => any} [done]\n   * @return {object} Resolved dependencies\n   */\n  _resolveImports (imports, opts, done) {\n    if (typeof opts === 'function') {\n      done = opts\n      opts = {}\n    }\n    const deps = (opts && opts.deps) || {}\n    const parallel = (opts && opts.parallel) || 10\n\n    const process = asyncify(\n      (result, next) => this.resolve(result[0], opts, next),\n      (result, next) => {\n        const importName = result[0]\n        const resolved = result[1]\n        if (this._cache[resolved]) {\n          deps[importName] = this._cache[resolved].id\n          return next && next()\n        }\n        if (next) {\n          this._cache[resolved] = this.add(resolved, (err) => {\n            if (err) return next(err)\n            deps[importName] = this._cache[resolved].id\n            next()\n          })\n        } else {\n          const idx = this._i\n          this._cache[resolved] = this.add(resolved)[idx]\n          deps[importName] = this._cache[resolved].id\n        }\n      }\n    )\n\n    if (this._async) {\n      map(imports, parallel, (imp, next) => {\n        process([getImportName(imp)], next)\n      }, done)\n    } else {\n      imports.forEach((imp) => {\n        process([getImportName(imp)])\n      })\n    }\n\n    return deps\n  }\n\n  readFile (filename, done) {\n    if (filename !== this._inlineName) { return this._readFile(filename, done) }\n\n    if (this._async) {\n      return done(null, this._inlineSource)\n    }\n    return this._inlineSource\n  }\n}\n\nmodule.exports = Depper\n","var once = require('once')\nvar noop = function noop(){}\n\nmodule.exports = mapLimit\n\nfunction mapLimit(arr, limit, iterator, callback) {\n  var complete = 0\n  var aborted = false\n  var results = []\n  var queued = 0\n  var l = arr.length\n  var i = 0\n\n  callback = once(callback || noop)\n  if (typeof iterator !== 'function') throw new Error(\n    'Iterator function must be passed as the third argument'\n  )\n\n  for (var r = 0; r < l; r++) {\n    results[r] = null\n  }\n\n  flush()\n\n  function flush() {\n    if (complete === l)\n      return callback(null, results)\n\n    while (queued < limit) {\n      if (aborted) break\n      if (i === l) break\n      push()\n    }\n  }\n\n  function abort(err) {\n    aborted = true\n    return callback(err)\n  }\n\n  function push() {\n    var idx = i++\n\n    queued += 1\n\n    iterator(arr[idx], function(err, result) {\n      if (err) return abort(err)\n      results[idx] = result\n      complete += 1\n      queued -= 1\n      flush()\n    })\n  }\n}\n","var wrappy = require('wrappy')\nmodule.exports = wrappy(once)\n\nonce.proto = once(function () {\n  Object.defineProperty(Function.prototype, 'once', {\n    value: function () {\n      return once(this)\n    },\n    configurable: true\n  })\n})\n\nfunction once (fn) {\n  var f = function () {\n    if (f.called) return f.value\n    f.called = true\n    return f.value = fn.apply(this, arguments)\n  }\n  f.called = false\n  return f\n}\n","// Returns a wrapper function that returns a wrapped callback\n// The wrapper function should do some stuff, and return a\n// presumably different callback function.\n// This makes sure that own properties are retained, so that\n// decorations and such are not lost along the way.\nmodule.exports = wrappy\nfunction wrappy (fn, cb) {\n  if (fn && cb) return wrappy(fn)(cb)\n\n  if (typeof fn !== 'function')\n    throw new TypeError('need wrapper function')\n\n  Object.keys(fn).forEach(function (k) {\n    wrapper[k] = fn[k]\n  })\n\n  return wrapper\n\n  function wrapper() {\n    var args = new Array(arguments.length)\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i]\n    }\n    var ret = fn.apply(this, args)\n    var cb = args[args.length-1]\n    if (typeof ret === 'function' && ret !== cb) {\n      Object.keys(cb).forEach(function (k) {\n        ret[k] = cb[k]\n      })\n    }\n    return ret\n  }\n}\n","// @ts-check\n\nconst tokenize = require('glsl-tokenizer/string')\nconst path = require('path')\n\nconst glslifyPreprocessor = (data) => {\n  return /#pragma glslify:/.test(data)\n}\n\nconst glslifyExport = (data) => {\n  return /#pragma glslify:\\s*export\\(([^)]+)\\)/.exec(data)\n}\n\nconst glslifyImport = (data) => {\n  return /#pragma glslify:\\s*([^=\\s]+)\\s*=\\s*require\\(([^)]+)\\)/.exec(data)\n}\n\nconst genInlineName = () => {\n  return '__INLINE__' + Math.random()\n}\n\n/**\n * Gets glslify transform from given package.json\n *\n * @param {object|string} pkgJson package.json string data or json\n * @returns {({tr: string, name: string, opts: object})[]}\n */\nconst getTransformsFromPkg = (pkgJson) => {\n  if (typeof pkgJson === 'string') {\n    pkgJson = JSON.parse(pkgJson)\n  }\n\n  const transforms = (\n    (\n      pkgJson.glslify &&\n      pkgJson.glslify.transform\n    ) || []\n  )\n\n  return transforms.map((tr) => {\n    const transform = Array.isArray(tr)\n      ? tr\n      : [tr, {}]\n\n    const key = transform[0]\n    const opt = transform[1]\n\n    if (opt) {\n      delete opt.global\n      delete opt.post\n    }\n\n    return { tr: key, opts: opt, name: key }\n  })\n}\n\n/**\n * Extracts preprocessors copying the imports and exports\n * into respective parameters\n * @param {string} source\n * @param {string[]} imports\n * @param {string[]} exports\n */\nconst extractPreprocessors = (source, imports, exports) => {\n  const tokens = tokenize(source)\n\n  for (let i = 0; i < tokens.length; i++) {\n    const token = tokens[i]\n    if (token.type !== 'preprocessor') continue\n\n    const data = token.data\n    if (!glslifyPreprocessor(data)) continue\n\n    const exp = glslifyExport(data)\n    const imp = glslifyImport(data)\n    if (exp) exports.push(exp[1])\n    if (imp) imports.push(imp[2])\n  }\n}\n\nconst getImportName = (imp) => {\n  return imp\n    .split(/\\s*,\\s*/)\n    .shift()\n    .trim()\n    .replace(/^'|'$/g, '')\n    .replace(/^\"|\"$/g, '')\n}\n\n/** Fast apply */\nconst apply = (fn, args) => {\n  switch (args.length) {\n    case 1:\n      return fn(args[0])\n    case 2:\n      return fn(args[0], args[1])\n    case 3:\n      return fn(args[0], args[1], args[2])\n    case 4:\n      return fn(args[0], args[1], args[2], args[3])\n    default:\n      return fn.apply(null, args)\n  }\n}\n/**\n * Takes an sync and async functions and return a function which detects if the last argument\n * is a callback in order to select which flow to use\n * @param {function} sync\n * @param {function} async\n * @returns {(...args, done) => any}\n */\nconst mix = (sync, async) => {\n  const mixed = (...args) => {\n    if (typeof args[args.length - 1] === 'function') {\n      if (!async) {\n        throw Error('There\\'s no async function available')\n      }\n      apply(async, args)\n    }\n    if (!sync) {\n      throw Error('There\\'s no sync function available')\n    }\n    return apply(sync, args)\n  }\n\n  mixed.sync = sync\n  mixed.async = async\n\n  return mixed\n}\n\n/**\n * Allows reuse sync/async logics detecting if done is defined to select which strategy to use.\n * Arguments must be functions, if sync is detected then takes the returned value,\n * otherwise when async next will be defined and will take the result from there\n *\n * @param {...(prevState: any[], next?: (err?: Error, result?: any) => void) => void} fns\n * @returns {((initialState?: any[], done?: (err: Error, state?: any[]) => any) => void[])&((done?: (err: Error, state?: any[]) => any) => any[])}\n * @example\n *\n * const process = asyncify(\n *   ([foo], next) => next ? next(null, 'bar') : 'bar',\n *   ([foo, bar], next) => next ? next(null, foo + bar) : foo + bar\n * )\n *\n * // sync\n * const state = process(['foo'])\n * console.log(state) // ['foo', 'bar', 'foobar']\n *\n * // async\n * process(['bar'], (err, result) => console.log(result)) // ['foo', 'bar', 'foobar']\n *\n */\nconst asyncify = (...fns) => {\n  return (initialState, done) => {\n    if (typeof initialState === 'function') {\n      done = initialState\n      initialState = []\n    }\n\n    const state = initialState || []\n    let cursor = state.length\n    let i = 0\n\n    if (!Array.isArray(state)) {\n      throw new Error('asyncify: initialState must be an array')\n    }\n\n    if (!fns.length) {\n      throw new Error('asyncify: no functions detected')\n    }\n\n    if (typeof state[state.length - 1] === 'function') {\n      done = state.pop()\n      cursor = state.length\n    }\n\n    const error = () => {\n      return new Error('asyncify: arguments must be functions')\n    }\n\n    if (!done) {\n      for (; i < fns.length; i++) {\n        if (typeof fns[i] !== 'function') {\n          throw error()\n        }\n        state[cursor + i] = fns[i](state)\n      }\n    } else {\n      /**\n       *\n       * @param {Error} [err]\n       * @param {any} [result]\n       */\n      const next = (err, result) => {\n        if (err) {\n          done(err)\n        } else {\n          state[cursor + i++] = result\n          if (i < fns.length) {\n            if (typeof fns[i] !== 'function') {\n              done(error())\n            } else {\n              fns[i](state, next)\n            }\n          } else {\n            done(null, state[state.length - 1])\n          }\n        }\n      }\n\n      fns[i](state, next)\n    }\n\n    return state\n  }\n}\n\nconst cacheWrap = (read, cache) => {\n  const readFromCache = (filename) => {\n    if (!cache[filename]) {\n      cache[filename] = read(filename)\n    }\n    return cache[filename]\n  }\n\n  const readFromCacheAsync = (filename, done) => {\n    if (!cache[filename]) {\n      return read(filename, (err, content) => {\n        if (err) done(err)\n        done(err, cache[filename] = content)\n      })\n    }\n    return process.nextTick(() => {\n      done(null, cache[filename])\n    })\n  }\n\n  return mix(readFromCache, readFromCacheAsync)\n}\n\nconst parseFiles = (files) => {\n  // resolve all files such that they match\n  // all of the paths glslify handles, which are otherwise\n  // absolute\n  return Object.keys(files).reduce((newCache, file) => {\n    newCache[path.resolve(file)] = files[file]\n    return newCache\n  }, {})\n}\n\nmodule.exports = {\n  getTransformsFromPkg,\n  getImportName,\n  extractPreprocessors,\n  genInlineName,\n  cacheWrap,\n  mix,\n  parseFiles,\n  asyncify\n}\n","/* eslint-disable no-redeclare */\r\n\r\nvar hash = require('murmurhash-js/murmurhash3_gc')\r\nvar trim = require('glsl-token-whitespace-trim')\r\nvar tokenize = require('glsl-tokenizer/string')\r\nvar inject = require('glsl-inject-defines')\r\nvar defines = require('glsl-token-defines')\r\nvar descope = require('glsl-token-descope')\r\nvar clean = require('./lib/clean-suffixes')\r\nvar string = require('glsl-token-string')\r\nvar scope = require('glsl-token-scope')\r\nvar depth = require('glsl-token-depth')\r\nvar topoSort = require('./lib/topo-sort')\r\nvar copy = require('shallow-copy')\r\n\r\nmodule.exports = function (deps) {\r\n  return inject(Bundle(deps).src, {\r\n    GLSLIFY: 1\r\n  })\r\n}\r\n\r\nfunction Bundle (deps) {\r\n  if (!(this instanceof Bundle)) return new Bundle(deps)\r\n\r\n  // Reorder dependencies topologically\r\n  deps = topoSort(deps)\r\n\r\n  this.depList = deps\r\n  this.depIndex = indexBy(deps, 'id')\r\n  this.exported = {}\r\n  this.cache = {}\r\n  this.varCounter = 0\r\n\r\n  this.src = []\r\n\r\n  for (var i = 0; i < deps.length; i++) {\r\n    this.preprocess(deps[i])\r\n  }\r\n\r\n  for (var i = 0; i < deps.length; i++) {\r\n    if (deps[i].entry) {\r\n      this.src = this.src.concat(this.bundle(deps[i]))\r\n    }\r\n  }\r\n\r\n  this.src = string(this.src)\r\n  this.src = string(clean(trim(tokenize(this.src))))\r\n}\r\n\r\nvar proto = Bundle.prototype\r\n\r\nproto.preprocess = function (dep) {\r\n  var tokens = tokenize(dep.source)\r\n  var imports = []\r\n  var exports = null\r\n\r\n  depth(tokens)\r\n  scope(tokens)\r\n\r\n  for (var i = 0; i < tokens.length; i++) {\r\n    var token = tokens[i]\r\n    if (token.type !== 'preprocessor') continue\r\n    if (!glslifyPreprocessor(token.data)) continue\r\n\r\n    var exported = glslifyExport(token.data)\r\n    var imported = glslifyImport(token.data)\r\n\r\n    if (exported) {\r\n      exports = exported[1]\r\n      tokens.splice(i--, 1)\r\n    } else if (imported) {\r\n      var name = imported[1]\r\n      var maps = imported[2].split(/\\s?,\\s?/g)\r\n      var path = maps.shift()\r\n        .trim()\r\n        .replace(/^'|'$/g, '')\r\n        .replace(/^\"|\"$/g, '')\r\n      var target = this.depIndex[dep.deps[path]]\r\n      imports.push({\r\n        name: name,\r\n        path: path,\r\n        target: target,\r\n        maps: toMapping(maps),\r\n        index: i\r\n      })\r\n      tokens.splice(i--, 1)\r\n    }\r\n  }\r\n\r\n  var eof = tokens[tokens.length - 1]\r\n  if (eof && eof.type === 'eof') {\r\n    tokens.pop()\r\n  }\r\n\r\n  if (dep.entry) {\r\n    exports = exports || 'main'\r\n  }\r\n\r\n  if (!exports) {\r\n    throw new Error(dep.file + ' does not export any symbols')\r\n  }\r\n\r\n  dep.parsed = {\r\n    tokens: tokens,\r\n    imports: imports,\r\n    exports: exports\r\n  }\r\n}\r\n\r\nproto.bundle = function (entry) {\r\n  var resolved = {}\r\n  var result = resolve(entry, [])[1]\r\n\r\n  return result\r\n\r\n  function resolve (dep, bindings) {\r\n    // Compute suffix for module\r\n    bindings.sort()\r\n    var ident = bindings.join(':') + ':' + dep.id\r\n    var suffix = '_' + hash(ident)\r\n\r\n    if (dep.entry) {\r\n      suffix = ''\r\n    }\r\n\r\n    // Test if export is already resolved\r\n    var exportName = dep.parsed.exports + suffix\r\n    if (resolved[exportName]) {\r\n      return [exportName, []]\r\n    }\r\n\r\n    // Initialize map for variable renamings based on bindings\r\n    var rename = {}\r\n    for (var i = 0; i < bindings.length; ++i) {\r\n      var binding = bindings[i]\r\n      rename[binding[0]] = binding[1]\r\n    }\r\n\r\n    // Resolve all dependencies\r\n    var imports = dep.parsed.imports\r\n    var edits = []\r\n    for (var i = 0; i < imports.length; ++i) {\r\n      var data = imports[i]\r\n\r\n      var importMaps = data.maps\r\n      var importName = data.name\r\n      var importTarget = data.target\r\n\r\n      var importBindings = Object.keys(importMaps).map(function (id) {\r\n        var value = importMaps[id]\r\n\r\n        // floats/ints should not be renamed\r\n        if (value.match(/^\\d+(?:\\.\\d+?)?$/g)) {\r\n          return [id, value]\r\n        }\r\n\r\n        // properties (uVec.x, ray.origin, ray.origin.xy etc.) should\r\n        // have their host identifiers renamed\r\n        var parent = value.match(/^([^.]+)\\.(.+)$/)\r\n        if (parent) {\r\n          return [id, (rename[parent[1]] || (parent[1] + suffix)) + '.' + parent[2]]\r\n        }\r\n\r\n        return [id, rename[value] || (value + suffix)]\r\n      })\r\n\r\n      var importTokens = resolve(importTarget, importBindings)\r\n      rename[importName] = importTokens[0]\r\n      edits.push([data.index, importTokens[1]])\r\n    }\r\n\r\n    // Rename tokens\r\n    var parsedTokens = dep.parsed.tokens.map(copy)\r\n    var parsedDefs = defines(parsedTokens)\r\n    var tokens = descope(parsedTokens, function (local, token) {\r\n      if (parsedDefs[local]) return local\r\n      if (rename[local]) return rename[local]\r\n\r\n      return local + suffix\r\n    })\r\n\r\n    // Insert edits\r\n    edits.sort(function (a, b) {\r\n      return b[0] - a[0]\r\n    })\r\n\r\n    for (var i = 0; i < edits.length; ++i) {\r\n      var edit = edits[i]\r\n      tokens = tokens.slice(0, edit[0])\r\n        .concat(edit[1])\r\n        .concat(tokens.slice(edit[0]))\r\n    }\r\n\r\n    resolved[exportName] = true\r\n    return [exportName, tokens]\r\n  }\r\n}\r\n\r\nfunction glslifyPreprocessor (data) {\r\n  return /#pragma glslify:/.test(data)\r\n}\r\n\r\nfunction glslifyExport (data) {\r\n  return /#pragma glslify:\\s*export\\(([^)]+)\\)/.exec(data)\r\n}\r\n\r\nfunction glslifyImport (data) {\r\n  return /#pragma glslify:\\s*([^=\\s]+)\\s*=\\s*require\\(([^)]+)\\)/.exec(data)\r\n}\r\n\r\nfunction indexBy (deps, key) {\r\n  return deps.reduce(function (deps, entry) {\r\n    deps[entry[key]] = entry\r\n    return deps\r\n  }, {})\r\n}\r\n\r\nfunction toMapping (maps) {\r\n  if (!maps) return false\r\n\r\n  return maps.reduce(function (mapping, defn) {\r\n    defn = defn.split(/\\s?=\\s?/g)\r\n\r\n    var expr = defn.pop()\r\n\r\n    defn.forEach(function (key) {\r\n      mapping[key] = expr\r\n    })\r\n\r\n    return mapping\r\n  }, {})\r\n}\r\n","/**\n * JS Implementation of MurmurHash3 (r136) (as of May 20, 2011)\n * \n * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\n * @see http://github.com/garycourt/murmurhash-js\n * @author <a href=\"mailto:aappleby@gmail.com\">Austin Appleby</a>\n * @see http://sites.google.com/site/murmurhash/\n * \n * @param {string} key ASCII only\n * @param {number} seed Positive integer only\n * @return {number} 32-bit positive integer hash \n */\n\nfunction murmurhash3_32_gc(key, seed) {\n\tvar remainder, bytes, h1, h1b, c1, c1b, c2, c2b, k1, i;\n\t\n\tremainder = key.length & 3; // key.length % 4\n\tbytes = key.length - remainder;\n\th1 = seed;\n\tc1 = 0xcc9e2d51;\n\tc2 = 0x1b873593;\n\ti = 0;\n\t\n\twhile (i < bytes) {\n\t  \tk1 = \n\t  \t  ((key.charCodeAt(i) & 0xff)) |\n\t  \t  ((key.charCodeAt(++i) & 0xff) << 8) |\n\t  \t  ((key.charCodeAt(++i) & 0xff) << 16) |\n\t  \t  ((key.charCodeAt(++i) & 0xff) << 24);\n\t\t++i;\n\t\t\n\t\tk1 = ((((k1 & 0xffff) * c1) + ((((k1 >>> 16) * c1) & 0xffff) << 16))) & 0xffffffff;\n\t\tk1 = (k1 << 15) | (k1 >>> 17);\n\t\tk1 = ((((k1 & 0xffff) * c2) + ((((k1 >>> 16) * c2) & 0xffff) << 16))) & 0xffffffff;\n\n\t\th1 ^= k1;\n        h1 = (h1 << 13) | (h1 >>> 19);\n\t\th1b = ((((h1 & 0xffff) * 5) + ((((h1 >>> 16) * 5) & 0xffff) << 16))) & 0xffffffff;\n\t\th1 = (((h1b & 0xffff) + 0x6b64) + ((((h1b >>> 16) + 0xe654) & 0xffff) << 16));\n\t}\n\t\n\tk1 = 0;\n\t\n\tswitch (remainder) {\n\t\tcase 3: k1 ^= (key.charCodeAt(i + 2) & 0xff) << 16;\n\t\tcase 2: k1 ^= (key.charCodeAt(i + 1) & 0xff) << 8;\n\t\tcase 1: k1 ^= (key.charCodeAt(i) & 0xff);\n\t\t\n\t\tk1 = (((k1 & 0xffff) * c1) + ((((k1 >>> 16) * c1) & 0xffff) << 16)) & 0xffffffff;\n\t\tk1 = (k1 << 15) | (k1 >>> 17);\n\t\tk1 = (((k1 & 0xffff) * c2) + ((((k1 >>> 16) * c2) & 0xffff) << 16)) & 0xffffffff;\n\t\th1 ^= k1;\n\t}\n\t\n\th1 ^= key.length;\n\n\th1 ^= h1 >>> 16;\n\th1 = (((h1 & 0xffff) * 0x85ebca6b) + ((((h1 >>> 16) * 0x85ebca6b) & 0xffff) << 16)) & 0xffffffff;\n\th1 ^= h1 >>> 13;\n\th1 = ((((h1 & 0xffff) * 0xc2b2ae35) + ((((h1 >>> 16) * 0xc2b2ae35) & 0xffff) << 16))) & 0xffffffff;\n\th1 ^= h1 >>> 16;\n\n\treturn h1 >>> 0;\n}\n\nif(typeof module !== \"undefined\") {\n  module.exports = murmurhash3_32_gc\n}","module.exports = trim\n\nfunction trim (tokens, everything) {\n  return trim[everything ? 'all' : 'newlines'](collapse(tokens))\n}\n\nfunction collapse (tokens) {\n  for (var i = 1; i < tokens.length; i++) {\n    var curr = tokens[i]\n    if (curr.type !== 'whitespace') continue\n    var prev = tokens[i - 1]\n    if (prev.type !== 'whitespace') continue\n    tokens.splice(--i, 1)\n    curr.data = prev.data + curr.data\n  }\n\n  return tokens\n}\n\nvar newlines = /(?:\\n|\\r\\n|\\r){2,}/g\n\ntrim.newlines = function (tokens) {\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i]\n    if (token.type !== 'whitespace') continue\n    token.data = token.data.replace(newlines, '\\n\\n')\n  }\n\n  return tokens\n}\n\nvar all = /\\s+/g\n\ntrim.all = function (tokens) {\n  var l = tokens.length\n\n  for (var i = 0; i < l; i++) {\n    var token = tokens[i]\n    if (token.type !== 'whitespace') continue\n    var next = tokens[i + 1]\n    var prev = tokens[i - 1]\n\n    if (next && next.type === 'preprocessor' || prev && prev.type === 'preprocessor') {\n      token.data = token.data.replace(all, '\\n')\n    } else {\n      token.data = token.data.replace(all, ' ')\n\n      switch (next && next.data) {\n        case '(': case ';': case ')':\n        case '{': case '=': case '}': case ',':\n          token.data = token.data.replace(all, '')\n      }\n\n      switch (prev && prev.data) {\n        case '(': case ';': case ')':\n        case '{': case '=': case '}': case ',':\n          token.data = token.data.replace(all, '')\n      }\n    }\n  }\n\n  return tokens\n}\n","var tokenize = require('glsl-tokenizer')\nvar stringify = require('glsl-token-string')\nvar inject = require('glsl-token-inject-block')\n\nmodule.exports = function glslInjectDefine (source, defines) {\n  if (!defines) {\n    return source\n  }\n\n  var keys = Object.keys(defines)\n  if (keys.length === 0) {\n    return source\n  }\n\n  var tokens = tokenize(source)\n  for (var i=keys.length-1; i>=0; i--) {\n    var key = keys[i]\n    var val = String(defines[key])\n    if (val) { // allow empty value\n      val = ' ' + val\n    }\n\n    inject(tokens, {\n      type: 'preprocessor',\n      data: '#define ' + key + val\n    })\n  }\n  \n  return stringify(tokens)\n}\n","module.exports = glslTokenInject\n\nvar newline = { data: '\\n', type: 'whitespace' }\nvar regex = /[^\\r\\n]$/\n\nfunction glslTokenInject (tokens, newTokens) {\n  if (!Array.isArray(newTokens))\n    newTokens = [ newTokens ]\n  var start = getStartIndex(tokens)\n  var last = start > 0 ? tokens[start-1] : null\n  if (last && regex.test(last.data)) {\n    tokens.splice(start++, 0, newline)\n  }\n  tokens.splice.apply(tokens, [ start, 0 ].concat(newTokens))\n  \n  var end = start + newTokens.length\n  if (tokens[end] && /[^\\r\\n]$/.test(tokens[end].data)) {\n    tokens.splice(end, 0, newline)\n  }\n  return tokens\n}\n\nfunction getStartIndex (tokens) {\n  // determine starting index for attributes\n  var start = -1\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i]\n    if (token.type === 'preprocessor') {\n      if (/^#(extension|version)/.test(token.data)) {\n        start = Math.max(start, i)\n      }\n    } else if (token.type === 'keyword' && token.data === 'precision') {\n      var semi = findNextSemicolon(tokens, i)\n      if (semi === -1) {\n        throw new Error('precision statement not followed by any semicolons!')\n      }\n      start = Math.max(start, semi)\n    }\n  }\n  return start + 1\n}\n\nfunction findNextSemicolon (tokens, start) {\n  for (var i = start; i < tokens.length; i++) {\n    if (tokens[i].type === 'operator' && tokens[i].data === ';') {\n      return i\n    }\n  }\n  return -1\n}","module.exports = defines\n\nfunction defines(tokens) {\n  var definitions = {}\n\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i]\n    if (token.type !== 'preprocessor') continue\n    var datum = token.data.trim()\n    if (datum.indexOf('#define')) continue\n    var parts = datum.match(/#define\\s+([^\\s]+)(.+)?$/i)\n    if (!parts) continue\n    var name  = (parts[1] || '').trim()\n    var value = (parts[2] || '').trim()\n\n    definitions[name] = value\n  }\n\n  return definitions\n}\n","module.exports = glslTokenDescope\n\nfunction glslTokenDescope(tokens, rename) {\n  require('glsl-token-depth')(tokens)\n  require('glsl-token-scope')(tokens)\n  require('glsl-token-properties')(tokens)\n  require('glsl-token-assignments')(tokens)\n\n  var scope   = getScope(tokens)\n  var renamer = rename || defaultRenamer()\n  var map     = {}\n\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i]\n    var stack = token.stack\n    var name  = token.data\n\n    token.descoped = false\n\n    if (token.type !== 'ident') continue\n    if (token.property) continue\n    if (token.structMember) continue\n\n    var bound = false\n\n    for (var j = stack.length - 1; j >= 0; j--) {\n      var s = scope[stack[j]]\n      if (!s) continue\n      if (!s[name]) continue\n\n      bound = true\n\n      // exit if declaration not in top-level scope\n      if (j) break\n\n      token.descoped = token.data\n      token.data = map[name] = map[name] || renamer(name, token) || token.data\n    }\n\n    // Handle unbound variables, i.e. ones not defined anywhere\n    // in the shader source but still used.\n    if (!bound) {\n      token.descoped = token.data\n      token.data = map[name] = map[name] || renamer(name, token) || token.data\n    }\n  }\n\n  return tokens\n}\n\nfunction defaultRenamer() {\n  var k = 0\n\n  return function rename(name) {\n    return name + '_' + (k++).toString(36)\n  }\n}\n\nfunction getScope(tokens) {\n  var scope = {}\n\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i]\n    if (token.declaration) {\n      scope[token.scope] = scope[token.scope] || {}\n      scope[token.scope][token.data] = token\n    }\n  }\n\n  return scope\n}\n","module.exports = properties\n\nfunction properties(tokens) {\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i]\n    token.property = false\n\n    if (token.type !== 'ident') continue\n\n    var j = i\n    while (tokens[--j] && tokens[j].type === 'whitespace');\n    if (!tokens[j]) continue\n    if (tokens[j].type !== 'operator') continue\n    if (tokens[j].data !== '.') continue\n\n    token.property = true\n  }\n\n  return tokens\n}\n","var assignments = require('./assignments')\nvar ignoredKeywords = require('./ignored')\n\nmodule.exports = assigns\n\n// Here be dragons. Apologies in advance for the hairy code!\nfunction assigns(tokens) {\n  var idx = 0\n\n  // Determine if a value has been assigned, e.g.\n  // x = 1.0;\n  // float x = 1.0;\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i]\n    var type  = token.type\n\n    token.assignment = false\n    token.declaration = false\n    if (type !== 'ident' && type !== 'builtin') continue\n    idx = i + 1\n\n    skipWhitespace(+1)\n    if (tokens[idx].type !== 'operator') continue\n    if (!assignments[tokens[idx].data]) continue\n    token.assignment = true\n  }\n\n  // Determine if a value is being defined, e.g.\n  // float x;\n  // float x, y, z;\n  // float x, y = vec3(sin(1.0 + 3.0)), z;\n  // float[3][2] x, y = vec3(sin(1.0 + 3.0)), z;\n  // float[][2] x, y = vec3(sin(1.0 + 3.0)), z;\n  // float x[2], y = vec3(sin(1.0 + 3.0)), z[4];\n  // float x(float y, float z) {};\n  // float x(float y[2], Thing[3] z) {};\n  // Thing x[2], y = Another(sin(1.0 + 3.0)), z[4];\n  for (var i = 0; i < tokens.length; i++) {\n    var datatype = tokens[i]\n    var type     = datatype.type\n    var data     = datatype.data\n\n    datatype.declaration = false\n\n    if (type === 'keyword') {\n      if (ignoredKeywords[data]) continue\n    } else\n    if (type !== 'ident') continue\n\n    idx = i + 1\n\n    skipArrayDimensions()\n    if (tokens[idx].type !== 'ident') continue\n    tokens[idx++].declaration = true\n    skipArrayDimensions()\n\n    // Function arguments/parameters\n    if (tokens[idx].data === '(') {\n      idx++\n\n      skipWhitespace(+1)\n      while (tokens[idx] && tokens[idx].data !== ')') {\n        if (tokens[idx].type !== 'keyword' && tokens[idx].type !== 'ident') break\n        idx++\n        skipWhitespace(+1)\n        if (tokens[idx].type !== 'ident') continue\n        tokens[idx++].declaration = true\n        skipWhitespace(+1)\n        skipArrayDimensions()\n        skipWhitespace(+1)\n        if (tokens[idx].data !== ',') continue\n        idx++\n        skipWhitespace(+1)\n      }\n\n      i = idx\n      continue\n    }\n\n    // Declaration Lists\n    while (tokens[idx] && tokens[idx].data !== ';') {\n      if (tokens[idx].data === ',') {\n        idx++\n        skipWhitespace(+1)\n        if (tokens[idx].declaration = tokens[idx].type === 'ident') idx++\n      } else {\n        skipWhitespace(+1)\n        skipParens()\n        skipWhitespace(+1)\n        idx++\n      }\n    }\n\n    i = idx\n  }\n\n  // Handle struct declarations:\n  // struct declaration {\n  //   float x, y, z;\n  //   Other w;\n  // } declaration;\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i]\n    if (token.type !== 'keyword') continue\n    if (token.data !== 'struct') continue\n    idx = i + 1\n    skipWhitespace(+1)\n    if (tokens[idx].type !== 'ident') continue\n\n    idx++\n    skipWhitespace(+1)\n    if (tokens[idx++].data !== '{') continue\n    skipWhitespace(+1)\n\n    while (tokens[idx].type === 'ident' || tokens[idx].type === 'keyword') {\n      do {\n        idx++\n        skipWhitespace(+1)\n        tokens[idx].structMember = true\n        tokens[idx].declaration = false\n        idx++\n        skipArrayDimensions()\n      } while (tokens[idx].data === ',')\n\n      if (tokens[idx].data === ';') idx++\n      skipWhitespace()\n    }\n\n    idx++\n    skipWhitespace(+1)\n    if (tokens[idx].type !== 'ident') continue\n    tokens[idx].declaration = true\n    skipWhitespace(+1)\n\n    while (tokens[++idx].data === ',') {\n      skipWhitespace(+1)\n      idx++\n      skipWhitespace(+1)\n      if (tokens[idx].type === 'ident') tokens[idx].declaration = true\n      skipWhitespace(+1)\n    }\n  }\n\n  return tokens\n\n  function skipWhitespace(n) {\n    while (tokens[idx] && tokens[idx].type === 'whitespace') idx++\n  }\n\n  function skipArrayDimensions() {\n    while (tokens[idx] && (\n         tokens[idx].type === 'integer'\n      || tokens[idx].data === '['\n      || tokens[idx].data === ']'\n      || tokens[idx].type === 'whitespace'\n    )) idx++\n  }\n\n  function skipParens() {\n    if (!tokens[idx]) return\n    if (tokens[idx].data !== '(') return\n    var depth = 0\n    var a = idx\n    do {\n      if (tokens[idx].data === ';') break\n      if (tokens[idx].data === '(') depth++\n      if (tokens[idx].data === ')') depth--\n    } while(depth && tokens[++idx])\n  }\n}\n","module.exports = {\n    '<<=': true\n  , '>>=': true\n  , '++': true\n  , '--': true\n  , '+=': true\n  , '-=': true\n  , '*=': true\n  , '/=': true\n  , '%=': true\n  , '&=': true\n  , '^=': true\n  , '|=': true\n  , '=': true\n}\n","module.exports = {\n    'precision': true\n  , 'highp': true\n  , 'mediump': true\n  , 'lowp': true\n  , 'attribute': true\n  , 'const': true\n  , 'uniform': true\n  , 'varying': true\n  , 'break': true\n  , 'continue': true\n  , 'do': true\n  , 'for': true\n  , 'while': true\n  , 'if': true\n  , 'else': true\n  , 'in': true\n  , 'out': true\n  , 'inout': true\n  , 'true': true\n  , 'false': true\n  , 'return': true\n}\n","module.exports = clean\r\n\r\nvar suffix = /^([^_]+)_(\\d{4,})$/\r\n\r\nfunction clean (tokens) {\r\n  var blacklist = {}\r\n  var index = {}\r\n\r\n  for (var i = 0; i < tokens.length; i++) {\r\n    var token = tokens[i]\r\n    if (token.type !== 'ident') continue\r\n    var match = token.data.match(suffix)\r\n    if (!match) {\r\n      blacklist[token.data] = true\r\n      continue\r\n    }\r\n\r\n    var pre = match[1]\r\n    var suf = match[2]\r\n\r\n    index[pre] = index[pre] || {}\r\n    index[pre][suf] = index[pre][suf] || []\r\n    index[pre][suf].push(token)\r\n  }\r\n\r\n  Object.keys(index).forEach(function (prefix) {\r\n    var suffixes = Object.keys(index[prefix])\r\n    if (suffixes.length === 1 && !blacklist[prefix]) {\r\n      var tokens = index[prefix][suffixes[0]]\r\n      for (var i = 0; i < tokens.length; i++) {\r\n        tokens[i].data = prefix\r\n      }\r\n\r\n      return\r\n    }\r\n\r\n    suffixes.forEach(function (suffix, i) {\r\n      var token = index[prefix][suffix]\r\n      var rename = prefix + '_' + i\r\n      if (blacklist[rename]) return\r\n      for (var j = 0; j < token.length; j++) {\r\n        token[j].data = rename\r\n      }\r\n    })\r\n  })\r\n\r\n  return tokens\r\n}\r\n","module.exports = topoSort\r\n\r\n// Permutes the dependencies into topological order\r\nfunction topoSort (deps) {\r\n  // Build reversed adjacency list\r\n  var adj = {}\r\n  var inDegree = {}\r\n  var index = {}\r\n  deps.forEach(function (dep) {\r\n    var v = dep.id\r\n    var nbhd = Object.keys(dep.deps)\r\n    index[dep.id] = dep\r\n    inDegree[v] = nbhd.length\r\n    nbhd.forEach(function (filename) {\r\n      var u = dep.deps[filename]\r\n      if (adj[u]) {\r\n        adj[u].push(v)\r\n      } else {\r\n        adj[u] = [v]\r\n      }\r\n    })\r\n  })\r\n\r\n  // Initialize toVisit queue\r\n  var result = []\r\n  var inverse = {}\r\n  deps.forEach(function (dep) {\r\n    var v = dep.id\r\n    if (!adj[v]) {\r\n      adj[v] = []\r\n    }\r\n    if (inDegree[v] === 0) {\r\n      inverse[v] = result.length\r\n      result.push(v)\r\n    }\r\n  })\r\n\r\n  // Run BFS\r\n  for (var ptr = 0; ptr < result.length; ptr++) {\r\n    var v = result[ptr]\r\n    adj[v].forEach(function (u) {\r\n      if (--inDegree[u] === 0) {\r\n        inverse[u] = result.length\r\n        result.push(u)\r\n      }\r\n    })\r\n  }\r\n\r\n  if (result.length !== deps.length) {\r\n    throw new Error('cyclic dependency')\r\n  }\r\n\r\n  // Relabel dependencies\r\n  return result.map(function (v) {\r\n    var dep = index[v]\r\n    var deps = dep.deps\r\n    var ndeps = {}\r\n    Object.keys(deps).forEach(function (filename) {\r\n      ndeps[filename] = inverse[deps[filename]] | 0\r\n    })\r\n    return {\r\n      id: inverse[v] | 0,\r\n      deps: ndeps,\r\n      file: dep.file,\r\n      source: dep.source,\r\n      entry: dep.entry\r\n    }\r\n  })\r\n}\r\n","module.exports = function (obj) {\n    if (!obj || typeof obj !== 'object') return obj;\n    \n    var copy;\n    \n    if (isArray(obj)) {\n        var len = obj.length;\n        copy = Array(len);\n        for (var i = 0; i < len; i++) {\n            copy[i] = obj[i];\n        }\n    }\n    else {\n        var keys = objectKeys(obj);\n        copy = {};\n        \n        for (var i = 0, l = keys.length; i < l; i++) {\n            var key = keys[i];\n            copy[key] = obj[key];\n        }\n    }\n    return copy;\n};\n\nvar objectKeys = Object.keys || function (obj) {\n    var keys = [];\n    for (var key in obj) {\n        if ({}.hasOwnProperty.call(obj, key)) keys.push(key);\n    }\n    return keys;\n};\n\nvar isArray = Array.isArray || function (xs) {\n    return {}.toString.call(xs) === '[object Array]';\n};\n","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}","import _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","import getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport isNativeReflectConstruct from \"@babel/runtime/helpers/esm/isNativeReflectConstruct\";\nimport possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nexport default function _createSuper(Derived) {\n  var hasNativeReflectConstruct = isNativeReflectConstruct();\n  return function _createSuperInternal() {\n    var Super = getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = getPrototypeOf(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return possibleConstructorReturn(this, result);\n  };\n}","export default function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}","import superPropBase from \"@babel/runtime/helpers/esm/superPropBase\";\nexport default function _get(target, property, receiver) {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}","import getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nexport default function _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"@babel/runtime/helpers/esm/setPrototypeOf\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}"],"sourceRoot":""}