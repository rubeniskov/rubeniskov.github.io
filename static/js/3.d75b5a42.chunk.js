(this["webpackJsonprubeniskov-website"]=this["webpackJsonprubeniskov-website"]||[]).push([[3],{770:function(e,t){e.exports=function(e){for(var t=[],r=0;r<e.length;r++)"eof"!==e[r].type&&t.push(e[r].data);return t.join("")}},771:function(e,t){e.exports=function(e){for(var t=!1,r=0,n=0;n<e.length;n++)switch(t=t||"keyword"===e[n].type&&"for"===e[n].data,e[n].data){case"(":e[n].depth=t?r++:r;break;case"{":e[n].depth=t?r:r++,t=!1;break;case"}":e[n].depth=--r;break;default:e[n].depth=r}for(n=0;n<e.length;n++){var a=e[n],i=n+1;if(("ident"===a.type||"keyword"===a.type)&&(f(),"ident"===e[i].type&&(f(),i++,"("===e[i].data))){for(;e[i]&&";"!==e[i].data&&"{"!==e[i].data;)e[i++].depth++;e[i]&&"{"===e[i].data&&e[i].depth++}}return e;function f(){for(;e[i]&&("whitespace"===e[i].type||"["===e[i].data||"]"===e[i].data||"integer"===e[i].data);)i++}}},772:function(e,t){e.exports=function(e){var t=[0],r=t[0],n=0;if(!e||!e.length)return e;if(!("depth"in e[0]))throw new Error("glsl-token-scope: No scope depth defined on tokens! Use glsl-token-depth on these tokens first");for(var a=0;a<e.length;a++){var i=e[a],f=i.depth;f>n?t.push(++r):f<n&&t.splice(-1,1),i.scope=t[t.length-1],i.stack=t.slice(),n=i.depth}return e}},774:function(e,t,r){e.exports=function(){"use strict";var e=function(e,t){for(var r=Object.keys(t),n=0;n<r.length;++n)e[r[n]]=t[r[n]];return e},t=0,r=0,n=5,a=6;function i(e,r){this.id=t++,this.type=e,this.data=r}function f(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function o(e){if(0===e.length)return[];var t=e.charAt(0),r=e.charAt(e.length-1);if(e.length>1&&t===r&&('"'===t||"'"===t))return['"'+f(e.substr(1,e.length-2))+'"'];var n=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(e);if(n)return o(e.substr(0,n.index)).concat(o(n[1])).concat(o(e.substr(n.index+n[0].length)));var a=e.split(".");if(1===a.length)return['"'+f(e)+'"'];for(var i=[],u=0;u<a.length;++u)i=i.concat(o(a[u]));return i}function u(e){return"["+o(e).join("][")+"]"}function s(e,t){return new i(e,u(t+""))}function c(e){return"function"===typeof e&&!e._reglType||e instanceof i}function l(e,t){return"function"===typeof e?new i(r,e):"number"===typeof e||"boolean"===typeof e?new i(n,e):Array.isArray(e)?new i(a,e.map((function(e,r){return l(e,t+"["+r+"]")}))):e instanceof i?e:void 0}var p={DynamicVariable:i,define:s,isDynamic:c,unbox:l,accessor:u},d={next:"function"===typeof requestAnimationFrame?function(e){return requestAnimationFrame(e)}:function(e){return setTimeout(e,16)},cancel:"function"===typeof cancelAnimationFrame?function(e){return cancelAnimationFrame(e)}:clearTimeout},h="undefined"!==typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function v(){var e={"":0},t=[""];return{id:function(r){var n=e[r];return n||(n=e[r]=t.length,t.push(r),n)},str:function(e){return t[e]}}}function m(t,r,n){var a,i=document.createElement("canvas");function f(){var r=window.innerWidth,a=window.innerHeight;if(t!==document.body){var f=t.getBoundingClientRect();r=f.right-f.left,a=f.bottom-f.top}i.width=n*r,i.height=n*a,e(i.style,{width:r+"px",height:a+"px"})}function o(){a?a.disconnect():window.removeEventListener("resize",f),t.removeChild(i)}return e(i.style,{border:0,margin:0,padding:0,top:0,left:0}),t.appendChild(i),t===document.body&&(i.style.position="absolute",e(t.style,{margin:0,padding:0})),t!==document.body&&"function"===typeof ResizeObserver?(a=new ResizeObserver((function(){setTimeout(f)}))).observe(t):window.addEventListener("resize",f,!1),f(),{canvas:i,onDestroy:o}}function b(e,t){function r(r){try{return e.getContext(r,t)}catch(n){return null}}return r("webgl")||r("experimental-webgl")||r("webgl-experimental")}function g(e){return"string"===typeof e.nodeName&&"function"===typeof e.appendChild&&"function"===typeof e.getBoundingClientRect}function y(e){return"function"===typeof e.drawArrays||"function"===typeof e.drawElements}function x(e){return"string"===typeof e?e.split():e}function w(e){return"string"===typeof e?document.querySelector(e):e}function A(e){var t,r,n,a,i=e||{},f={},o=[],u=[],s="undefined"===typeof window?1:window.devicePixelRatio,c=!1,l=function(e){},p=function(){};if("string"===typeof i?t=document.querySelector(i):"object"===typeof i&&(g(i)?t=i:y(i)?n=(a=i).canvas:("gl"in i?a=i.gl:"canvas"in i?n=w(i.canvas):"container"in i&&(r=w(i.container)),"attributes"in i&&(f=i.attributes),"extensions"in i&&(o=x(i.extensions)),"optionalExtensions"in i&&(u=x(i.optionalExtensions)),"onDone"in i&&(l=i.onDone),"profile"in i&&(c=!!i.profile),"pixelRatio"in i&&(s=+i.pixelRatio))),t&&("canvas"===t.nodeName.toLowerCase()?n=t:r=t),!a){if(!n){var d=m(r||document.body,l,s);if(!d)return null;n=d.canvas,p=d.onDestroy}void 0===f.premultipliedAlpha&&(f.premultipliedAlpha=!0),a=b(n,f)}return a?{gl:a,canvas:n,container:r,extensions:o,optionalExtensions:u,pixelRatio:s,profile:c,onDone:l,onDestroy:p}:(p(),l("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function k(e,t){var r={};function n(t){var n,a=t.toLowerCase();try{n=r[a]=e.getExtension(a)}catch(i){}return!!n}for(var a=0;a<t.extensions.length;++a){var i=t.extensions[a];if(!n(i))return t.onDestroy(),t.onDone('"'+i+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return t.optionalExtensions.forEach(n),{extensions:r,restore:function(){Object.keys(r).forEach((function(e){if(r[e]&&!n(e))throw new Error("(regl): error restoring extension "+e)}))}}}function E(e,t){for(var r=Array(e),n=0;n<e;++n)r[n]=t(n);return r}var O=5120,_=5121,D=5122,T=5123,S=5124,C=5125,j=5126;function V(e){for(var t=16;t<=1<<28;t*=16)if(e<=t)return t;return 0}function F(e){var t,r;return t=(e>65535)<<4,t|=r=((e>>>=t)>255)<<3,t|=r=((e>>>=r)>15)<<2,(t|=r=((e>>>=r)>3)<<1)|(e>>>=r)>>1}function B(){var e=E(8,(function(){return[]}));function t(t){var r=V(t),n=e[F(r)>>2];return n.length>0?n.pop():new ArrayBuffer(r)}function r(t){e[F(t.byteLength)>>2].push(t)}function n(e,r){var n=null;switch(e){case O:n=new Int8Array(t(r),0,r);break;case _:n=new Uint8Array(t(r),0,r);break;case D:n=new Int16Array(t(2*r),0,r);break;case T:n=new Uint16Array(t(2*r),0,r);break;case S:n=new Int32Array(t(4*r),0,r);break;case C:n=new Uint32Array(t(4*r),0,r);break;case j:n=new Float32Array(t(4*r),0,r);break;default:return null}return n.length!==r?n.subarray(0,r):n}function a(e){r(e.buffer)}return{alloc:t,free:r,allocType:n,freeType:a}}var z=B();z.zero=B();var I=3408,P=3410,L=3411,M=3412,R=3413,U=3414,H=3415,N=33901,W=33902,Q=3379,q=3386,G=34921,Y=36347,$=36348,X=35661,J=35660,K=34930,Z=36349,ee=34076,te=34024,re=7936,ne=7937,ae=7938,ie=35724,fe=34047,oe=36063,ue=34852,se=3553,ce=34067,le=34069,pe=33984,de=6408,he=5126,ve=5121,me=36160,be=36053,ge=36064,ye=16384,xe=function(e,t){var r=1;t.ext_texture_filter_anisotropic&&(r=e.getParameter(fe));var n=1,a=1;t.webgl_draw_buffers&&(n=e.getParameter(ue),a=e.getParameter(oe));var i=!!t.oes_texture_float;if(i){var f=e.createTexture();e.bindTexture(se,f),e.texImage2D(se,0,de,1,1,0,de,he,null);var o=e.createFramebuffer();if(e.bindFramebuffer(me,o),e.framebufferTexture2D(me,ge,se,f,0),e.bindTexture(se,null),e.checkFramebufferStatus(me)!==be)i=!1;else{e.viewport(0,0,1,1),e.clearColor(1,0,0,1),e.clear(ye);var u=z.allocType(he,4);e.readPixels(0,0,1,1,de,he,u),e.getError()?i=!1:(e.deleteFramebuffer(o),e.deleteTexture(f),i=1===u[0]),z.freeType(u)}}var s=!0;if("undefined"===typeof navigator||!(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))){var c=e.createTexture(),l=z.allocType(ve,36);e.activeTexture(pe),e.bindTexture(ce,c),e.texImage2D(le,0,de,3,3,0,de,ve,l),z.freeType(l),e.bindTexture(ce,null),e.deleteTexture(c),s=!e.getError()}return{colorBits:[e.getParameter(P),e.getParameter(L),e.getParameter(M),e.getParameter(R)],depthBits:e.getParameter(U),stencilBits:e.getParameter(H),subpixelBits:e.getParameter(I),extensions:Object.keys(t).filter((function(e){return!!t[e]})),maxAnisotropic:r,maxDrawbuffers:n,maxColorAttachments:a,pointSizeDims:e.getParameter(N),lineWidthDims:e.getParameter(W),maxViewportDims:e.getParameter(q),maxCombinedTextureUnits:e.getParameter(X),maxCubeMapSize:e.getParameter(ee),maxRenderbufferSize:e.getParameter(te),maxTextureUnits:e.getParameter(K),maxTextureSize:e.getParameter(Q),maxAttributes:e.getParameter(G),maxVertexUniforms:e.getParameter(Y),maxVertexTextureUnits:e.getParameter(J),maxVaryingVectors:e.getParameter($),maxFragmentUniforms:e.getParameter(Z),glsl:e.getParameter(ie),renderer:e.getParameter(ne),vendor:e.getParameter(re),version:e.getParameter(ae),readFloat:i,npotTextureCube:s}},we=function(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array||e instanceof Uint8ClampedArray};function Ae(e){return!!e&&"object"===typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"===typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||we(e.data))}var ke=function(e){return Object.keys(e).map((function(t){return e[t]}))},Ee={shape:Ce,flatten:Se};function Oe(e,t,r){for(var n=0;n<t;++n)r[n]=e[n]}function _e(e,t,r,n){for(var a=0,i=0;i<t;++i)for(var f=e[i],o=0;o<r;++o)n[a++]=f[o]}function De(e,t,r,n,a,i){for(var f=i,o=0;o<t;++o)for(var u=e[o],s=0;s<r;++s)for(var c=u[s],l=0;l<n;++l)a[f++]=c[l]}function Te(e,t,r,n,a){for(var i=1,f=r+1;f<t.length;++f)i*=t[f];var o=t[r];if(t.length-r===4){var u=t[r+1],s=t[r+2],c=t[r+3];for(f=0;f<o;++f)De(e[f],u,s,c,n,a),a+=i}else for(f=0;f<o;++f)Te(e[f],t,r+1,n,a),a+=i}function Se(e,t,r,n){var a=1;if(t.length)for(var i=0;i<t.length;++i)a*=t[i];else a=0;var f=n||z.allocType(r,a);switch(t.length){case 0:break;case 1:Oe(e,t[0],f);break;case 2:_e(e,t[0],t[1],f);break;case 3:De(e,t[0],t[1],t[2],f,0);break;default:Te(e,t,0,f,0)}return f}function Ce(e){for(var t=[],r=e;r.length;r=r[0])t.push(r.length);return t}var je={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Ve={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},Fe={dynamic:35048,stream:35040,static:35044},Be=Ee.flatten,ze=Ee.shape,Ie=35044,Pe=35040,Le=5121,Me=5126,Re=[];function Ue(e){return 0|je[Object.prototype.toString.call(e)]}function He(e,t){for(var r=0;r<t.length;++r)e[r]=t[r]}function Ne(e,t,r,n,a,i,f){for(var o=0,u=0;u<r;++u)for(var s=0;s<n;++s)e[o++]=t[a*u+i*s+f]}function We(e,t,r,n){var a=0,i={};function f(t){this.id=a++,this.buffer=e.createBuffer(),this.type=t,this.usage=Ie,this.byteLength=0,this.dimension=1,this.dtype=Le,this.persistentData=null,r.profile&&(this.stats={size:0})}f.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},f.prototype.destroy=function(){p(this)};var o=[];function u(e,t){var r=o.pop();return r||(r=new f(e)),r.bind(),l(r,t,Pe,0,1,!1),r}function s(e){o.push(e)}function c(t,r,n){t.byteLength=r.byteLength,e.bufferData(t.type,r,n)}function l(e,t,r,n,a,i){var f,o;if(e.usage=r,Array.isArray(t)){if(e.dtype=n||Me,t.length>0)if(Array.isArray(t[0])){f=ze(t);for(var u=1,s=1;s<f.length;++s)u*=f[s];e.dimension=u,c(e,o=Be(t,f,e.dtype),r),i?e.persistentData=o:z.freeType(o)}else if("number"===typeof t[0]){e.dimension=a;var l=z.allocType(e.dtype,t.length);He(l,t),c(e,l,r),i?e.persistentData=l:z.freeType(l)}else we(t[0])&&(e.dimension=t[0].length,e.dtype=n||Ue(t[0])||Me,c(e,o=Be(t,[t.length,t[0].length],e.dtype),r),i?e.persistentData=o:z.freeType(o))}else if(we(t))e.dtype=n||Ue(t),e.dimension=a,c(e,t,r),i&&(e.persistentData=new Uint8Array(new Uint8Array(t.buffer)));else if(Ae(t)){f=t.shape;var p=t.stride,d=t.offset,h=0,v=0,m=0,b=0;1===f.length?(h=f[0],v=1,m=p[0],b=0):2===f.length&&(h=f[0],v=f[1],m=p[0],b=p[1]),e.dtype=n||Ue(t.data)||Me,e.dimension=v;var g=z.allocType(e.dtype,h*v);Ne(g,t.data,h,v,m,b,d),c(e,g,r),i?e.persistentData=g:z.freeType(g)}else t instanceof ArrayBuffer&&(e.dtype=Le,e.dimension=a,c(e,t,r),i&&(e.persistentData=new Uint8Array(new Uint8Array(t))))}function p(r){t.bufferCount--,n(r);var a=r.buffer;e.deleteBuffer(a),r.buffer=null,delete i[r.id]}function d(n,a,o,u){t.bufferCount++;var s=new f(a);function c(t){var n=Ie,a=null,i=0,f=0,o=1;return Array.isArray(t)||we(t)||Ae(t)||t instanceof ArrayBuffer?a=t:"number"===typeof t?i=0|t:t&&("data"in t&&(a=t.data),"usage"in t&&(n=Fe[t.usage]),"type"in t&&(f=Ve[t.type]),"dimension"in t&&(o=0|t.dimension),"length"in t&&(i=0|t.length)),s.bind(),a?l(s,a,n,f,o,u):(i&&e.bufferData(s.type,i,n),s.dtype=f||Le,s.usage=n,s.dimension=o,s.byteLength=i),r.profile&&(s.stats.size=s.byteLength*Re[s.dtype]),c}function d(t,r){e.bufferSubData(s.type,r,t)}function h(e,t){var r,n=0|(t||0);if(s.bind(),we(e)||e instanceof ArrayBuffer)d(e,n);else if(Array.isArray(e)){if(e.length>0)if("number"===typeof e[0]){var a=z.allocType(s.dtype,e.length);He(a,e),d(a,n),z.freeType(a)}else if(Array.isArray(e[0])||we(e[0])){r=ze(e);var i=Be(e,r,s.dtype);d(i,n),z.freeType(i)}}else if(Ae(e)){r=e.shape;var f=e.stride,o=0,u=0,l=0,p=0;1===r.length?(o=r[0],u=1,l=f[0],p=0):2===r.length&&(o=r[0],u=r[1],l=f[0],p=f[1]);var h=Array.isArray(e.data)?s.dtype:Ue(e.data),v=z.allocType(h,o*u);Ne(v,e.data,o,u,l,p,e.offset),d(v,n),z.freeType(v)}return c}return i[s.id]=s,o||c(n),c._reglType="buffer",c._buffer=s,c.subdata=h,r.profile&&(c.stats=s.stats),c.destroy=function(){p(s)},c}function h(){ke(i).forEach((function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)}))}return r.profile&&(t.getTotalBufferSize=function(){var e=0;return Object.keys(i).forEach((function(t){e+=i[t].stats.size})),e}),{create:d,createStream:u,destroyStream:s,clear:function(){ke(i).forEach(p),o.forEach(p)},getBuffer:function(e){return e&&e._buffer instanceof f?e._buffer:null},restore:h,_initBuffer:l}}Re[5120]=1,Re[5122]=2,Re[5124]=4,Re[5121]=1,Re[5123]=2,Re[5125]=4,Re[5126]=4;var Qe={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},qe=0,Ge=1,Ye=4,$e=5120,Xe=5121,Je=5122,Ke=5123,Ze=5124,et=5125,tt=34963,rt=35040,nt=35044;function at(e,t,r,n){var a={},i=0,f={uint8:Xe,uint16:Ke};function o(e){this.id=i++,a[this.id]=this,this.buffer=e,this.primType=Ye,this.vertCount=0,this.type=0}t.oes_element_index_uint&&(f.uint32=et),o.prototype.bind=function(){this.buffer.bind()};var u=[];function s(e){var t=u.pop();return t||(t=new o(r.create(null,tt,!0,!1)._buffer)),l(t,e,rt,-1,-1,0,0),t}function c(e){u.push(e)}function l(n,a,i,f,o,u,s){var c;if(n.buffer.bind(),a){var l=s;s||we(a)&&(!Ae(a)||we(a.data))||(l=t.oes_element_index_uint?et:Ke),r._initBuffer(n.buffer,a,i,l,3)}else e.bufferData(tt,u,i),n.buffer.dtype=c||Xe,n.buffer.usage=i,n.buffer.dimension=3,n.buffer.byteLength=u;if(c=s,!s){switch(n.buffer.dtype){case Xe:case $e:c=Xe;break;case Ke:case Je:c=Ke;break;case et:case Ze:c=et}n.buffer.dtype=c}n.type=c;var p=o;p<0&&(p=n.buffer.byteLength,c===Ke?p>>=1:c===et&&(p>>=2)),n.vertCount=p;var d=f;if(f<0){d=Ye;var h=n.buffer.dimension;1===h&&(d=qe),2===h&&(d=Ge),3===h&&(d=Ye)}n.primType=d}function p(e){n.elementsCount--,delete a[e.id],e.buffer.destroy(),e.buffer=null}function d(e,t){var a=r.create(null,tt,!0),i=new o(a._buffer);function u(e){if(e)if("number"===typeof e)a(e),i.primType=Ye,i.vertCount=0|e,i.type=Xe;else{var t=null,r=nt,n=-1,o=-1,s=0,c=0;Array.isArray(e)||we(e)||Ae(e)?t=e:("data"in e&&(t=e.data),"usage"in e&&(r=Fe[e.usage]),"primitive"in e&&(n=Qe[e.primitive]),"count"in e&&(o=0|e.count),"type"in e&&(c=f[e.type]),"length"in e?s=0|e.length:(s=o,c===Ke||c===Je?s*=2:c!==et&&c!==Ze||(s*=4))),l(i,t,r,n,o,s,c)}else a(),i.primType=Ye,i.vertCount=0,i.type=Xe;return u}return n.elementsCount++,u(e),u._reglType="elements",u._elements=i,u.subdata=function(e,t){return a.subdata(e,t),u},u.destroy=function(){p(i)},u}return{create:d,createStream:s,destroyStream:c,getElements:function(e){return"function"===typeof e&&e._elements instanceof o?e._elements:null},clear:function(){ke(a).forEach(p)}}}var it=new Float32Array(1),ft=new Uint32Array(it.buffer),ot=5123;function ut(e){for(var t=z.allocType(ot,e.length),r=0;r<e.length;++r)if(isNaN(e[r]))t[r]=65535;else if(e[r]===1/0)t[r]=31744;else if(e[r]===-1/0)t[r]=64512;else{it[0]=e[r];var n=ft[0],a=n>>>31<<15,i=(n<<1>>>24)-127,f=n>>13&1023;if(i<-24)t[r]=a;else if(i<-14){var o=-14-i;t[r]=a+(f+1024>>o)}else t[r]=i>15?a+31744:a+(i+15<<10)+f}return t}function st(e){return Array.isArray(e)||we(e)}var ct=34467,lt=3553,pt=34067,dt=34069,ht=6408,vt=6406,mt=6407,bt=6409,gt=6410,yt=32854,xt=32855,wt=36194,At=32819,kt=32820,Et=33635,Ot=34042,_t=6402,Dt=34041,Tt=35904,St=35906,Ct=36193,jt=33776,Vt=33777,Ft=33778,Bt=33779,zt=35986,It=35987,Pt=34798,Lt=35840,Mt=35841,Rt=35842,Ut=35843,Ht=36196,Nt=5121,Wt=5123,Qt=5125,qt=5126,Gt=10242,Yt=10243,$t=10497,Xt=33071,Jt=33648,Kt=10240,Zt=10241,er=9728,tr=9729,rr=9984,nr=9985,ar=9986,ir=9987,fr=33170,or=4352,ur=4353,sr=4354,cr=34046,lr=3317,pr=37440,dr=37441,hr=37443,vr=37444,mr=33984,br=[rr,ar,nr,ir],gr=[0,bt,gt,mt,ht],yr={};function xr(e){return"[object "+e+"]"}yr[bt]=yr[vt]=yr[_t]=1,yr[Dt]=yr[gt]=2,yr[mt]=yr[Tt]=3,yr[ht]=yr[St]=4;var wr=xr("HTMLCanvasElement"),Ar=xr("OffscreenCanvas"),kr=xr("CanvasRenderingContext2D"),Er=xr("ImageBitmap"),Or=xr("HTMLImageElement"),_r=xr("HTMLVideoElement"),Dr=Object.keys(je).concat([wr,Ar,kr,Er,Or,_r]),Tr=[];Tr[Nt]=1,Tr[qt]=4,Tr[Ct]=2,Tr[Wt]=2,Tr[Qt]=4;var Sr=[];function Cr(e){return Array.isArray(e)&&(0===e.length||"number"===typeof e[0])}function jr(e){return!!Array.isArray(e)&&!(0===e.length||!st(e[0]))}function Vr(e){return Object.prototype.toString.call(e)}function Fr(e){return Vr(e)===wr}function Br(e){return Vr(e)===Ar}function zr(e){return Vr(e)===kr}function Ir(e){return Vr(e)===Er}function Pr(e){return Vr(e)===Or}function Lr(e){return Vr(e)===_r}function Mr(e){if(!e)return!1;var t=Vr(e);return Dr.indexOf(t)>=0||Cr(e)||jr(e)||Ae(e)}function Rr(e){return 0|je[Object.prototype.toString.call(e)]}function Ur(e,t){var r=t.length;switch(e.type){case Nt:case Wt:case Qt:case qt:var n=z.allocType(e.type,r);n.set(t),e.data=n;break;case Ct:e.data=ut(t)}}function Hr(e,t){return z.allocType(e.type===Ct?qt:e.type,t)}function Nr(e,t){e.type===Ct?(e.data=ut(t),z.freeType(t)):e.data=t}function Wr(e,t,r,n,a,i){for(var f=e.width,o=e.height,u=e.channels,s=Hr(e,f*o*u),c=0,l=0;l<o;++l)for(var p=0;p<f;++p)for(var d=0;d<u;++d)s[c++]=t[r*p+n*l+a*d+i];Nr(e,s)}function Qr(e,t,r,n,a,i){var f;if(f="undefined"!==typeof Sr[e]?Sr[e]:yr[e]*Tr[t],i&&(f*=6),a){for(var o=0,u=r;u>=1;)o+=f*u*u,u/=2;return o}return f*r*n}function qr(t,r,n,a,i,f,o){var u={"don't care":or,"dont care":or,nice:sr,fast:ur},s={repeat:$t,clamp:Xt,mirror:Jt},c={nearest:er,linear:tr},l=e({mipmap:ir,"nearest mipmap nearest":rr,"linear mipmap nearest":nr,"nearest mipmap linear":ar,"linear mipmap linear":ir},c),p={none:0,browser:vr},d={uint8:Nt,rgba4:At,rgb565:Et,"rgb5 a1":kt},h={alpha:vt,luminance:bt,"luminance alpha":gt,rgb:mt,rgba:ht,rgba4:yt,"rgb5 a1":xt,rgb565:wt},v={};r.ext_srgb&&(h.srgb=Tt,h.srgba=St),r.oes_texture_float&&(d.float32=d.float=qt),r.oes_texture_half_float&&(d.float16=d["half float"]=Ct),r.webgl_depth_texture&&(e(h,{depth:_t,"depth stencil":Dt}),e(d,{uint16:Wt,uint32:Qt,"depth stencil":Ot})),r.webgl_compressed_texture_s3tc&&e(v,{"rgb s3tc dxt1":jt,"rgba s3tc dxt1":Vt,"rgba s3tc dxt3":Ft,"rgba s3tc dxt5":Bt}),r.webgl_compressed_texture_atc&&e(v,{"rgb atc":zt,"rgba atc explicit alpha":It,"rgba atc interpolated alpha":Pt}),r.webgl_compressed_texture_pvrtc&&e(v,{"rgb pvrtc 4bppv1":Lt,"rgb pvrtc 2bppv1":Mt,"rgba pvrtc 4bppv1":Rt,"rgba pvrtc 2bppv1":Ut}),r.webgl_compressed_texture_etc1&&(v["rgb etc1"]=Ht);var m=Array.prototype.slice.call(t.getParameter(ct));Object.keys(v).forEach((function(e){var t=v[e];m.indexOf(t)>=0&&(h[e]=t)}));var b=Object.keys(h);n.textureFormats=b;var g=[];Object.keys(h).forEach((function(e){var t=h[e];g[t]=e}));var y=[];Object.keys(d).forEach((function(e){var t=d[e];y[t]=e}));var x=[];Object.keys(c).forEach((function(e){var t=c[e];x[t]=e}));var w=[];Object.keys(l).forEach((function(e){var t=l[e];w[t]=e}));var A=[];Object.keys(s).forEach((function(e){var t=s[e];A[t]=e}));var k=b.reduce((function(e,t){var n=h[t];return n===bt||n===vt||n===bt||n===gt||n===_t||n===Dt||r.ext_srgb&&(n===Tt||n===St)?e[n]=n:n===xt||t.indexOf("rgba")>=0?e[n]=ht:e[n]=mt,e}),{});function E(){this.internalformat=ht,this.format=ht,this.type=Nt,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=vr,this.width=0,this.height=0,this.channels=0}function O(e,t){e.internalformat=t.internalformat,e.format=t.format,e.type=t.type,e.compressed=t.compressed,e.premultiplyAlpha=t.premultiplyAlpha,e.flipY=t.flipY,e.unpackAlignment=t.unpackAlignment,e.colorSpace=t.colorSpace,e.width=t.width,e.height=t.height,e.channels=t.channels}function _(e,t){if("object"===typeof t&&t){if("premultiplyAlpha"in t&&(e.premultiplyAlpha=t.premultiplyAlpha),"flipY"in t&&(e.flipY=t.flipY),"alignment"in t&&(e.unpackAlignment=t.alignment),"colorSpace"in t&&(e.colorSpace=p[t.colorSpace]),"type"in t){var r=t.type;e.type=d[r]}var n=e.width,a=e.height,i=e.channels,f=!1;"shape"in t?(n=t.shape[0],a=t.shape[1],3===t.shape.length&&(i=t.shape[2],f=!0)):("radius"in t&&(n=a=t.radius),"width"in t&&(n=t.width),"height"in t&&(a=t.height),"channels"in t&&(i=t.channels,f=!0)),e.width=0|n,e.height=0|a,e.channels=0|i;var o=!1;if("format"in t){var u=t.format,s=e.internalformat=h[u];e.format=k[s],u in d&&("type"in t||(e.type=d[u])),u in v&&(e.compressed=!0),o=!0}!f&&o?e.channels=yr[e.format]:f&&!o&&e.channels!==gr[e.format]&&(e.format=e.internalformat=gr[e.channels])}}function D(e){t.pixelStorei(pr,e.flipY),t.pixelStorei(dr,e.premultiplyAlpha),t.pixelStorei(hr,e.colorSpace),t.pixelStorei(lr,e.unpackAlignment)}function T(){E.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function S(e,t){var r=null;if(Mr(t)?r=t:t&&(_(e,t),"x"in t&&(e.xOffset=0|t.x),"y"in t&&(e.yOffset=0|t.y),Mr(t.data)&&(r=t.data)),t.copy){var n=i.viewportWidth,a=i.viewportHeight;e.width=e.width||n-e.xOffset,e.height=e.height||a-e.yOffset,e.needsCopy=!0}else if(r){if(we(r))e.channels=e.channels||4,e.data=r,"type"in t||e.type!==Nt||(e.type=Rr(r));else if(Cr(r))e.channels=e.channels||4,Ur(e,r),e.alignment=1,e.needsFree=!0;else if(Ae(r)){var f=r.data;Array.isArray(f)||e.type!==Nt||(e.type=Rr(f));var o,u,s,c,l,p,d=r.shape,h=r.stride;3===d.length?(s=d[2],p=h[2]):(s=1,p=1),o=d[0],u=d[1],c=h[0],l=h[1],e.alignment=1,e.width=o,e.height=u,e.channels=s,e.format=e.internalformat=gr[s],e.needsFree=!0,Wr(e,f,c,l,p,r.offset)}else if(Fr(r)||Br(r)||zr(r))Fr(r)||Br(r)?e.element=r:e.element=r.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(Ir(r))e.element=r,e.width=r.width,e.height=r.height,e.channels=4;else if(Pr(r))e.element=r,e.width=r.naturalWidth,e.height=r.naturalHeight,e.channels=4;else if(Lr(r))e.element=r,e.width=r.videoWidth,e.height=r.videoHeight,e.channels=4;else if(jr(r)){var v=e.width||r[0].length,m=e.height||r.length,b=e.channels;b=st(r[0][0])?b||r[0][0].length:b||1;for(var g=Ee.shape(r),y=1,x=0;x<g.length;++x)y*=g[x];var w=Hr(e,y);Ee.flatten(r,g,"",w),Nr(e,w),e.alignment=1,e.width=v,e.height=m,e.channels=b,e.format=e.internalformat=gr[b],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4;e.type===qt||e.type}function C(e,r,n){var i=e.element,f=e.data,o=e.internalformat,u=e.format,s=e.type,c=e.width,l=e.height;D(e),i?t.texImage2D(r,n,u,u,s,i):e.compressed?t.compressedTexImage2D(r,n,o,c,l,0,f):e.needsCopy?(a(),t.copyTexImage2D(r,n,u,e.xOffset,e.yOffset,c,l,0)):t.texImage2D(r,n,u,c,l,0,u,s,f||null)}function j(e,r,n,i,f){var o=e.element,u=e.data,s=e.internalformat,c=e.format,l=e.type,p=e.width,d=e.height;D(e),o?t.texSubImage2D(r,f,n,i,c,l,o):e.compressed?t.compressedTexSubImage2D(r,f,n,i,s,p,d,u):e.needsCopy?(a(),t.copyTexSubImage2D(r,f,n,i,e.xOffset,e.yOffset,p,d)):t.texSubImage2D(r,f,n,i,p,d,c,l,u)}var V=[];function F(){return V.pop()||new T}function B(e){e.needsFree&&z.freeType(e.data),T.call(e),V.push(e)}function I(){E.call(this),this.genMipmaps=!1,this.mipmapHint=or,this.mipmask=0,this.images=Array(16)}function P(e,t,r){var n=e.images[0]=F();e.mipmask=1,n.width=e.width=t,n.height=e.height=r,n.channels=e.channels=4}function L(e,t){var r=null;if(Mr(t))O(r=e.images[0]=F(),e),S(r,t),e.mipmask=1;else if(_(e,t),Array.isArray(t.mipmap))for(var n=t.mipmap,a=0;a<n.length;++a)O(r=e.images[a]=F(),e),r.width>>=a,r.height>>=a,S(r,n[a]),e.mipmask|=1<<a;else O(r=e.images[0]=F(),e),S(r,t),e.mipmask=1;O(e,e.images[0]),e.compressed&&(e.internalformat===jt||e.internalformat===Vt||e.internalformat===Ft||e.internalformat)}function M(e,t){for(var r=e.images,n=0;n<r.length;++n){if(!r[n])return;C(r[n],t,n)}}var R=[];function U(){var e=R.pop()||new I;E.call(e),e.mipmask=0;for(var t=0;t<16;++t)e.images[t]=null;return e}function H(e){for(var t=e.images,r=0;r<t.length;++r)t[r]&&B(t[r]),t[r]=null;R.push(e)}function N(){this.minFilter=er,this.magFilter=er,this.wrapS=Xt,this.wrapT=Xt,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=or}function W(e,t){if("min"in t){var r=t.min;e.minFilter=l[r],br.indexOf(e.minFilter)>=0&&!("faces"in t)&&(e.genMipmaps=!0)}if("mag"in t){var n=t.mag;e.magFilter=c[n]}var a=e.wrapS,i=e.wrapT;if("wrap"in t){var f=t.wrap;"string"===typeof f?a=i=s[f]:Array.isArray(f)&&(a=s[f[0]],i=s[f[1]])}else{if("wrapS"in t){var o=t.wrapS;a=s[o]}if("wrapT"in t){var p=t.wrapT;i=s[p]}}if(e.wrapS=a,e.wrapT=i,"anisotropic"in t&&(t.anisotropic,e.anisotropic=t.anisotropic),"mipmap"in t){var d=!1;switch(typeof t.mipmap){case"string":e.mipmapHint=u[t.mipmap],e.genMipmaps=!0,d=!0;break;case"boolean":d=e.genMipmaps=t.mipmap;break;case"object":e.genMipmaps=!1,d=!0}d&&!("min"in t)&&(e.minFilter=rr)}}function Q(e,n){t.texParameteri(n,Zt,e.minFilter),t.texParameteri(n,Kt,e.magFilter),t.texParameteri(n,Gt,e.wrapS),t.texParameteri(n,Yt,e.wrapT),r.ext_texture_filter_anisotropic&&t.texParameteri(n,cr,e.anisotropic),e.genMipmaps&&(t.hint(fr,e.mipmapHint),t.generateMipmap(n))}var q=0,G={},Y=n.maxTextureUnits,$=Array(Y).map((function(){return null}));function X(e){E.call(this),this.mipmask=0,this.internalformat=ht,this.id=q++,this.refCount=1,this.target=e,this.texture=t.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new N,o.profile&&(this.stats={size:0})}function J(e){t.activeTexture(mr),t.bindTexture(e.target,e.texture)}function K(){var e=$[0];e?t.bindTexture(e.target,e.texture):t.bindTexture(lt,null)}function Z(e){var r=e.texture,n=e.unit,a=e.target;n>=0&&(t.activeTexture(mr+n),t.bindTexture(a,null),$[n]=null),t.deleteTexture(r),e.texture=null,e.params=null,e.pixels=null,e.refCount=0,delete G[e.id],f.textureCount--}function ee(e,r){var n=new X(lt);function a(e,t){var r=n.texInfo;N.call(r);var i=U();return"number"===typeof e?P(i,0|e,"number"===typeof t?0|t:0|e):e?(W(r,e),L(i,e)):P(i,1,1),r.genMipmaps&&(i.mipmask=(i.width<<1)-1),n.mipmask=i.mipmask,O(n,i),n.internalformat=i.internalformat,a.width=i.width,a.height=i.height,J(n),M(i,lt),Q(r,lt),K(),H(i),o.profile&&(n.stats.size=Qr(n.internalformat,n.type,i.width,i.height,r.genMipmaps,!1)),a.format=g[n.internalformat],a.type=y[n.type],a.mag=x[r.magFilter],a.min=w[r.minFilter],a.wrapS=A[r.wrapS],a.wrapT=A[r.wrapT],a}function i(e,t,r,i){var f=0|t,o=0|r,u=0|i,s=F();return O(s,n),s.width=0,s.height=0,S(s,e),s.width=s.width||(n.width>>u)-f,s.height=s.height||(n.height>>u)-o,J(n),j(s,lt,f,o,u),K(),B(s),a}function u(e,r){var i=0|e,f=0|r||i;if(i===n.width&&f===n.height)return a;a.width=n.width=i,a.height=n.height=f,J(n);for(var u=0;n.mipmask>>u;++u){var s=i>>u,c=f>>u;if(!s||!c)break;t.texImage2D(lt,u,n.format,s,c,0,n.format,n.type,null)}return K(),o.profile&&(n.stats.size=Qr(n.internalformat,n.type,i,f,!1,!1)),a}return G[n.id]=n,f.textureCount++,a(e,r),a.subimage=i,a.resize=u,a._reglType="texture2d",a._texture=n,o.profile&&(a.stats=n.stats),a.destroy=function(){n.decRef()},a}function te(e,r,n,a,i,u){var s=new X(pt);G[s.id]=s,f.cubeCount++;var c=new Array(6);function l(e,t,r,n,a,i){var f,u=s.texInfo;for(N.call(u),f=0;f<6;++f)c[f]=U();if("number"!==typeof e&&e){if("object"===typeof e)if(t)L(c[0],e),L(c[1],t),L(c[2],r),L(c[3],n),L(c[4],a),L(c[5],i);else if(W(u,e),_(s,e),"faces"in e){var p=e.faces;for(f=0;f<6;++f)O(c[f],s),L(c[f],p[f])}else for(f=0;f<6;++f)L(c[f],e)}else{var d=0|e||1;for(f=0;f<6;++f)P(c[f],d,d)}for(O(s,c[0]),u.genMipmaps?s.mipmask=(c[0].width<<1)-1:s.mipmask=c[0].mipmask,s.internalformat=c[0].internalformat,l.width=c[0].width,l.height=c[0].height,J(s),f=0;f<6;++f)M(c[f],dt+f);for(Q(u,pt),K(),o.profile&&(s.stats.size=Qr(s.internalformat,s.type,l.width,l.height,u.genMipmaps,!0)),l.format=g[s.internalformat],l.type=y[s.type],l.mag=x[u.magFilter],l.min=w[u.minFilter],l.wrapS=A[u.wrapS],l.wrapT=A[u.wrapT],f=0;f<6;++f)H(c[f]);return l}function p(e,t,r,n,a){var i=0|r,f=0|n,o=0|a,u=F();return O(u,s),u.width=0,u.height=0,S(u,t),u.width=u.width||(s.width>>o)-i,u.height=u.height||(s.height>>o)-f,J(s),j(u,dt+e,i,f,o),K(),B(u),l}function d(e){var r=0|e;if(r!==s.width){l.width=s.width=r,l.height=s.height=r,J(s);for(var n=0;n<6;++n)for(var a=0;s.mipmask>>a;++a)t.texImage2D(dt+n,a,s.format,r>>a,r>>a,0,s.format,s.type,null);return K(),o.profile&&(s.stats.size=Qr(s.internalformat,s.type,l.width,l.height,!1,!0)),l}}return l(e,r,n,a,i,u),l.subimage=p,l.resize=d,l._reglType="textureCube",l._texture=s,o.profile&&(l.stats=s.stats),l.destroy=function(){s.decRef()},l}function re(){for(var e=0;e<Y;++e)t.activeTexture(mr+e),t.bindTexture(lt,null),$[e]=null;ke(G).forEach(Z),f.cubeCount=0,f.textureCount=0}function ne(){for(var e=0;e<Y;++e){var r=$[e];r&&(r.bindCount=0,r.unit=-1,$[e]=null)}ke(G).forEach((function(e){e.texture=t.createTexture(),t.bindTexture(e.target,e.texture);for(var r=0;r<32;++r)if(0!==(e.mipmask&1<<r))if(e.target===lt)t.texImage2D(lt,r,e.internalformat,e.width>>r,e.height>>r,0,e.internalformat,e.type,null);else for(var n=0;n<6;++n)t.texImage2D(dt+n,r,e.internalformat,e.width>>r,e.height>>r,0,e.internalformat,e.type,null);Q(e.texInfo,e.target)}))}function ae(){for(var e=0;e<Y;++e){var r=$[e];r&&(r.bindCount=0,r.unit=-1,$[e]=null),t.activeTexture(mr+e),t.bindTexture(lt,null),t.bindTexture(pt,null)}}return e(X.prototype,{bind:function(){var e=this;e.bindCount+=1;var r=e.unit;if(r<0){for(var n=0;n<Y;++n){var a=$[n];if(a){if(a.bindCount>0)continue;a.unit=-1}$[n]=e,r=n;break}o.profile&&f.maxTextureUnits<r+1&&(f.maxTextureUnits=r+1),e.unit=r,t.activeTexture(mr+r),t.bindTexture(e.target,e.texture)}return r},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Z(this)}}),o.profile&&(f.getTotalTextureSize=function(){var e=0;return Object.keys(G).forEach((function(t){e+=G[t].stats.size})),e}),{create2D:ee,createCube:te,clear:re,getTexture:function(e){return null},restore:ne,refresh:ae}}Sr[yt]=2,Sr[xt]=2,Sr[wt]=2,Sr[Dt]=4,Sr[jt]=.5,Sr[Vt]=.5,Sr[Ft]=1,Sr[Bt]=1,Sr[zt]=.5,Sr[It]=1,Sr[Pt]=1,Sr[Lt]=.5,Sr[Mt]=.25,Sr[Rt]=.5,Sr[Ut]=.25,Sr[Ht]=.5;var Gr=36161,Yr=32854,$r=32855,Xr=36194,Jr=33189,Kr=36168,Zr=34041,en=35907,tn=34836,rn=34842,nn=34843,an=[];function fn(e,t,r){return an[e]*t*r}an[Yr]=2,an[$r]=2,an[Xr]=2,an[Jr]=2,an[Kr]=1,an[Zr]=4,an[en]=4,an[tn]=16,an[rn]=8,an[nn]=6;var on=function(e,t,r,n,a){var i={rgba4:Yr,rgb565:Xr,"rgb5 a1":$r,depth:Jr,stencil:Kr,"depth stencil":Zr};t.ext_srgb&&(i.srgba=en),t.ext_color_buffer_half_float&&(i.rgba16f=rn,i.rgb16f=nn),t.webgl_color_buffer_float&&(i.rgba32f=tn);var f=[];Object.keys(i).forEach((function(e){var t=i[e];f[t]=e}));var o=0,u={};function s(e){this.id=o++,this.refCount=1,this.renderbuffer=e,this.format=Yr,this.width=0,this.height=0,a.profile&&(this.stats={size:0})}function c(t){var r=t.renderbuffer;e.bindRenderbuffer(Gr,null),e.deleteRenderbuffer(r),t.renderbuffer=null,t.refCount=0,delete u[t.id],n.renderbufferCount--}function l(t,r){var o=new s(e.createRenderbuffer());function c(t,r){var n=0,u=0,s=Yr;if("object"===typeof t&&t){var l=t;if("shape"in l){var p=l.shape;n=0|p[0],u=0|p[1]}else"radius"in l&&(n=u=0|l.radius),"width"in l&&(n=0|l.width),"height"in l&&(u=0|l.height);"format"in l&&(s=i[l.format])}else"number"===typeof t?(n=0|t,u="number"===typeof r?0|r:n):t||(n=u=1);if(n!==o.width||u!==o.height||s!==o.format)return c.width=o.width=n,c.height=o.height=u,o.format=s,e.bindRenderbuffer(Gr,o.renderbuffer),e.renderbufferStorage(Gr,s,n,u),a.profile&&(o.stats.size=fn(o.format,o.width,o.height)),c.format=f[o.format],c}function l(t,r){var n=0|t,i=0|r||n;return n===o.width&&i===o.height||(c.width=o.width=n,c.height=o.height=i,e.bindRenderbuffer(Gr,o.renderbuffer),e.renderbufferStorage(Gr,o.format,n,i),a.profile&&(o.stats.size=fn(o.format,o.width,o.height))),c}return u[o.id]=o,n.renderbufferCount++,c(t,r),c.resize=l,c._reglType="renderbuffer",c._renderbuffer=o,a.profile&&(c.stats=o.stats),c.destroy=function(){o.decRef()},c}function p(){ke(u).forEach((function(t){t.renderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(Gr,t.renderbuffer),e.renderbufferStorage(Gr,t.format,t.width,t.height)})),e.bindRenderbuffer(Gr,null)}return s.prototype.decRef=function(){--this.refCount<=0&&c(this)},a.profile&&(n.getTotalRenderbufferSize=function(){var e=0;return Object.keys(u).forEach((function(t){e+=u[t].stats.size})),e}),{create:l,clear:function(){ke(u).forEach(c)},restore:p}},un=36160,sn=36161,cn=3553,ln=34069,pn=36064,dn=36096,hn=36128,vn=33306,mn=36193,bn=5121,gn=5126,yn=6407,xn=[];xn[6408]=4,xn[yn]=3;var wn=[];function An(t,r,n,a,i,f){var o={cur:null,next:null,dirty:!1,setFBO:null},u=["rgba"],s=["rgba4","rgb565","rgb5 a1"];r.ext_srgb&&s.push("srgba"),r.ext_color_buffer_half_float&&s.push("rgba16f","rgb16f"),r.webgl_color_buffer_float&&s.push("rgba32f");var c=["uint8"];function l(e,t,r){this.target=e,this.texture=t,this.renderbuffer=r;var n=0,a=0;t?(n=t.width,a=t.height):r&&(n=r.width,a=r.height),this.width=n,this.height=a}function p(e){e&&(e.texture&&e.texture._texture.decRef(),e.renderbuffer&&e.renderbuffer._renderbuffer.decRef())}function d(e,t,r){if(e)if(e.texture){var n=e.texture._texture;Math.max(1,n.width),Math.max(1,n.height),n.refCount+=1}else e.renderbuffer._renderbuffer.refCount+=1}function h(e,r){r&&(r.texture?t.framebufferTexture2D(un,e,r.target,r.texture._texture.texture,0):t.framebufferRenderbuffer(un,e,sn,r.renderbuffer._renderbuffer.renderbuffer))}function v(e){var t=cn,r=null,n=null,a=e;"object"===typeof e&&(a=e.data,"target"in e&&(t=0|e.target));var i=a._reglType;return"texture2d"===i||"textureCube"===i?r=a:"renderbuffer"===i&&(n=a,t=sn),new l(t,r,n)}function m(e,t,r,n,f){if(r){var o=a.create2D({width:e,height:t,format:n,type:f});return o._texture.refCount=0,new l(cn,o,null)}var u=i.create({width:e,height:t,format:n});return u._renderbuffer.refCount=0,new l(sn,null,u)}function b(e){return e&&(e.texture||e.renderbuffer)}function g(e,t,r){e&&(e.texture?e.texture.resize(t,r):e.renderbuffer&&e.renderbuffer.resize(t,r),e.width=t,e.height=r)}r.oes_texture_half_float&&c.push("half float","float16"),r.oes_texture_float&&c.push("float","float32");var y=0,x={};function w(){this.id=y++,x[this.id]=this,this.framebuffer=t.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function A(e){e.colorAttachments.forEach(p),p(e.depthAttachment),p(e.stencilAttachment),p(e.depthStencilAttachment)}function k(e){var r=e.framebuffer;t.deleteFramebuffer(r),e.framebuffer=null,f.framebufferCount--,delete x[e.id]}function E(e){var r;t.bindFramebuffer(un,e.framebuffer);var a=e.colorAttachments;for(r=0;r<a.length;++r)h(pn+r,a[r]);for(r=a.length;r<n.maxColorAttachments;++r)t.framebufferTexture2D(un,pn+r,cn,null,0);t.framebufferTexture2D(un,vn,cn,null,0),t.framebufferTexture2D(un,dn,cn,null,0),t.framebufferTexture2D(un,hn,cn,null,0),h(dn,e.depthAttachment),h(hn,e.stencilAttachment),h(vn,e.depthStencilAttachment),t.checkFramebufferStatus(un),t.isContextLost(),t.bindFramebuffer(un,o.next?o.next.framebuffer:null),o.cur=o.next,t.getError()}function O(t,r){var n=new w;function a(e,t){var r,i=0,f=0,o=!0,c=!0,l=null,p=!0,h="rgba",g="uint8",y=1,x=null,w=null,k=null,O=!1;if("number"===typeof e)i=0|e,f=0|t||i;else if(e){var _=e;if("shape"in _){var D=_.shape;i=D[0],f=D[1]}else"radius"in _&&(i=f=_.radius),"width"in _&&(i=_.width),"height"in _&&(f=_.height);("color"in _||"colors"in _)&&(l=_.color||_.colors,Array.isArray(l)),l||("colorCount"in _&&(y=0|_.colorCount),"colorTexture"in _&&(p=!!_.colorTexture,h="rgba4"),"colorType"in _&&(g=_.colorType,p||("half float"===g||"float16"===g?h="rgba16f":"float"!==g&&"float32"!==g||(h="rgba32f"))),"colorFormat"in _&&(h=_.colorFormat,u.indexOf(h)>=0?p=!0:s.indexOf(h)>=0&&(p=!1))),("depthTexture"in _||"depthStencilTexture"in _)&&(O=!(!_.depthTexture&&!_.depthStencilTexture)),"depth"in _&&("boolean"===typeof _.depth?o=_.depth:(x=_.depth,c=!1)),"stencil"in _&&("boolean"===typeof _.stencil?c=_.stencil:(w=_.stencil,o=!1)),"depthStencil"in _&&("boolean"===typeof _.depthStencil?o=c=_.depthStencil:(k=_.depthStencil,o=!1,c=!1))}else i=f=1;var T=null,S=null,C=null,j=null;if(Array.isArray(l))T=l.map(v);else if(l)T=[v(l)];else for(T=new Array(y),r=0;r<y;++r)T[r]=m(i,f,p,h,g);i=i||T[0].width,f=f||T[0].height,x?S=v(x):o&&!c&&(S=m(i,f,O,"depth","uint32")),w?C=v(w):c&&!o&&(C=m(i,f,!1,"stencil","uint8")),k?j=v(k):!x&&!w&&c&&o&&(j=m(i,f,O,"depth stencil","depth stencil"));var V=null;for(r=0;r<T.length;++r)if(d(T[r],i,f),T[r]&&T[r].texture){var F=xn[T[r].texture._texture.format]*wn[T[r].texture._texture.type];null===V&&(V=F)}return d(S,i,f),d(C,i,f),d(j,i,f),A(n),n.width=i,n.height=f,n.colorAttachments=T,n.depthAttachment=S,n.stencilAttachment=C,n.depthStencilAttachment=j,a.color=T.map(b),a.depth=b(S),a.stencil=b(C),a.depthStencil=b(j),a.width=n.width,a.height=n.height,E(n),a}function i(e,t){var r=Math.max(0|e,1),i=Math.max(0|t||r,1);if(r===n.width&&i===n.height)return a;for(var f=n.colorAttachments,o=0;o<f.length;++o)g(f[o],r,i);return g(n.depthAttachment,r,i),g(n.stencilAttachment,r,i),g(n.depthStencilAttachment,r,i),n.width=a.width=r,n.height=a.height=i,E(n),a}return f.framebufferCount++,a(t,r),e(a,{resize:i,_reglType:"framebuffer",_framebuffer:n,destroy:function(){k(n),A(n)},use:function(e){o.setFBO({framebuffer:a},e)}})}function _(t){var r=Array(6);function n(t){var i,f,o={color:null},u=0,s=null,c="rgba",l="uint8",p=1;if("number"===typeof t)u=0|t;else if(t){var d=t;"shape"in d?u=d.shape[0]:("radius"in d&&(u=0|d.radius),"width"in d?u=0|d.width:"height"in d&&(u=0|d.height)),("color"in d||"colors"in d)&&(s=d.color||d.colors,Array.isArray(s)),s||("colorCount"in d&&(p=0|d.colorCount),"colorType"in d&&(l=d.colorType),"colorFormat"in d&&(c=d.colorFormat)),"depth"in d&&(o.depth=d.depth),"stencil"in d&&(o.stencil=d.stencil),"depthStencil"in d&&(o.depthStencil=d.depthStencil)}else u=1;if(s)if(Array.isArray(s))for(f=[],i=0;i<s.length;++i)f[i]=s[i];else f=[s];else{f=Array(p);var h={radius:u,format:c,type:l};for(i=0;i<p;++i)f[i]=a.createCube(h)}for(o.color=Array(f.length),i=0;i<f.length;++i){var v=f[i];u=u||v.width,o.color[i]={target:ln,data:f[i]}}for(i=0;i<6;++i){for(var m=0;m<f.length;++m)o.color[m].target=ln+i;i>0&&(o.depth=r[0].depth,o.stencil=r[0].stencil,o.depthStencil=r[0].depthStencil),r[i]?r[i](o):r[i]=O(o)}return e(n,{width:u,height:u,color:f})}function i(e){var t,a=0|e;if(a===n.width)return n;var i=n.color;for(t=0;t<i.length;++t)i[t].resize(a);for(t=0;t<6;++t)r[t].resize(a);return n.width=n.height=a,n}return n(t),e(n,{faces:r,resize:i,_reglType:"framebufferCube",destroy:function(){r.forEach((function(e){e.destroy()}))}})}function D(){o.cur=null,o.next=null,o.dirty=!0,ke(x).forEach((function(e){e.framebuffer=t.createFramebuffer(),E(e)}))}return e(o,{getFramebuffer:function(e){if("function"===typeof e&&"framebuffer"===e._reglType){var t=e._framebuffer;if(t instanceof w)return t}return null},create:O,createCube:_,clear:function(){ke(x).forEach(k)},restore:D})}wn[bn]=1,wn[gn]=4,wn[mn]=2;var kn=5126,En=34962,On=34963;function _n(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=kn,this.offset=0,this.stride=0,this.divisor=0}function Dn(e,t,r,n,a,i,f){for(var o=r.maxAttributes,u=new Array(o),s=0;s<o;++s)u[s]=new _n;var c=0,l={},p={Record:_n,scope:{},state:u,currentVAO:null,targetVAO:null,restore:h()?w:function(){},createVAO:A,getVAO:m,destroyBuffer:d,setVAO:h()?b:g,clear:h()?y:function(){}};function d(t){for(var r=0;r<u.length;++r){var n=u[r];n.buffer===t&&(e.disableVertexAttribArray(r),n.buffer=null)}}function h(){return t.oes_vertex_array_object}function v(){return t.angle_instanced_arrays}function m(e){return"function"===typeof e&&e._vao?e._vao:null}function b(e){if(e!==p.currentVAO){var t=h();e?t.bindVertexArrayOES(e.vao):t.bindVertexArrayOES(null),p.currentVAO=e}}function g(t){if(t!==p.currentVAO){if(t)t.bindAttrs();else{for(var r=v(),n=0;n<u.length;++n){var a=u[n];a.buffer?(e.enableVertexAttribArray(n),a.buffer.bind(),e.vertexAttribPointer(n,a.size,a.type,a.normalized,a.stride,a.offfset),r&&a.divisor&&r.vertexAttribDivisorANGLE(n,a.divisor)):(e.disableVertexAttribArray(n),e.vertexAttrib4f(n,a.x,a.y,a.z,a.w))}f.elements?e.bindBuffer(On,f.elements.buffer.buffer):e.bindBuffer(On,null)}p.currentVAO=t}}function y(){ke(l).forEach((function(e){e.destroy()}))}function x(){this.id=++c,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var e=h();this.vao=e?e.createVertexArrayOES():null,l[this.id]=this,this.buffers=[]}function w(){h()&&ke(l).forEach((function(e){e.refresh()}))}function A(e){var t=new x;function r(e){var n;if(Array.isArray(e))n=e,t.elements&&t.ownsElements&&t.elements.destroy(),t.elements=null,t.ownsElements=!1,t.offset=0,t.count=0,t.instances=-1,t.primitive=4;else{if(e.elements){var f=e.elements;t.ownsElements?"function"===typeof f&&"elements"===f._reglType?(t.elements.destroy(),t.ownsElements=!1):(t.elements(f),t.ownsElements=!1):i.getElements(e.elements)?(t.elements=e.elements,t.ownsElements=!1):(t.elements=i.create(e.elements),t.ownsElements=!0)}else t.elements=null,t.ownsElements=!1;n=e.attributes,t.offset=0,t.count=-1,t.instances=-1,t.primitive=4,t.elements&&(t.count=t.elements._elements.vertCount,t.primitive=t.elements._elements.primType),"offset"in e&&(t.offset=0|e.offset),"count"in e&&(t.count=0|e.count),"instances"in e&&(t.instances=0|e.instances),"primitive"in e&&(t.primitive=Qe[e.primitive])}var o={},u=t.attributes;u.length=n.length;for(var s=0;s<n.length;++s){var c,l=n[s],p=u[s]=new _n,d=l.data||l;Array.isArray(d)||we(d)||Ae(d)?(t.buffers[s]&&(c=t.buffers[s],we(d)&&c._buffer.byteLength>=d.byteLength?c.subdata(d):(c.destroy(),t.buffers[s]=null)),t.buffers[s]||(c=t.buffers[s]=a.create(l,En,!1,!0)),p.buffer=a.getBuffer(c),p.size=0|p.buffer.dimension,p.normalized=!1,p.type=p.buffer.dtype,p.offset=0,p.stride=0,p.divisor=0,p.state=1,o[s]=1):a.getBuffer(l)?(p.buffer=a.getBuffer(l),p.size=0|p.buffer.dimension,p.normalized=!1,p.type=p.buffer.dtype,p.offset=0,p.stride=0,p.divisor=0,p.state=1):a.getBuffer(l.buffer)?(p.buffer=a.getBuffer(l.buffer),p.size=0|(+l.size||p.buffer.dimension),p.normalized=!!l.normalized||!1,p.type="type"in l?Ve[l.type]:p.buffer.dtype,p.offset=0|(l.offset||0),p.stride=0|(l.stride||0),p.divisor=0|(l.divisor||0),p.state=1):"x"in l&&(p.x=+l.x||0,p.y=+l.y||0,p.z=+l.z||0,p.w=+l.w||0,p.state=2)}for(var h=0;h<t.buffers.length;++h)!o[h]&&t.buffers[h]&&(t.buffers[h].destroy(),t.buffers[h]=null);return t.refresh(),r}return n.vaoCount+=1,r.destroy=function(){for(var e=0;e<t.buffers.length;++e)t.buffers[e]&&t.buffers[e].destroy();t.buffers.length=0,t.ownsElements&&(t.elements.destroy(),t.elements=null,t.ownsElements=!1),t.destroy()},r._vao=t,r._reglType="vao",r(e)}return x.prototype.bindAttrs=function(){for(var t=v(),r=this.attributes,n=0;n<r.length;++n){var a=r[n];a.buffer?(e.enableVertexAttribArray(n),e.bindBuffer(En,a.buffer.buffer),e.vertexAttribPointer(n,a.size,a.type,a.normalized,a.stride,a.offset),t&&a.divisor&&t.vertexAttribDivisorANGLE(n,a.divisor)):(e.disableVertexAttribArray(n),e.vertexAttrib4f(n,a.x,a.y,a.z,a.w))}for(var f=r.length;f<o;++f)e.disableVertexAttribArray(f);var u=i.getElements(this.elements);u?e.bindBuffer(On,u.buffer.buffer):e.bindBuffer(On,null)},x.prototype.refresh=function(){var e=h();e&&(e.bindVertexArrayOES(this.vao),this.bindAttrs(),p.currentVAO=this)},x.prototype.destroy=function(){if(this.vao){var e=h();this===p.currentVAO&&(p.currentVAO=null,e.bindVertexArrayOES(null)),e.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),l[this.id]&&(delete l[this.id],n.vaoCount-=1)},p}var Tn=35632,Sn=35633,Cn=35718,jn=35721;function Vn(t,r,n,a){var i={},f={};function o(e,t,r,n){this.name=e,this.id=t,this.location=r,this.info=n}function u(e,t){for(var r=0;r<e.length;++r)if(e[r].id===t.id)return void(e[r].location=t.location);e.push(t)}function s(e,n,a){var o=e===Tn?i:f,u=o[n];if(!u){var s=r.str(n);u=t.createShader(e),t.shaderSource(u,s),t.compileShader(u),o[n]=u}return u}var c={},l=[],p=0;function d(e,t){this.id=p++,this.fragId=e,this.vertId=t,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,a.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function h(e,n,i){var f,c,l=s(Tn,e.fragId),p=s(Sn,e.vertId),d=e.program=t.createProgram();if(t.attachShader(d,l),t.attachShader(d,p),i)for(f=0;f<i.length;++f){var h=i[f];t.bindAttribLocation(d,h[0],h[1])}t.linkProgram(d);var v=t.getProgramParameter(d,Cn);a.profile&&(e.stats.uniformsCount=v);var m=e.uniforms;for(f=0;f<v;++f)if(c=t.getActiveUniform(d,f))if(c.size>1)for(var b=0;b<c.size;++b){var g=c.name.replace("[0]","["+b+"]");u(m,new o(g,r.id(g),t.getUniformLocation(d,g),c))}else u(m,new o(c.name,r.id(c.name),t.getUniformLocation(d,c.name),c));var y=t.getProgramParameter(d,jn);a.profile&&(e.stats.attributesCount=y);var x=e.attributes;for(f=0;f<y;++f)(c=t.getActiveAttrib(d,f))&&u(x,new o(c.name,r.id(c.name),t.getAttribLocation(d,c.name),c))}function v(){i={},f={};for(var e=0;e<l.length;++e)h(l[e],null,l[e].attributes.map((function(e){return[e.location,e.name]})))}return a.profile&&(n.getMaxUniformsCount=function(){var e=0;return l.forEach((function(t){t.stats.uniformsCount>e&&(e=t.stats.uniformsCount)})),e},n.getMaxAttributesCount=function(){var e=0;return l.forEach((function(t){t.stats.attributesCount>e&&(e=t.stats.attributesCount)})),e}),{clear:function(){var e=t.deleteShader.bind(t);ke(i).forEach(e),i={},ke(f).forEach(e),f={},l.forEach((function(e){t.deleteProgram(e.program)})),l.length=0,c={},n.shaderCount=0},program:function(r,a,o,u){var s=c[a];s||(s=c[a]={});var p=s[r];if(p&&(p.refCount++,!u))return p;var v=new d(a,r);return n.shaderCount++,h(v,o,u),p||(s[r]=v),l.push(v),e(v,{destroy:function(){if(v.refCount--,v.refCount<=0){t.deleteProgram(v.program);var e=l.indexOf(v);l.splice(e,1),n.shaderCount--}s[v.vertId].refCount<=0&&(t.deleteShader(f[v.vertId]),delete f[v.vertId],delete c[v.fragId][v.vertId]),Object.keys(c[v.fragId]).length||(t.deleteShader(i[v.fragId]),delete i[v.fragId],delete c[v.fragId])}})},restore:v,shader:s,frag:-1,vert:-1}}var Fn=6408,Bn=5121,zn=3333,In=5126;function Pn(e,t,r,n,a,i,f){function o(a){var i;i=null===t.next?Bn:t.next.colorAttachments[0].texture._texture.type;var f=0,o=0,u=n.framebufferWidth,s=n.framebufferHeight,c=null;we(a)?c=a:a&&(f=0|a.x,o=0|a.y,u=0|(a.width||n.framebufferWidth-f),s=0|(a.height||n.framebufferHeight-o),c=a.data||null),r();var l=u*s*4;return c||(i===Bn?c=new Uint8Array(l):i===In&&(c=c||new Float32Array(l))),e.pixelStorei(zn,4),e.readPixels(f,o,u,s,Fn,i,c),c}function u(e){var r;return t.setFBO({framebuffer:e.framebuffer},(function(){r=o(e)})),r}function s(e){return e&&"framebuffer"in e?u(e):o(e)}return s}function Ln(e){return Array.prototype.slice.call(e)}function Mn(e){return Ln(e).join("")}function Rn(){var t=0,r=[],n=[];function a(e){for(var a=0;a<n.length;++a)if(n[a]===e)return r[a];var i="g"+t++;return r.push(i),n.push(e),i}function i(){var r=[];function n(){r.push.apply(r,Ln(arguments))}var a=[];function i(){var e="v"+t++;return a.push(e),arguments.length>0&&(r.push(e,"="),r.push.apply(r,Ln(arguments)),r.push(";")),e}return e(n,{def:i,toString:function(){return Mn([a.length>0?"var "+a.join(",")+";":"",Mn(r)])}})}function f(){var t=i(),r=i(),n=t.toString,a=r.toString;function f(e,n){r(e,n,"=",t.def(e,n),";")}return e((function(){t.apply(t,Ln(arguments))}),{def:t.def,entry:t,exit:r,save:f,set:function(e,r,n){f(e,r),t(e,r,"=",n,";")},toString:function(){return n()+a()}})}function o(){var t=Mn(arguments),r=f(),n=f(),a=r.toString,i=n.toString;return e(r,{then:function(){return r.apply(r,Ln(arguments)),this},else:function(){return n.apply(n,Ln(arguments)),this},toString:function(){var e=i();return e&&(e="else{"+e+"}"),Mn(["if(",t,"){",a(),"}",e])}})}var u=i(),s={};function c(t,r){var n=[];function a(){var e="a"+n.length;return n.push(e),e}r=r||0;for(var i=0;i<r;++i)a();var o=f(),u=o.toString;return s[t]=e(o,{arg:a,toString:function(){return Mn(["function(",n.join(),"){",u(),"}"])}})}function l(){var e=['"use strict";',u,"return {"];Object.keys(s).forEach((function(t){e.push('"',t,'":',s[t].toString(),",")})),e.push("}");var t=Mn(e).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,r.concat(t)).apply(null,n)}return{global:u,link:a,block:i,proc:c,scope:f,cond:o,compile:l}}var Un="xyzw".split(""),Hn=5121,Nn=1,Wn=2,Qn=0,qn=1,Gn=2,Yn=3,$n=4,Xn=5,Jn=6,Kn="dither",Zn="blend.enable",ea="blend.color",ta="blend.equation",ra="blend.func",na="depth.enable",aa="depth.func",ia="depth.range",fa="depth.mask",oa="colorMask",ua="cull.enable",sa="cull.face",ca="frontFace",la="lineWidth",pa="polygonOffset.enable",da="polygonOffset.offset",ha="sample.alpha",va="sample.enable",ma="sample.coverage",ba="stencil.enable",ga="stencil.mask",ya="stencil.func",xa="stencil.opFront",wa="stencil.opBack",Aa="scissor.enable",ka="scissor.box",Ea="viewport",Oa="profile",_a="framebuffer",Da="vert",Ta="frag",Sa="elements",Ca="primitive",ja="count",Va="offset",Fa="instances",Ba="vao",za="Width",Ia="Height",Pa=_a+za,La=_a+Ia,Ma=Ea+za,Ra=Ea+Ia,Ua="drawingBuffer",Ha=Ua+za,Na=Ua+Ia,Wa=[ra,ta,ya,xa,wa,ma,Ea,ka,da],Qa=34962,qa=34963,Ga=2884,Ya=3042,$a=3024,Xa=2960,Ja=2929,Ka=3089,Za=32823,ei=32926,ti=32928,ri=5126,ni=35664,ai=35665,ii=35666,fi=5124,oi=35667,ui=35668,si=35669,ci=35670,li=35671,pi=35672,di=35673,hi=35674,vi=35675,mi=35676,bi=35678,gi=35680,yi=4,xi=1028,wi=1029,Ai=2304,ki=2305,Ei=32775,Oi=32776,_i=519,Di=7680,Ti=0,Si=1,Ci=32774,ji=513,Vi=36160,Fi=36064,Bi={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},zi={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Ii={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Pi={cw:Ai,ccw:ki};function Li(e){return Array.isArray(e)||we(e)||Ae(e)}function Mi(e){return e.sort((function(e,t){return e===Ea?-1:t===Ea?1:e<t?-1:1}))}function Ri(e,t,r,n){this.thisDep=e,this.contextDep=t,this.propDep=r,this.append=n}function Ui(e){return e&&!(e.thisDep||e.contextDep||e.propDep)}function Hi(e){return new Ri(!1,!1,!1,e)}function Ni(e,t){var r=e.type;if(r===Qn){var n=e.data.length;return new Ri(!0,n>=1,n>=2,t)}if(r===$n){var a=e.data;return new Ri(a.thisDep,a.contextDep,a.propDep,t)}if(r===Xn)return new Ri(!1,!1,!1,t);if(r===Jn){for(var i=!1,f=!1,o=!1,u=0;u<e.data.length;++u){var s=e.data[u];if(s.type===qn)o=!0;else if(s.type===Gn)f=!0;else if(s.type===Yn)i=!0;else if(s.type===Qn){i=!0;var c=s.data;c>=1&&(f=!0),c>=2&&(o=!0)}else s.type===$n&&(i=i||s.data.thisDep,f=f||s.data.contextDep,o=o||s.data.propDep)}return new Ri(i,f,o,t)}return new Ri(r===Yn,r===Gn,r===qn,t)}var Wi=new Ri(!1,!1,!1,(function(){}));function Qi(t,r,n,a,i,f,o,u,s,c,l,d,h,v,m){var b=c.Record,g={add:32774,subtract:32778,"reverse subtract":32779};n.ext_blend_minmax&&(g.min=Ei,g.max=Oi);var y=n.angle_instanced_arrays,x=n.webgl_draw_buffers,w=n.oes_vertex_array_object,A={dirty:!0,profile:m.profile},k={},O=[],_={},D={};function T(e){return e.replace(".","_")}function S(e,t,r){var n=T(e);O.push(e),k[n]=A[n]=!!r,_[n]=t}function C(e,t,r){var n=T(e);O.push(e),Array.isArray(r)?(A[n]=r.slice(),k[n]=r.slice()):A[n]=k[n]=r,D[n]=t}S(Kn,$a),S(Zn,Ya),C(ea,"blendColor",[0,0,0,0]),C(ta,"blendEquationSeparate",[Ci,Ci]),C(ra,"blendFuncSeparate",[Si,Ti,Si,Ti]),S(na,Ja,!0),C(aa,"depthFunc",ji),C(ia,"depthRange",[0,1]),C(fa,"depthMask",!0),C(oa,oa,[!0,!0,!0,!0]),S(ua,Ga),C(sa,"cullFace",wi),C(ca,ca,ki),C(la,la,1),S(pa,Za),C(da,"polygonOffset",[0,0]),S(ha,ei),S(va,ti),C(ma,"sampleCoverage",[1,!1]),S(ba,Xa),C(ga,"stencilMask",-1),C(ya,"stencilFunc",[_i,0,-1]),C(xa,"stencilOpSeparate",[xi,Di,Di,Di]),C(wa,"stencilOpSeparate",[wi,Di,Di,Di]),S(Aa,Ka),C(ka,"scissor",[0,0,t.drawingBufferWidth,t.drawingBufferHeight]),C(Ea,Ea,[0,0,t.drawingBufferWidth,t.drawingBufferHeight]);var j={gl:t,context:h,strings:r,next:k,current:A,draw:d,elements:f,buffer:i,shader:l,attributes:c.state,vao:c,uniforms:s,framebuffer:u,extensions:n,timer:v,isBufferArgs:Li},V={primTypes:Qe,compareFuncs:zi,blendFuncs:Bi,blendEquations:g,stencilOps:Ii,glTypes:Ve,orientationType:Pi};x&&(V.backBuffer=[wi],V.drawBuffer=E(a.maxDrawbuffers,(function(e){return 0===e?[0]:E(e,(function(e){return Fi+e}))})));var F=0;function B(){var e=Rn(),t=e.link,n=e.global;e.id=F++,e.batchId="0";var a=t(j),i=e.shared={props:"a0"};Object.keys(j).forEach((function(e){i[e]=n.def(a,".",e)}));var f=e.next={},o=e.current={};Object.keys(D).forEach((function(e){Array.isArray(A[e])&&(f[e]=n.def(i.next,".",e),o[e]=n.def(i.current,".",e))}));var u=e.constants={};Object.keys(V).forEach((function(e){u[e]=n.def(JSON.stringify(V[e]))})),e.invoke=function(r,n){switch(n.type){case Qn:var a=["this",i.context,i.props,e.batchId];return r.def(t(n.data),".call(",a.slice(0,Math.max(n.data.length+1,4)),")");case qn:return r.def(i.props,n.data);case Gn:return r.def(i.context,n.data);case Yn:return r.def("this",n.data);case $n:return n.data.append(e,r),n.data.ref;case Xn:return n.data.toString();case Jn:return n.data.map((function(t){return e.invoke(r,t)}))}},e.attribCache={};var s={};return e.scopeAttrib=function(e){var n=r.id(e);if(n in s)return s[n];var a=c.scope[n];return a||(a=c.scope[n]=new b),s[n]=t(a)},e}function z(e){var t,r=e.static,n=e.dynamic;if(Oa in r){var a=!!r[Oa];(t=Hi((function(e,t){return a}))).enable=a}else if(Oa in n){var i=n[Oa];t=Ni(i,(function(e,t){return e.invoke(t,i)}))}return t}function I(e,t){var r=e.static,n=e.dynamic;if(_a in r){var a=r[_a];return a?(a=u.getFramebuffer(a),Hi((function(e,t){var r=e.link(a),n=e.shared;t.set(n.framebuffer,".next",r);var i=n.context;return t.set(i,"."+Pa,r+".width"),t.set(i,"."+La,r+".height"),r}))):Hi((function(e,t){var r=e.shared;t.set(r.framebuffer,".next","null");var n=r.context;return t.set(n,"."+Pa,n+"."+Ha),t.set(n,"."+La,n+"."+Na),"null"}))}if(_a in n){var i=n[_a];return Ni(i,(function(e,t){var r=e.invoke(t,i),n=e.shared,a=n.framebuffer,f=t.def(a,".getFramebuffer(",r,")");t.set(a,".next",f);var o=n.context;return t.set(o,"."+Pa,f+"?"+f+".width:"+o+"."+Ha),t.set(o,"."+La,f+"?"+f+".height:"+o+"."+Na),f}))}return null}function P(e,t,r){var n=e.static,a=e.dynamic;function i(e){if(e in n){var r,i,f=n[e],o=!0,u=0|f.x,s=0|f.y;return"width"in f?r=0|f.width:o=!1,"height"in f?i=0|f.height:o=!1,new Ri(!o&&t&&t.thisDep,!o&&t&&t.contextDep,!o&&t&&t.propDep,(function(e,t){var n=e.shared.context,a=r;"width"in f||(a=t.def(n,".",Pa,"-",u));var o=i;return"height"in f||(o=t.def(n,".",La,"-",s)),[u,s,a,o]}))}if(e in a){var c=a[e],l=Ni(c,(function(e,t){var r=e.invoke(t,c),n=e.shared.context,a=t.def(r,".x|0"),i=t.def(r,".y|0");return[a,i,t.def('"width" in ',r,"?",r,".width|0:","(",n,".",Pa,"-",a,")"),t.def('"height" in ',r,"?",r,".height|0:","(",n,".",La,"-",i,")")]}));return t&&(l.thisDep=l.thisDep||t.thisDep,l.contextDep=l.contextDep||t.contextDep,l.propDep=l.propDep||t.propDep),l}return t?new Ri(t.thisDep,t.contextDep,t.propDep,(function(e,t){var r=e.shared.context;return[0,0,t.def(r,".",Pa),t.def(r,".",La)]})):null}var f=i(Ea);if(f){var o=f;f=new Ri(f.thisDep,f.contextDep,f.propDep,(function(e,t){var r=o.append(e,t),n=e.shared.context;return t.set(n,"."+Ma,r[2]),t.set(n,"."+Ra,r[3]),r}))}return{viewport:f,scissor_box:i(ka)}}function L(e,t){var r=e.static;if("string"===typeof r[Ta]&&"string"===typeof r[Da]){if(Object.keys(t.dynamic).length>0)return null;var n=t.static,a=Object.keys(n);if(a.length>0&&"number"===typeof n[a[0]]){for(var i=[],f=0;f<a.length;++f)i.push([0|n[a[f]],a[f]]);return i}}return null}function M(e,t,n){var a=e.static,i=e.dynamic;function f(e){if(e in a){var t=r.id(a[e]),n=Hi((function(){return t}));return n.id=t,n}if(e in i){var f=i[e];return Ni(f,(function(e,t){var r=e.invoke(t,f);return t.def(e.shared.strings,".id(",r,")")}))}return null}var o,u=f(Ta),s=f(Da),c=null;return Ui(u)&&Ui(s)?(c=l.program(s.id,u.id,null,n),o=Hi((function(e,t){return e.link(c)}))):o=new Ri(u&&u.thisDep||s&&s.thisDep,u&&u.contextDep||s&&s.contextDep,u&&u.propDep||s&&s.propDep,(function(e,t){var r,n=e.shared.shader;r=u?u.append(e,t):t.def(n,".",Ta);var a=n+".program("+(s?s.append(e,t):t.def(n,".",Da))+","+r;return t.def(a+")")})),{frag:u,vert:s,progVar:o,program:c}}function R(e,t){var r=e.static,n=e.dynamic,a={},i=!1;function o(){if(Ba in r){var e=r[Ba];return null!==e&&null===c.getVAO(e)&&(e=c.createVAO(e)),i=!0,a.vao=e,Hi((function(t){var r=c.getVAO(e);return r?t.link(r):"null"}))}if(Ba in n){i=!0;var t=n[Ba];return Ni(t,(function(e,r){var n=e.invoke(r,t);return r.def(e.shared.vao+".getVAO("+n+")")}))}return null}var u=o(),s=!1;function l(){if(Sa in r){var e=r[Sa];if(a.elements=e,Li(e)){var t=a.elements=f.create(e,!0);e=f.getElements(t),s=!0}else e&&(e=f.getElements(e),s=!0);var o=Hi((function(t,r){if(e){var n=t.link(e);return t.ELEMENTS=n,n}return t.ELEMENTS=null,null}));return o.value=e,o}if(Sa in n){s=!0;var c=n[Sa];return Ni(c,(function(e,t){var r=e.shared,n=r.isBufferArgs,a=r.elements,i=e.invoke(t,c),f=t.def("null"),o=t.def(n,"(",i,")"),u=e.cond(o).then(f,"=",a,".createStream(",i,");").else(f,"=",a,".getElements(",i,");");return t.entry(u),t.exit(e.cond(o).then(a,".destroyStream(",f,");")),e.ELEMENTS=f,f}))}return i?new Ri(u.thisDep,u.contextDep,u.propDep,(function(e,t){return t.def(e.shared.vao+".currentVAO?"+e.shared.elements+".getElements("+e.shared.vao+".currentVAO.elements):null")})):null}var p=l();function d(){if(Ca in r){var e=r[Ca];return a.primitive=e,Hi((function(t,r){return Qe[e]}))}if(Ca in n){var t=n[Ca];return Ni(t,(function(e,r){var n=e.constants.primTypes,a=e.invoke(r,t);return r.def(n,"[",a,"]")}))}return s?Ui(p)?p.value?Hi((function(e,t){return t.def(e.ELEMENTS,".primType")})):Hi((function(){return yi})):new Ri(p.thisDep,p.contextDep,p.propDep,(function(e,t){var r=e.ELEMENTS;return t.def(r,"?",r,".primType:",yi)})):i?new Ri(u.thisDep,u.contextDep,u.propDep,(function(e,t){return t.def(e.shared.vao+".currentVAO?"+e.shared.vao+".currentVAO.primitive:"+yi)})):null}function h(e,t){if(e in r){var f=0|r[e];return t?a.offset=f:a.instances=f,Hi((function(e,r){return t&&(e.OFFSET=f),f}))}if(e in n){var o=n[e];return Ni(o,(function(e,r){var n=e.invoke(r,o);return t&&(e.OFFSET=n),n}))}if(t){if(s)return Hi((function(e,t){return e.OFFSET=0,0}));if(i)return new Ri(u.thisDep,u.contextDep,u.propDep,(function(e,t){return t.def(e.shared.vao+".currentVAO?"+e.shared.vao+".currentVAO.offset:0")}))}else if(i)return new Ri(u.thisDep,u.contextDep,u.propDep,(function(e,t){return t.def(e.shared.vao+".currentVAO?"+e.shared.vao+".currentVAO.instances:-1")}));return null}s&&(u=Hi((function(){return"null"})));var v=h(Va,!0);function m(){if(ja in r){var e=0|r[ja];return a.count=e,Hi((function(){return e}))}if(ja in n){var t=n[ja];return Ni(t,(function(e,r){return e.invoke(r,t)}))}return s?Ui(p)?p?v?new Ri(v.thisDep,v.contextDep,v.propDep,(function(e,t){return t.def(e.ELEMENTS,".vertCount-",e.OFFSET)})):Hi((function(e,t){return t.def(e.ELEMENTS,".vertCount")})):Hi((function(){return-1})):new Ri(p.thisDep||v.thisDep,p.contextDep||v.contextDep,p.propDep||v.propDep,(function(e,t){var r=e.ELEMENTS;return e.OFFSET?t.def(r,"?",r,".vertCount-",e.OFFSET,":-1"):t.def(r,"?",r,".vertCount:-1")})):i?new Ri(u.thisDep,u.contextDep,u.propDep,(function(e,t){return t.def(e.shared.vao,".currentVAO?",e.shared.vao,".currentVAO.count:-1")})):null}var b=d(),g=m(),y=h(Fa,!1);return{elements:p,primitive:b,count:g,instances:y,offset:v,vao:u,vaoActive:i,elementsActive:s,static:a}}function U(e,t){var r=e.static,n=e.dynamic,a={};return O.forEach((function(e){var t=T(e);function i(i,f){if(e in r){var o=i(r[e]);a[t]=Hi((function(){return o}))}else if(e in n){var u=n[e];a[t]=Ni(u,(function(e,t){return f(e,t,e.invoke(t,u))}))}}switch(e){case ua:case Zn:case Kn:case ba:case na:case Aa:case pa:case ha:case va:case fa:return i((function(e){return e}),(function(e,t,r){return r}));case aa:return i((function(e){return zi[e]}),(function(e,t,r){var n=e.constants.compareFuncs;return t.def(n,"[",r,"]")}));case ia:return i((function(e){return e}),(function(e,t,r){return[t.def("+",r,"[0]"),t.def("+",r,"[1]")]}));case ra:return i((function(e){var t="srcRGB"in e?e.srcRGB:e.src,r="srcAlpha"in e?e.srcAlpha:e.src,n="dstRGB"in e?e.dstRGB:e.dst,a="dstAlpha"in e?e.dstAlpha:e.dst;return[Bi[t],Bi[n],Bi[r],Bi[a]]}),(function(e,t,r){var n=e.constants.blendFuncs;function a(e,n){return t.def('"',e,n,'" in ',r,"?",r,".",e,n,":",r,".",e)}var i=a("src","RGB"),f=a("dst","RGB"),o=t.def(n,"[",i,"]"),u=t.def(n,"[",a("src","Alpha"),"]");return[o,t.def(n,"[",f,"]"),u,t.def(n,"[",a("dst","Alpha"),"]")]}));case ta:return i((function(e){return"string"===typeof e?[g[e],g[e]]:"object"===typeof e?[g[e.rgb],g[e.alpha]]:void 0}),(function(e,t,r){var n=e.constants.blendEquations,a=t.def(),i=t.def(),f=e.cond("typeof ",r,'==="string"');return f.then(a,"=",i,"=",n,"[",r,"];"),f.else(a,"=",n,"[",r,".rgb];",i,"=",n,"[",r,".alpha];"),t(f),[a,i]}));case ea:return i((function(e){return E(4,(function(t){return+e[t]}))}),(function(e,t,r){return E(4,(function(e){return t.def("+",r,"[",e,"]")}))}));case ga:return i((function(e){return 0|e}),(function(e,t,r){return t.def(r,"|0")}));case ya:return i((function(e){var t=e.cmp||"keep",r=e.ref||0,n="mask"in e?e.mask:-1;return[zi[t],r,n]}),(function(e,t,r){var n=e.constants.compareFuncs;return[t.def('"cmp" in ',r,"?",n,"[",r,".cmp]",":",Di),t.def(r,".ref|0"),t.def('"mask" in ',r,"?",r,".mask|0:-1")]}));case xa:case wa:return i((function(t){var r=t.fail||"keep",n=t.zfail||"keep",a=t.zpass||"keep";return[e===wa?wi:xi,Ii[r],Ii[n],Ii[a]]}),(function(t,r,n){var a=t.constants.stencilOps;function i(e){return r.def('"',e,'" in ',n,"?",a,"[",n,".",e,"]:",Di)}return[e===wa?wi:xi,i("fail"),i("zfail"),i("zpass")]}));case da:return i((function(e){return[0|e.factor,0|e.units]}),(function(e,t,r){return[t.def(r,".factor|0"),t.def(r,".units|0")]}));case sa:return i((function(e){var t=0;return"front"===e?t=xi:"back"===e&&(t=wi),t}),(function(e,t,r){return t.def(r,'==="front"?',xi,":",wi)}));case la:return i((function(e){return e}),(function(e,t,r){return r}));case ca:return i((function(e){return Pi[e]}),(function(e,t,r){return t.def(r+'==="cw"?'+Ai+":"+ki)}));case oa:return i((function(e){return e.map((function(e){return!!e}))}),(function(e,t,r){return E(4,(function(e){return"!!"+r+"["+e+"]"}))}));case ma:return i((function(e){return["value"in e?e.value:1,!!e.invert]}),(function(e,t,r){return[t.def('"value" in ',r,"?+",r,".value:1"),t.def("!!",r,".invert")]}))}})),a}function H(e,t){var r=e.static,n=e.dynamic,a={};return Object.keys(r).forEach((function(e){var t,n=r[e];if("number"===typeof n||"boolean"===typeof n)t=Hi((function(){return n}));else if("function"===typeof n){var i=n._reglType;"texture2d"===i||"textureCube"===i?t=Hi((function(e){return e.link(n)})):"framebuffer"!==i&&"framebufferCube"!==i||(t=Hi((function(e){return e.link(n.color[0])})))}else st(n)&&(t=Hi((function(e){return e.global.def("[",E(n.length,(function(e){return n[e]})),"]")})));t.value=n,a[e]=t})),Object.keys(n).forEach((function(e){var t=n[e];a[e]=Ni(t,(function(e,r){return e.invoke(r,t)}))})),a}function N(e,t){var n=e.static,a=e.dynamic,f={};return Object.keys(n).forEach((function(e){var t=n[e],a=r.id(e),o=new b;if(Li(t))o.state=Nn,o.buffer=i.getBuffer(i.create(t,Qa,!1,!0)),o.type=0;else{var u=i.getBuffer(t);if(u)o.state=Nn,o.buffer=u,o.type=0;else if("constant"in t){var s=t.constant;o.buffer="null",o.state=Wn,"number"===typeof s?o.x=s:Un.forEach((function(e,t){t<s.length&&(o[e]=s[t])}))}else{u=Li(t.buffer)?i.getBuffer(i.create(t.buffer,Qa,!1,!0)):i.getBuffer(t.buffer);var c=0|t.offset,l=0|t.stride,p=0|t.size,d=!!t.normalized,h=0;"type"in t&&(h=Ve[t.type]);var v=0|t.divisor;o.buffer=u,o.state=Nn,o.size=p,o.normalized=d,o.type=h||u.dtype,o.offset=c,o.stride=l,o.divisor=v}}f[e]=Hi((function(e,t){var r=e.attribCache;if(a in r)return r[a];var n={isStream:!1};return Object.keys(o).forEach((function(e){n[e]=o[e]})),o.buffer&&(n.buffer=e.link(o.buffer),n.type=n.type||n.buffer+".dtype"),r[a]=n,n}))})),Object.keys(a).forEach((function(e){var t=a[e];function r(e,r){var n=e.invoke(r,t),a=e.shared,i=e.constants,f=a.isBufferArgs,o=a.buffer,u={isStream:r.def(!1)},s=new b;s.state=Nn,Object.keys(s).forEach((function(e){u[e]=r.def(""+s[e])}));var c=u.buffer,l=u.type;function p(e){r(u[e],"=",n,".",e,"|0;")}return r("if(",f,"(",n,")){",u.isStream,"=true;",c,"=",o,".createStream(",Qa,",",n,");",l,"=",c,".dtype;","}else{",c,"=",o,".getBuffer(",n,");","if(",c,"){",l,"=",c,".dtype;",'}else if("constant" in ',n,"){",u.state,"=",Wn,";","if(typeof "+n+'.constant === "number"){',u[Un[0]],"=",n,".constant;",Un.slice(1).map((function(e){return u[e]})).join("="),"=0;","}else{",Un.map((function(e,t){return u[e]+"="+n+".constant.length>"+t+"?"+n+".constant["+t+"]:0;"})).join(""),"}}else{","if(",f,"(",n,".buffer)){",c,"=",o,".createStream(",Qa,",",n,".buffer);","}else{",c,"=",o,".getBuffer(",n,".buffer);","}",l,'="type" in ',n,"?",i.glTypes,"[",n,".type]:",c,".dtype;",u.normalized,"=!!",n,".normalized;"),p("size"),p("offset"),p("stride"),p("divisor"),r("}}"),r.exit("if(",u.isStream,"){",o,".destroyStream(",c,");","}"),u}f[e]=Ni(t,r)})),f}function W(e){var t=e.static,r=e.dynamic,n={};return Object.keys(t).forEach((function(e){var r=t[e];n[e]=Hi((function(e,t){return"number"===typeof r||"boolean"===typeof r?""+r:e.link(r)}))})),Object.keys(r).forEach((function(e){var t=r[e];n[e]=Ni(t,(function(e,r){return e.invoke(r,t)}))})),n}function Q(e,t,r,a,i){e.static,e.dynamic;var f=L(e,t),o=I(e,i),u=P(e,o,i),s=R(e,i),l=U(e,i),p=M(e,i,f);function d(e){var t=u[e];t&&(l[e]=t)}d(Ea),d(T(ka));var h=Object.keys(l).length>0,v={framebuffer:o,draw:s,shader:p,state:l,dirty:h,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(v.profile=z(e,i),v.uniforms=H(r,i),v.drawVAO=v.scopeVAO=s.vao,!v.drawVAO&&p.program&&!f&&n.angle_instanced_arrays&&s.static.elements){var m=!0,b=p.program.attributes.map((function(e){var r=t.static[e];return m=m&&!!r,r}));if(m&&b.length>0){var g=c.getVAO(c.createVAO({attributes:b,elements:s.static.elements}));v.drawVAO=new Ri(null,null,null,(function(e,t){return e.link(g)})),v.useVAO=!0}}return f?v.useVAO=!0:v.attributes=N(t,i),v.context=W(a,i),v}function q(e,t,r){var n=e.shared.context,a=e.scope();Object.keys(r).forEach((function(i){t.save(n,"."+i);var f=r[i].append(e,t);Array.isArray(f)?a(n,".",i,"=[",f.join(),"];"):a(n,".",i,"=",f,";")})),t(a)}function G(e,t,r,n){var a,i=e.shared,f=i.gl,o=i.framebuffer;x&&(a=t.def(i.extensions,".webgl_draw_buffers"));var u,s=e.constants,c=s.drawBuffer,l=s.backBuffer;u=r?r.append(e,t):t.def(o,".next"),n||t("if(",u,"!==",o,".cur){"),t("if(",u,"){",f,".bindFramebuffer(",Vi,",",u,".framebuffer);"),x&&t(a,".drawBuffersWEBGL(",c,"[",u,".colorAttachments.length]);"),t("}else{",f,".bindFramebuffer(",Vi,",null);"),x&&t(a,".drawBuffersWEBGL(",l,");"),t("}",o,".cur=",u,";"),n||t("}")}function Y(e,t,r){var n=e.shared,a=n.gl,i=e.current,f=e.next,o=n.current,u=n.next,s=e.cond(o,".dirty");O.forEach((function(t){var n,c,l=T(t);if(!(l in r.state))if(l in f){n=f[l],c=i[l];var p=E(A[l].length,(function(e){return s.def(n,"[",e,"]")}));s(e.cond(p.map((function(e,t){return e+"!=="+c+"["+t+"]"})).join("||")).then(a,".",D[l],"(",p,");",p.map((function(e,t){return c+"["+t+"]="+e})).join(";"),";"))}else{n=s.def(u,".",l);var d=e.cond(n,"!==",o,".",l);s(d),l in _?d(e.cond(n).then(a,".enable(",_[l],");").else(a,".disable(",_[l],");"),o,".",l,"=",n,";"):d(a,".",D[l],"(",n,");",o,".",l,"=",n,";")}})),0===Object.keys(r.state).length&&s(o,".dirty=false;"),t(s)}function $(e,t,r,n){var a=e.shared,i=e.current,f=a.current,o=a.gl;Mi(Object.keys(r)).forEach((function(a){var u=r[a];if(!n||n(u)){var s=u.append(e,t);if(_[a]){var c=_[a];Ui(u)?t(o,s?".enable(":".disable(",c,");"):t(e.cond(s).then(o,".enable(",c,");").else(o,".disable(",c,");")),t(f,".",a,"=",s,";")}else if(st(s)){var l=i[a];t(o,".",D[a],"(",s,");",s.map((function(e,t){return l+"["+t+"]="+e})).join(";"),";")}else t(o,".",D[a],"(",s,");",f,".",a,"=",s,";")}}))}function X(e,t){y&&(e.instancing=t.def(e.shared.extensions,".angle_instanced_arrays"))}function J(e,t,r,n,a){var i,f,o,u=e.shared,s=e.stats,c=u.current,l=u.timer,p=r.profile;function d(){return"undefined"===typeof performance?"Date.now()":"performance.now()"}function h(e){e(i=t.def(),"=",d(),";"),"string"===typeof a?e(s,".count+=",a,";"):e(s,".count++;"),v&&(n?e(f=t.def(),"=",l,".getNumPendingQueries();"):e(l,".beginQuery(",s,");"))}function m(e){e(s,".cpuTime+=",d(),"-",i,";"),v&&(n?e(l,".pushScopeStats(",f,",",l,".getNumPendingQueries(),",s,");"):e(l,".endQuery();"))}function b(e){var r=t.def(c,".profile");t(c,".profile=",e,";"),t.exit(c,".profile=",r,";")}if(p){if(Ui(p))return void(p.enable?(h(t),m(t.exit),b("true")):b("false"));b(o=p.append(e,t))}else o=t.def(c,".profile");var g=e.block();h(g),t("if(",o,"){",g,"}");var y=e.block();m(y),t.exit("if(",o,"){",y,"}")}function K(e,t,r,n,a){var i=e.shared;function f(e){switch(e){case ni:case oi:case li:return 2;case ai:case ui:case pi:return 3;case ii:case si:case di:return 4;default:return 1}}function o(r,n,a){var f=i.gl,o=t.def(r,".location"),u=t.def(i.attributes,"[",o,"]"),s=a.state,c=a.buffer,l=[a.x,a.y,a.z,a.w],p=["buffer","normalized","offset","stride"];function d(){t("if(!",u,".buffer){",f,".enableVertexAttribArray(",o,");}");var r,i=a.type;if(r=a.size?t.def(a.size,"||",n):n,t("if(",u,".type!==",i,"||",u,".size!==",r,"||",p.map((function(e){return u+"."+e+"!=="+a[e]})).join("||"),"){",f,".bindBuffer(",Qa,",",c,".buffer);",f,".vertexAttribPointer(",[o,r,i,a.normalized,a.stride,a.offset],");",u,".type=",i,";",u,".size=",r,";",p.map((function(e){return u+"."+e+"="+a[e]+";"})).join(""),"}"),y){var s=a.divisor;t("if(",u,".divisor!==",s,"){",e.instancing,".vertexAttribDivisorANGLE(",[o,s],");",u,".divisor=",s,";}")}}function h(){t("if(",u,".buffer){",f,".disableVertexAttribArray(",o,");",u,".buffer=null;","}if(",Un.map((function(e,t){return u+"."+e+"!=="+l[t]})).join("||"),"){",f,".vertexAttrib4f(",o,",",l,");",Un.map((function(e,t){return u+"."+e+"="+l[t]+";"})).join(""),"}")}s===Nn?d():s===Wn?h():(t("if(",s,"===",Nn,"){"),d(),t("}else{"),h(),t("}"))}n.forEach((function(n){var i,u=n.name,s=r.attributes[u];if(s){if(!a(s))return;i=s.append(e,t)}else{if(!a(Wi))return;var c=e.scopeAttrib(u);i={},Object.keys(new b).forEach((function(e){i[e]=t.def(c,".",e)}))}o(e.link(n),f(n.info.type),i)}))}function Z(e,t,n,a,i,f){for(var o,u=e.shared,s=u.gl,c=0;c<a.length;++c){var l,p=a[c],d=p.name,h=p.info.type,v=n.uniforms[d],m=e.link(p)+".location";if(v){if(!i(v))continue;if(Ui(v)){var b=v.value;if(h===bi||h===gi){var g=e.link(b._texture||b.color[0]._texture);t(s,".uniform1i(",m,",",g+".bind());"),t.exit(g,".unbind();")}else if(h===hi||h===vi||h===mi){var y=e.global.def("new Float32Array(["+Array.prototype.slice.call(b)+"])"),x=2;h===vi?x=3:h===mi&&(x=4),t(s,".uniformMatrix",x,"fv(",m,",false,",y,");")}else{switch(h){case ri:o="1f";break;case ni:o="2f";break;case ai:o="3f";break;case ii:o="4f";break;case ci:case fi:o="1i";break;case li:case oi:o="2i";break;case pi:case ui:o="3i";break;case di:case si:o="4i"}t(s,".uniform",o,"(",m,",",st(b)?Array.prototype.slice.call(b):b,");")}continue}l=v.append(e,t)}else{if(!i(Wi))continue;l=t.def(u.uniforms,"[",r.id(d),"]")}h===bi?t("if(",l,"&&",l,'._reglType==="framebuffer"){',l,"=",l,".color[0];","}"):h===gi&&t("if(",l,"&&",l,'._reglType==="framebufferCube"){',l,"=",l,".color[0];","}");var w=1;switch(h){case bi:case gi:var A=t.def(l,"._texture");t(s,".uniform1i(",m,",",A,".bind());"),t.exit(A,".unbind();");continue;case fi:case ci:o="1i";break;case oi:case li:o="2i",w=2;break;case ui:case pi:o="3i",w=3;break;case si:case di:o="4i",w=4;break;case ri:o="1f";break;case ni:o="2f",w=2;break;case ai:o="3f",w=3;break;case ii:o="4f",w=4;break;case hi:o="Matrix2fv";break;case vi:o="Matrix3fv";break;case mi:o="Matrix4fv"}if("M"===o.charAt(0)){t(s,".uniform",o,"(",m,",");var k=Math.pow(h-hi+2,2),O=e.global.def("new Float32Array(",k,")");Array.isArray(l)?t("false,(",E(k,(function(e){return O+"["+e+"]="+l[e]})),",",O,")"):t("false,(Array.isArray(",l,")||",l," instanceof Float32Array)?",l,":(",E(k,(function(e){return O+"["+e+"]="+l+"["+e+"]"})),",",O,")"),t(");")}else if(w>1){for(var _=[],D=[],T=0;T<w;++T)Array.isArray(l)?D.push(l[T]):D.push(t.def(l+"["+T+"]")),f&&_.push(t.def());f&&t("if(!",e.batchId,"||",_.map((function(e,t){return e+"!=="+D[t]})).join("||"),"){",_.map((function(e,t){return e+"="+D[t]+";"})).join("")),t(s,".uniform",o,"(",m,",",D.join(","),");"),f&&t("}")}else{if(f){var S=t.def();t("if(!",e.batchId,"||",S,"!==",l,"){",S,"=",l,";")}t(s,".uniform",o,"(",m,",",l,");"),f&&t("}")}}}function ee(e,t,r,n){var a=e.shared,i=a.gl,f=a.draw,o=n.draw;function u(){var u,s=o.elements,c=t;return s?((s.contextDep&&n.contextDynamic||s.propDep)&&(c=r),o.vaoActive?u=s.append(e,c):c("if("+(u=s.append(e,c))+")"+i+".bindBuffer("+qa+","+u+".buffer.buffer);")):(u=c.def(),c("if(",a.vao,".currentVAO){",u,"=",e.shared.elements+".getElements("+a.vao,".currentVAO.elements);",w?"":"if("+u+")"+i+".bindBuffer("+qa+","+u+".buffer.buffer);","}else{",u,"=",f,".",Sa,";","if(",u,"){",i,".bindBuffer(",qa,",",u,".buffer.buffer);}}")),u}function s(){var a,i=o.count,u=t;return i?((i.contextDep&&n.contextDynamic||i.propDep)&&(u=r),a=i.append(e,u)):a=u.def(f,".",ja),a}var c=u();function l(a){var i=o[a];return i?i.contextDep&&n.contextDynamic||i.propDep?i.append(e,r):i.append(e,t):t.def(f,".",a)}var p,d,h=l(Ca),v=l(Va),m=s();if("number"===typeof m){if(0===m)return}else r("if(",m,"){"),r.exit("}");y&&(p=l(Fa),d=e.instancing);var b=c+".type",g=o.elements&&Ui(o.elements)&&!o.vaoActive;function x(){function e(){r(d,".drawElementsInstancedANGLE(",[h,m,b,v+"<<(("+b+"-"+Hn+")>>1)",p],");")}function t(){r(d,".drawArraysInstancedANGLE(",[h,v,m,p],");")}c&&"null"!==c?g?e():(r("if(",c,"){"),e(),r("}else{"),t(),r("}")):t()}function A(){function e(){r(i+".drawElements("+[h,m,b,v+"<<(("+b+"-"+Hn+")>>1)"]+");")}function t(){r(i+".drawArrays("+[h,v,m]+");")}c&&"null"!==c?g?e():(r("if(",c,"){"),e(),r("}else{"),t(),r("}")):t()}y&&("number"!==typeof p||p>=0)?"string"===typeof p?(r("if(",p,">0){"),x(),r("}else if(",p,"<0){"),A(),r("}")):x():A()}function te(e,t,r,n,a){var i=B(),f=i.proc("body",a);return y&&(i.instancing=f.def(i.shared.extensions,".angle_instanced_arrays")),e(i,f,r,n),i.compile().body}function re(e,t,r,n){X(e,t),r.useVAO?r.drawVAO?t(e.shared.vao,".setVAO(",r.drawVAO.append(e,t),");"):t(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(t(e.shared.vao,".setVAO(null);"),K(e,t,r,n.attributes,(function(){return!0}))),Z(e,t,r,n.uniforms,(function(){return!0}),!1),ee(e,t,t,r)}function ne(e,t){var r=e.proc("draw",1);X(e,r),q(e,r,t.context),G(e,r,t.framebuffer),Y(e,r,t),$(e,r,t.state),J(e,r,t,!1,!0);var n=t.shader.progVar.append(e,r);if(r(e.shared.gl,".useProgram(",n,".program);"),t.shader.program)re(e,r,t,t.shader.program);else{r(e.shared.vao,".setVAO(null);");var a=e.global.def("{}"),i=r.def(n,".id"),f=r.def(a,"[",i,"]");r(e.cond(f).then(f,".call(this,a0);").else(f,"=",a,"[",i,"]=",e.link((function(r){return te(re,e,t,r,1)})),"(",n,");",f,".call(this,a0);"))}Object.keys(t.state).length>0&&r(e.shared.current,".dirty=true;")}function ae(e,t,r,n){function a(){return!0}e.batchId="a1",X(e,t),K(e,t,r,n.attributes,a),Z(e,t,r,n.uniforms,a,!1),ee(e,t,t,r)}function ie(e,t,r,n){X(e,t);var a=r.contextDep,i=t.def(),f="a0",o="a1",u=t.def();e.shared.props=u,e.batchId=i;var s=e.scope(),c=e.scope();function l(e){return e.contextDep&&a||e.propDep}function p(e){return!l(e)}if(t(s.entry,"for(",i,"=0;",i,"<",o,";++",i,"){",u,"=",f,"[",i,"];",c,"}",s.exit),r.needsContext&&q(e,c,r.context),r.needsFramebuffer&&G(e,c,r.framebuffer),$(e,c,r.state,l),r.profile&&l(r.profile)&&J(e,c,r,!1,!0),n)r.useVAO?r.drawVAO?l(r.drawVAO)?c(e.shared.vao,".setVAO(",r.drawVAO.append(e,c),");"):s(e.shared.vao,".setVAO(",r.drawVAO.append(e,s),");"):s(e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"):(s(e.shared.vao,".setVAO(null);"),K(e,s,r,n.attributes,p),K(e,c,r,n.attributes,l)),Z(e,s,r,n.uniforms,p,!1),Z(e,c,r,n.uniforms,l,!0),ee(e,s,c,r);else{var d=e.global.def("{}"),h=r.shader.progVar.append(e,c),v=c.def(h,".id"),m=c.def(d,"[",v,"]");c(e.shared.gl,".useProgram(",h,".program);","if(!",m,"){",m,"=",d,"[",v,"]=",e.link((function(t){return te(ae,e,r,t,2)})),"(",h,");}",m,".call(this,a0[",i,"],",i,");")}}function fe(e,t){var r=e.proc("batch",2);e.batchId="0",X(e,r);var n=!1,a=!0;Object.keys(t.context).forEach((function(e){n=n||t.context[e].propDep})),n||(q(e,r,t.context),a=!1);var i=t.framebuffer,f=!1;function o(e){return e.contextDep&&n||e.propDep}i?(i.propDep?n=f=!0:i.contextDep&&n&&(f=!0),f||G(e,r,i)):G(e,r,null),t.state.viewport&&t.state.viewport.propDep&&(n=!0),Y(e,r,t),$(e,r,t.state,(function(e){return!o(e)})),t.profile&&o(t.profile)||J(e,r,t,!1,"a1"),t.contextDep=n,t.needsContext=a,t.needsFramebuffer=f;var u=t.shader.progVar;if(u.contextDep&&n||u.propDep)ie(e,r,t,null);else{var s=u.append(e,r);if(r(e.shared.gl,".useProgram(",s,".program);"),t.shader.program)ie(e,r,t,t.shader.program);else{r(e.shared.vao,".setVAO(null);");var c=e.global.def("{}"),l=r.def(s,".id"),p=r.def(c,"[",l,"]");r(e.cond(p).then(p,".call(this,a0,a1);").else(p,"=",c,"[",l,"]=",e.link((function(r){return te(ie,e,t,r,2)})),"(",s,");",p,".call(this,a0,a1);"))}}Object.keys(t.state).length>0&&r(e.shared.current,".dirty=true;")}function oe(e,t){var n=e.proc("scope",3);e.batchId="a2";var a=e.shared,i=a.current;function f(r){var i=t.shader[r];i&&n.set(a.shader,"."+r,i.append(e,n))}q(e,n,t.context),t.framebuffer&&t.framebuffer.append(e,n),Mi(Object.keys(t.state)).forEach((function(r){var i=t.state[r].append(e,n);st(i)?i.forEach((function(t,a){n.set(e.next[r],"["+a+"]",t)})):n.set(a.next,"."+r,i)})),J(e,n,t,!0,!0),[Sa,Va,ja,Fa,Ca].forEach((function(r){var i=t.draw[r];i&&n.set(a.draw,"."+r,""+i.append(e,n))})),Object.keys(t.uniforms).forEach((function(i){var f=t.uniforms[i].append(e,n);Array.isArray(f)&&(f="["+f.join()+"]"),n.set(a.uniforms,"["+r.id(i)+"]",f)})),Object.keys(t.attributes).forEach((function(r){var a=t.attributes[r].append(e,n),i=e.scopeAttrib(r);Object.keys(new b).forEach((function(e){n.set(i,"."+e,a[e])}))})),t.scopeVAO&&n.set(a.vao,".targetVAO",t.scopeVAO.append(e,n)),f(Da),f(Ta),Object.keys(t.state).length>0&&(n(i,".dirty=true;"),n.exit(i,".dirty=true;")),n("a1(",e.shared.context,",a0,",e.batchId,");")}function ue(e){if("object"===typeof e&&!st(e)){for(var t=Object.keys(e),r=0;r<t.length;++r)if(p.isDynamic(e[t[r]]))return!0;return!1}}function se(e,t,r){var n=t.static[r];if(n&&ue(n)){var a=e.global,i=Object.keys(n),f=!1,o=!1,u=!1,s=e.global.def("{}");i.forEach((function(t){var r=n[t];if(p.isDynamic(r)){"function"===typeof r&&(r=n[t]=p.unbox(r));var i=Ni(r,null);f=f||i.thisDep,u=u||i.propDep,o=o||i.contextDep}else{switch(a(s,".",t,"="),typeof r){case"number":a(r);break;case"string":a('"',r,'"');break;case"object":Array.isArray(r)&&a("[",r.join(),"]");break;default:a(e.link(r))}a(";")}})),t.dynamic[r]=new p.DynamicVariable($n,{thisDep:f,contextDep:o,propDep:u,ref:s,append:c}),delete t.static[r]}function c(e,t){i.forEach((function(r){var a=n[r];if(p.isDynamic(a)){var i=e.invoke(t,a);t(s,".",r,"=",i,";")}}))}}function ce(t,r,n,a,i){var f=B();f.stats=f.link(i),Object.keys(r.static).forEach((function(e){se(f,r,e)})),Wa.forEach((function(e){se(f,t,e)}));var o=Q(t,r,n,a,f);return ne(f,o),oe(f,o),fe(f,o),e(f.compile(),{destroy:function(){o.shader.program.destroy()}})}return{next:k,current:A,procs:function(){var e=B(),t=e.proc("poll"),r=e.proc("refresh"),i=e.block();t(i),r(i);var f,o=e.shared,u=o.gl,s=o.next,c=o.current;i(c,".dirty=false;"),G(e,t),G(e,r,null,!0),y&&(f=e.link(y)),n.oes_vertex_array_object&&r(e.link(n.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var l=0;l<a.maxAttributes;++l){var p=r.def(o.attributes,"[",l,"]"),d=e.cond(p,".buffer");d.then(u,".enableVertexAttribArray(",l,");",u,".bindBuffer(",Qa,",",p,".buffer.buffer);",u,".vertexAttribPointer(",l,",",p,".size,",p,".type,",p,".normalized,",p,".stride,",p,".offset);").else(u,".disableVertexAttribArray(",l,");",u,".vertexAttrib4f(",l,",",p,".x,",p,".y,",p,".z,",p,".w);",p,".buffer=null;"),r(d),y&&r(f,".vertexAttribDivisorANGLE(",l,",",p,".divisor);")}return r(e.shared.vao,".currentVAO=null;",e.shared.vao,".setVAO(",e.shared.vao,".targetVAO);"),Object.keys(_).forEach((function(n){var a=_[n],f=i.def(s,".",n),o=e.block();o("if(",f,"){",u,".enable(",a,")}else{",u,".disable(",a,")}",c,".",n,"=",f,";"),r(o),t("if(",f,"!==",c,".",n,"){",o,"}")})),Object.keys(D).forEach((function(n){var a,f,o=D[n],l=A[n],p=e.block();if(p(u,".",o,"("),st(l)){var d=l.length;a=e.global.def(s,".",n),f=e.global.def(c,".",n),p(E(d,(function(e){return a+"["+e+"]"})),");",E(d,(function(e){return f+"["+e+"]="+a+"["+e+"];"})).join("")),t("if(",E(d,(function(e){return a+"["+e+"]!=="+f+"["+e+"]"})).join("||"),"){",p,"}")}else a=i.def(s,".",n),f=i.def(c,".",n),p(a,");",c,".",n,"=",a,";"),t("if(",a,"!==",f,"){",p,"}");r(p)})),e.compile()}(),compile:ce}}function qi(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Gi=34918,Yi=34919,$i=35007,Xi=function(e,t){if(!t.ext_disjoint_timer_query)return null;var r=[];function n(){return r.pop()||t.ext_disjoint_timer_query.createQueryEXT()}function a(e){r.push(e)}var i=[];function f(e){var r=n();t.ext_disjoint_timer_query.beginQueryEXT($i,r),i.push(r),d(i.length-1,i.length,e)}function o(){t.ext_disjoint_timer_query.endQueryEXT($i)}function u(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var s=[];function c(){return s.pop()||new u}function l(e){s.push(e)}var p=[];function d(e,t,r){var n=c();n.startQueryIndex=e,n.endQueryIndex=t,n.sum=0,n.stats=r,p.push(n)}var h=[],v=[];function m(){var e,r,n=i.length;if(0!==n){v.length=Math.max(v.length,n+1),h.length=Math.max(h.length,n+1),h[0]=0,v[0]=0;var f=0;for(e=0,r=0;r<i.length;++r){var o=i[r];t.ext_disjoint_timer_query.getQueryObjectEXT(o,Yi)?(f+=t.ext_disjoint_timer_query.getQueryObjectEXT(o,Gi),a(o)):i[e++]=o,h[r+1]=f,v[r+1]=e}for(i.length=e,e=0,r=0;r<p.length;++r){var u=p[r],s=u.startQueryIndex,c=u.endQueryIndex;u.sum+=h[c]-h[s];var d=v[s],m=v[c];m===d?(u.stats.gpuTime+=u.sum/1e6,l(u)):(u.startQueryIndex=d,u.endQueryIndex=m,p[e++]=u)}p.length=e}}return{beginQuery:f,endQuery:o,pushScopeStats:d,update:m,getNumPendingQueries:function(){return i.length},clear:function(){r.push.apply(r,i);for(var e=0;e<r.length;e++)t.ext_disjoint_timer_query.deleteQueryEXT(r[e]);i.length=0,r.length=0},restore:function(){i.length=0,r.length=0}}},Ji=16384,Ki=256,Zi=1024,ef=34962,tf="webglcontextlost",rf="webglcontextrestored",nf=1,af=2,ff=3;function of(e,t){for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}function uf(t){var r=A(t);if(!r)return null;var n=r.gl,a=n.getContextAttributes(),i=(n.isContextLost(),k(n,r));if(!i)return null;var f=v(),o=qi(),u=i.extensions,s=Xi(n,u),c=h(),l=n.drawingBufferWidth,m=n.drawingBufferHeight,b={tick:0,time:0,viewportWidth:l,viewportHeight:m,framebufferWidth:l,framebufferHeight:m,drawingBufferWidth:l,drawingBufferHeight:m,pixelRatio:r.pixelRatio},g={},y={elements:null,primitive:4,count:-1,offset:0,instances:-1},x=xe(n,u),w=We(n,o,r,_),E=at(n,u,w,o),O=Dn(n,u,x,o,w,E,y);function _(e){return O.destroyBuffer(e)}var D=Vn(n,f,o,r),T=qr(n,u,x,(function(){j.procs.poll()}),b,o,r),S=on(n,u,x,o,r),C=An(n,u,x,T,S,o),j=Qi(n,f,u,x,w,E,T,C,g,O,D,y,b,s,r),V=Pn(n,C,j.procs.poll,b,a,u,x),F=j.next,B=n.canvas,z=[],I=[],P=[],L=[r.onDestroy],M=null;function R(){if(0===z.length)return s&&s.update(),void(M=null);M=d.next(R),K();for(var e=z.length-1;e>=0;--e){var t=z[e];t&&t(b,null,0)}n.flush(),s&&s.update()}function U(){!M&&z.length>0&&(M=d.next(R))}function H(){M&&(d.cancel(R),M=null)}function N(e){e.preventDefault(),H(),I.forEach((function(e){e()}))}function W(e){n.getError(),i.restore(),D.restore(),w.restore(),T.restore(),S.restore(),C.restore(),O.restore(),s&&s.restore(),j.procs.refresh(),U(),P.forEach((function(e){e()}))}function Q(){z.length=0,H(),B&&(B.removeEventListener(tf,N),B.removeEventListener(rf,W)),D.clear(),C.clear(),S.clear(),O.clear(),T.clear(),E.clear(),w.clear(),s&&s.clear(),L.forEach((function(e){e()}))}function q(t){function r(t){var r=e({},t);function n(e){if(e in r){var t=r[e];delete r[e],Object.keys(t).forEach((function(n){r[e+"."+n]=t[n]}))}}return delete r.uniforms,delete r.attributes,delete r.context,delete r.vao,"stencil"in r&&r.stencil.op&&(r.stencil.opBack=r.stencil.opFront=r.stencil.op,delete r.stencil.op),n("blend"),n("depth"),n("cull"),n("stencil"),n("polygonOffset"),n("scissor"),n("sample"),"vao"in t&&(r.vao=t.vao),r}function n(e,t){var r={},n={};return Object.keys(e).forEach((function(a){var i=e[a];if(p.isDynamic(i))n[a]=p.unbox(i,a);else{if(t&&Array.isArray(i))for(var f=0;f<i.length;++f)if(p.isDynamic(i[f]))return void(n[a]=p.unbox(i,a));r[a]=i}})),{dynamic:n,static:r}}var a=n(t.context||{},!0),i=n(t.uniforms||{},!0),f=n(t.attributes||{},!1),o=n(r(t),!1),u={gpuTime:0,cpuTime:0,count:0},s=j.compile(o,f,i,a,u),c=s.draw,l=s.batch,d=s.scope,h=[];function v(e){for(;h.length<e;)h.push(null);return h}function m(e,t){var r;if("function"===typeof e)return d.call(this,null,e,0);if("function"===typeof t)if("number"===typeof e)for(r=0;r<e;++r)d.call(this,null,t,r);else{if(!Array.isArray(e))return d.call(this,e,t,0);for(r=0;r<e.length;++r)d.call(this,e[r],t,r)}else if("number"===typeof e){if(e>0)return l.call(this,v(0|e),0|e)}else{if(!Array.isArray(e))return c.call(this,e);if(e.length)return l.call(this,e,e.length)}}return e(m,{stats:u,destroy:function(){s.destroy()}})}B&&(B.addEventListener(tf,N,!1),B.addEventListener(rf,W,!1));var G=C.setFBO=q({framebuffer:p.define.call(null,nf,"framebuffer")});function Y(e,t){var r=0;j.procs.poll();var a=t.color;a&&(n.clearColor(+a[0]||0,+a[1]||0,+a[2]||0,+a[3]||0),r|=Ji),"depth"in t&&(n.clearDepth(+t.depth),r|=Ki),"stencil"in t&&(n.clearStencil(0|t.stencil),r|=Zi),n.clear(r)}function $(t){if("framebuffer"in t)if(t.framebuffer&&"framebufferCube"===t.framebuffer_reglType)for(var r=0;r<6;++r)G(e({framebuffer:t.framebuffer.faces[r]},t),Y);else G(t,Y);else Y(null,t)}function X(e){function t(){var t=of(z,e);function r(){var e=of(z,r);z[e]=z[z.length-1],z.length-=1,z.length<=0&&H()}z[t]=r}return z.push(e),U(),{cancel:t}}function J(){var e=F.viewport,t=F.scissor_box;e[0]=e[1]=t[0]=t[1]=0,b.viewportWidth=b.framebufferWidth=b.drawingBufferWidth=e[2]=t[2]=n.drawingBufferWidth,b.viewportHeight=b.framebufferHeight=b.drawingBufferHeight=e[3]=t[3]=n.drawingBufferHeight}function K(){b.tick+=1,b.time=ee(),J(),j.procs.poll()}function Z(){T.refresh(),J(),j.procs.refresh(),s&&s.update()}function ee(){return(h()-c)/1e3}function te(e,t){var r;switch(e){case"frame":return X(t);case"lost":r=I;break;case"restore":r=P;break;case"destroy":r=L}return r.push(t),{cancel:function(){for(var e=0;e<r.length;++e)if(r[e]===t)return r[e]=r[r.length-1],void r.pop()}}}Z();var re=e(q,{clear:$,prop:p.define.bind(null,nf),context:p.define.bind(null,af),this:p.define.bind(null,ff),draw:q({}),buffer:function(e){return w.create(e,ef,!1,!1)},elements:function(e){return E.create(e,!1)},texture:T.create2D,cube:T.createCube,renderbuffer:S.create,framebuffer:C.create,framebufferCube:C.createCube,vao:O.createVAO,attributes:a,frame:X,on:te,limits:x,hasExtension:function(e){return x.extensions.indexOf(e.toLowerCase())>=0},read:V,destroy:Q,_gl:n,_refresh:Z,poll:function(){K(),s&&s.update()},now:ee,stats:o});return r.onDone(null,re),re}return uf}()},776:function(e,t,r){var n=r(777),a=r(778),i=r(301),f=r(779),o=r(781),u=r(782),s=r(787),c=r(770),l=r(772),p=r(771),d=r(788),h=r(789);function v(e){if(!(this instanceof v))return new v(e);e=d(e),this.depList=e,this.depIndex=function(e,t){return e.reduce((function(e,r){return e[r[t]]=r,e}),{})}(e,"id"),this.exported={},this.cache={},this.varCounter=0,this.src=[];for(var t=0;t<e.length;t++)this.preprocess(e[t]);for(t=0;t<e.length;t++)e[t].entry&&(this.src=this.src.concat(this.bundle(e[t])));this.src=c(this.src),this.src=c(s(a(i(this.src))))}e.exports=function(e){return f(v(e).src,{GLSLIFY:1})};var m=v.prototype;function b(e){return/#pragma glslify:\s*export\(([^)]+)\)/.exec(e)}function g(e){return/#pragma glslify:\s*([^=\s]+)\s*=\s*require\(([^)]+)\)/.exec(e)}function y(e){return!!e&&e.reduce((function(e,t){var r=(t=t.split(/\s?=\s?/g)).pop();return t.forEach((function(t){e[t]=r})),e}),{})}m.preprocess=function(e){var t,r=i(e.source),n=[],a=null;p(r),l(r);for(var f=0;f<r.length;f++){var o=r[f];if("preprocessor"===o.type&&(t=o.data,/#pragma glslify:/.test(t))){var u=b(o.data),s=g(o.data);if(u)a=u[1],r.splice(f--,1);else if(s){var c=s[1],d=s[2].split(/\s?,\s?/g),h=d.shift().trim().replace(/^'|'$/g,"").replace(/^"|"$/g,""),v=this.depIndex[e.deps[h]];n.push({name:c,path:h,target:v,maps:y(d),index:f}),r.splice(f--,1)}}}var m=r[r.length-1];if(m&&"eof"===m.type&&r.pop(),e.entry&&(a=a||"main"),!a)throw new Error(e.file+" does not export any symbols");e.parsed={tokens:r,imports:n,exports:a}},m.bundle=function(e){var t={};return function e(r,a){a.sort();var i=a.join(":")+":"+r.id,f="_"+n(i);r.entry&&(f="");var s=r.parsed.exports+f;if(t[s])return[s,[]];for(var c={},l=0;l<a.length;++l){var p=a[l];c[p[0]]=p[1]}var d=r.parsed.imports,v=[];for(l=0;l<d.length;++l){var m=d[l],b=m.maps,g=m.name,y=m.target,x=Object.keys(b).map((function(e){var t=b[e];if(t.match(/^\d+(?:\.\d+?)?$/g))return[e,t];var r=t.match(/^([^.]+)\.(.+)$/);return r?[e,(c[r[1]]||r[1]+f)+"."+r[2]]:[e,c[t]||t+f]})),w=e(y,x);c[g]=w[0],v.push([m.index,w[1]])}var A=r.parsed.tokens.map(h),k=o(A),E=u(A,(function(e,t){return k[e]?e:c[e]?c[e]:e+f}));v.sort((function(e,t){return t[0]-e[0]}));for(l=0;l<v.length;++l){var O=v[l];E=E.slice(0,O[0]).concat(O[1]).concat(E.slice(O[0]))}return t[s]=!0,[s,E]}(e,[])[1]}},777:function(e,t,r){e.exports=function(e,t){var r,n,a,i,f,o,u,s;for(r=3&e.length,n=e.length-r,a=t,f=3432918353,o=461845907,s=0;s<n;)u=255&e.charCodeAt(s)|(255&e.charCodeAt(++s))<<8|(255&e.charCodeAt(++s))<<16|(255&e.charCodeAt(++s))<<24,++s,a=27492+(65535&(i=5*(65535&(a=(a^=u=(65535&(u=(u=(65535&u)*f+(((u>>>16)*f&65535)<<16)&4294967295)<<15|u>>>17))*o+(((u>>>16)*o&65535)<<16)&4294967295)<<13|a>>>19))+((5*(a>>>16)&65535)<<16)&4294967295))+((58964+(i>>>16)&65535)<<16);switch(u=0,r){case 3:u^=(255&e.charCodeAt(s+2))<<16;case 2:u^=(255&e.charCodeAt(s+1))<<8;case 1:a^=u=(65535&(u=(u=(65535&(u^=255&e.charCodeAt(s)))*f+(((u>>>16)*f&65535)<<16)&4294967295)<<15|u>>>17))*o+(((u>>>16)*o&65535)<<16)&4294967295}return a^=e.length,a=2246822507*(65535&(a^=a>>>16))+((2246822507*(a>>>16)&65535)<<16)&4294967295,a=3266489909*(65535&(a^=a>>>13))+((3266489909*(a>>>16)&65535)<<16)&4294967295,(a^=a>>>16)>>>0}},778:function(e,t){function r(e,t){return r[t?"all":"newlines"](function(e){for(var t=1;t<e.length;t++){var r=e[t];if("whitespace"===r.type){var n=e[t-1];"whitespace"===n.type&&(e.splice(--t,1),r.data=n.data+r.data)}}return e}(e))}e.exports=r;var n=/(?:\n|\r\n|\r){2,}/g;r.newlines=function(e){for(var t=0;t<e.length;t++){var r=e[t];"whitespace"===r.type&&(r.data=r.data.replace(n,"\n\n"))}return e};var a=/\s+/g;r.all=function(e){for(var t=e.length,r=0;r<t;r++){var n=e[r];if("whitespace"===n.type){var i=e[r+1],f=e[r-1];if(i&&"preprocessor"===i.type||f&&"preprocessor"===f.type)n.data=n.data.replace(a,"\n");else{switch(n.data=n.data.replace(a," "),i&&i.data){case"(":case";":case")":case"{":case"=":case"}":case",":n.data=n.data.replace(a,"")}switch(f&&f.data){case"(":case";":case")":case"{":case"=":case"}":case",":n.data=n.data.replace(a,"")}}}}return e}},779:function(e,t,r){var n=r(301),a=r(770),i=r(780);e.exports=function(e,t){if(!t)return e;var r=Object.keys(t);if(0===r.length)return e;for(var f=n(e),o=r.length-1;o>=0;o--){var u=r[o],s=String(t[u]);s&&(s=" "+s),i(f,{type:"preprocessor",data:"#define "+u+s})}return a(f)}},780:function(e,t){e.exports=function(e,t){Array.isArray(t)||(t=[t]);var i=function(e){for(var t=-1,r=0;r<e.length;r++){var n=e[r];if("preprocessor"===n.type)/^#(extension|version)/.test(n.data)&&(t=Math.max(t,r));else if("keyword"===n.type&&"precision"===n.data){var i=a(e,r);if(-1===i)throw new Error("precision statement not followed by any semicolons!");t=Math.max(t,i)}}return t+1}(e),f=i>0?e[i-1]:null;f&&n.test(f.data)&&e.splice(i++,0,r);e.splice.apply(e,[i,0].concat(t));var o=i+t.length;e[o]&&/[^\r\n]$/.test(e[o].data)&&e.splice(o,0,r);return e};var r={data:"\n",type:"whitespace"},n=/[^\r\n]$/;function a(e,t){for(var r=t;r<e.length;r++)if("operator"===e[r].type&&";"===e[r].data)return r;return-1}},781:function(e,t){e.exports=function(e){for(var t={},r=0;r<e.length;r++){var n=e[r];if("preprocessor"===n.type){var a=n.data.trim();if(!a.indexOf("#define")){var i=a.match(/#define\s+([^\s]+)(.+)?$/i);if(i){var f=(i[1]||"").trim(),o=(i[2]||"").trim();t[f]=o}}}}return t}},782:function(e,t,r){e.exports=function(e,t){r(771)(e),r(772)(e),r(783)(e),r(784)(e);for(var n=function(e){for(var t={},r=0;r<e.length;r++){var n=e[r];n.declaration&&(t[n.scope]=t[n.scope]||{},t[n.scope][n.data]=n)}return t}(e),a=t||function(){var e=0;return function(t){return t+"_"+(e++).toString(36)}}(),i={},f=0;f<e.length;f++){var o=e[f],u=o.stack,s=o.data;if(o.descoped=!1,"ident"===o.type&&!o.property&&!o.structMember){for(var c=!1,l=u.length-1;l>=0;l--){var p=n[u[l]];if(p&&p[s]){if(c=!0,l)break;o.descoped=o.data,o.data=i[s]=i[s]||a(s,o)||o.data}}c||(o.descoped=o.data,o.data=i[s]=i[s]||a(s,o)||o.data)}}return e}},783:function(e,t){e.exports=function(e){for(var t=0;t<e.length;t++){var r=e[t];if(r.property=!1,"ident"===r.type){for(var n=t;e[--n]&&"whitespace"===e[n].type;);e[n]&&"operator"===e[n].type&&"."===e[n].data&&(r.property=!0)}}return e}},784:function(e,t,r){var n=r(785),a=r(786);e.exports=function(e){for(var t=0,r=0;r<e.length;r++){var i=(u=e[r]).type;u.assignment=!1,u.declaration=!1,"ident"!==i&&"builtin"!==i||(t=r+1,s(1),"operator"===e[t].type&&n[e[t].data]&&(u.assignment=!0))}for(r=0;r<e.length;r++){var f=e[r],o=(i=f.type,f.data);if(f.declaration=!1,"keyword"===i){if(a[o])continue}else if("ident"!==i)continue;if(t=r+1,c(),"ident"===e[t].type)if(e[t++].declaration=!0,c(),"("!==e[t].data){for(;e[t]&&";"!==e[t].data;)","===e[t].data?(t++,s(1),(e[t].declaration="ident"===e[t].type)&&t++):(s(1),l(),s(1),t++);r=t}else{for(t++,s(1);e[t]&&")"!==e[t].data&&("keyword"===e[t].type||"ident"===e[t].type);)t++,s(1),"ident"===e[t].type&&(e[t++].declaration=!0,s(1),c(),s(1),","===e[t].data&&(t++,s(1)));r=t}}for(r=0;r<e.length;r++){var u;if("keyword"===(u=e[r]).type&&("struct"===u.data&&(t=r+1,s(1),"ident"===e[t].type&&(t++,s(1),"{"===e[t++].data)))){for(s(1);"ident"===e[t].type||"keyword"===e[t].type;){do{t++,s(1),e[t].structMember=!0,e[t].declaration=!1,t++,c()}while(","===e[t].data);";"===e[t].data&&t++,s()}if(t++,s(1),"ident"===e[t].type)for(e[t].declaration=!0,s(1);","===e[++t].data;)s(1),t++,s(1),"ident"===e[t].type&&(e[t].declaration=!0),s(1)}}return e;function s(r){for(;e[t]&&"whitespace"===e[t].type;)t++}function c(){for(;e[t]&&("integer"===e[t].type||"["===e[t].data||"]"===e[t].data||"whitespace"===e[t].type);)t++}function l(){if(e[t]&&"("===e[t].data){var r=0;do{if(";"===e[t].data)break;"("===e[t].data&&r++,")"===e[t].data&&r--}while(r&&e[++t])}}}},785:function(e,t){e.exports={"<<=":!0,">>=":!0,"++":!0,"--":!0,"+=":!0,"-=":!0,"*=":!0,"/=":!0,"%=":!0,"&=":!0,"^=":!0,"|=":!0,"=":!0}},786:function(e,t){e.exports={precision:!0,highp:!0,mediump:!0,lowp:!0,attribute:!0,const:!0,uniform:!0,varying:!0,break:!0,continue:!0,do:!0,for:!0,while:!0,if:!0,else:!0,in:!0,out:!0,inout:!0,true:!0,false:!0,return:!0}},787:function(e,t){e.exports=function(e){for(var t={},n={},a=0;a<e.length;a++){var i=e[a];if("ident"===i.type){var f=i.data.match(r);if(f){var o=f[1],u=f[2];n[o]=n[o]||{},n[o][u]=n[o][u]||[],n[o][u].push(i)}else t[i.data]=!0}}return Object.keys(n).forEach((function(e){var r=Object.keys(n[e]);if(1!==r.length||t[e])r.forEach((function(r,a){var i=n[e][r],f=e+"_"+a;if(!t[f])for(var o=0;o<i.length;o++)i[o].data=f}));else for(var a=n[e][r[0]],i=0;i<a.length;i++)a[i].data=e})),e};var r=/^([^_]+)_(\d{4,})$/},788:function(e,t){e.exports=function(e){var t={},r={},n={};e.forEach((function(e){var a=e.id,i=Object.keys(e.deps);n[e.id]=e,r[a]=i.length,i.forEach((function(r){var n=e.deps[r];t[n]?t[n].push(a):t[n]=[a]}))}));var a=[],i={};e.forEach((function(e){var n=e.id;t[n]||(t[n]=[]),0===r[n]&&(i[n]=a.length,a.push(n))}));for(var f=0;f<a.length;f++){var o=a[f];t[o].forEach((function(e){0===--r[e]&&(i[e]=a.length,a.push(e))}))}if(a.length!==e.length)throw new Error("cyclic dependency");return a.map((function(e){var t=n[e],r=t.deps,a={};return Object.keys(r).forEach((function(e){a[e]=0|i[r[e]]})),{id:0|i[e],deps:a,file:t.file,source:t.source,entry:t.entry}}))}},789:function(e,t){e.exports=function(e){if(!e||"object"!==typeof e)return e;var t;if(n(e)){var a=e.length;t=Array(a);for(var i=0;i<a;i++)t[i]=e[i]}else{var f=r(e);t={};i=0;for(var o=f.length;i<o;i++){var u=f[i];t[u]=e[u]}}return t};var r=Object.keys||function(e){var t=[];for(var r in e)({}).hasOwnProperty.call(e,r)&&t.push(r);return t},n=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)}}}]);
//# sourceMappingURL=3.d75b5a42.chunk.js.map